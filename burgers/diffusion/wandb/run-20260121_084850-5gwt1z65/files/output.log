Creating checkpoint manager...
I0121 08:48:52.686623 140165176223552 checkpoint_manager.py:709] [process=0][thread=MainThread] CheckpointManager init: checkpointers=None, item_names=None, item_handlers=None, handler_registry=None
I0121 08:48:52.687558 140165176223552 composite_checkpoint_handler.py:505] Initialized registry DefaultCheckpointHandlerRegistry({('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonSaveArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x7f777059e8f0>, ('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonRestoreArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x7f777059e8f0>}).
I0121 08:48:52.688127 140165176223552 abstract_checkpointer.py:35] orbax-checkpoint version: 0.11.32
I0121 08:48:52.688400 140165176223552 async_checkpointer.py:177] [process=0][thread=MainThread] Using barrier_sync_fn: <function get_barrier_sync_fn.<locals>.<lambda> at 0x7f77705a69e0> timeout: 600 secs and primary_host=0 for async checkpoint writes
I0121 08:48:52.690612 140165176223552 checkpoint_manager.py:1818] Found 0 checkpoint steps in /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt
I0121 08:48:52.691096 140165176223552 checkpoint_manager.py:929] [process=0][thread=MainThread] CheckpointManager created,  primary_host=0, CheckpointManagerOptions=CheckpointManagerOptions(save_interval_steps=1, max_to_keep=1, keep_time_interval=None, keep_period=None, should_keep_fn=None, best_fn=None, best_mode='max', keep_checkpoints_without_metrics=True, step_prefix=None, step_format_fixed_length=None, step_name_format=None, create=True, cleanup_tmp_directories=False, save_on_steps=frozenset(), single_host_load_and_broadcast=False, todelete_subdir=None, todelete_full_path=None, enable_background_delete=False, read_only=False, enable_async_checkpointing=True, async_options=None, multiprocessing_options=MultiprocessingOptions(primary_host=0, active_processes=None, barrier_sync_key_prefix=None), should_save_fn=None, file_options=FileOptions(path_permission_mode=None), save_root_metadata=True, temporary_path_class=None, save_decision_policy=None, preservation_policy=None, prevent_write_metrics=False, enable_should_save_is_saving_in_progress_check=True, enable_per_process_directory_creation=False, lightweight_initialize=False), root_directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt: <orbax.checkpoint.checkpoint_manager.CheckpointManager object at 0x7f779053b040>
Checkpoint manager created successfully
Pre-computing constants...
Constants pre-computed
Starting training loop...
Training configuration: use_pde=True, random_resolution=True
Epoch 0, getting batches from DataLoader...
First batch received, converting to JAX array...
First batch processed, converting to global array...
Calling train_step (JIT compilation will happen on first call)...
First train_step completed in 147.94s (includes JIT compilation)
step: 450,  loss data: 1.906e-02, loss res: 4.296e-02, time: 6.086e+02
I0121 08:59:02.082215 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 08:59:02.083011 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 450
I0121 08:59:02.084196 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/450.
I0121 08:59:02.088263 140165176223552 signaling_client.py:373] Using ThreadSafeKeyValueSignalingClient
I0121 08:59:02.090110 140165176223552 composite_checkpoint_handler.py:552] No entry found in handler registry for item: default and args with type: <class 'orbax.checkpoint._src.handlers.standard_checkpoint_handler.StandardSaveArgs'>. Falling back to global handler registry.
I0121 08:59:02.090445 140165176223552 pytree_checkpoint_handler.py:584] save_device_host_concurrent_bytes=None
I0121 08:59:02.092269 140165176223552 base_pytree_checkpoint_handler.py:409] Created BasePyTreeCheckpointHandler: use_ocdbt=True, use_zarr3=False, pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=<orbax.checkpoint._src.metadata.array_metadata_store.Store object at 0x7f7a6ab2aa10>, enable_pinned_host_transfer=True, save_concurrent_bytes: 96000000000 (89.4 GiB), restore_concurrent_bytes: 96000000000 (89.4 GiB)
I0121 08:59:02.092895 140165176223552 composite_checkpoint_handler.py:237] Deferred registration for item: "default". Adding handler `<orbax.checkpoint._src.handlers.standard_checkpoint_handler.StandardCheckpointHandler object at 0x7f75d01aa380>` for item "default" and save args `<class 'orbax.checkpoint._src.handlers.standard_checkpoint_handler.StandardSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.standard_checkpoint_handler.StandardRestoreArgs'>` to `_handler_registry`.
I0121 08:59:02.119080 140040017536576 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/450.orbax-checkpoint-tmp
I0121 08:59:02.202367 140045092648512 checkpoint.py:188] Wrote Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1768957142164264410, 'commit_timestamp_nsecs': None, 'custom_metadata': {}}, json={"item_handlers": null, "metrics": {}, "performance_metrics": {}, "init_timestamp_nsecs": 1768957142164264410, "commit_timestamp_nsecs": null, "custom_metadata": {}} to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/450.orbax-checkpoint-tmp/_CHECKPOINT_METADATA
I0121 08:59:02.220912 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 08:59:02.221967 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 08:59:02.238787 140040025929280 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 08:59:02.853573 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.635566s
I0121 08:59:02.866015 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 111.275 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 768 milliseconds) (per-host)
I0121 08:59:02.877155 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.779894s (batch_requests_ready=0.069092s, total_serialization_initiated=0.693289s, others=0.017513s)
I0121 08:59:02.894761 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.805402s (all_items=0.003117s, per_item={'default': '0.00311661'}, temp_paths=0.802285)
I0121 08:59:02.961220 140042139842112 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 08:59:02.961487 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.878047s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/450.
I0121 08:59:02.963693 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=450] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 08:59:02.964613 140040009143872 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 08:59:03.034508 140165176223552 standard_logger.py:34] {'step': Array(450, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768957142.0821679, 'wait_for_prev_duration_secs': 0.0004754066467285156, 'time_between_consecutive_saves_sec': None, 'checkpointer_blocking_start_time': 1768957142.0833848, 'checkpointer_blocking_duration_secs': 0.8799006938934326, 'get_old_steps_start_time': 1768957142.9633603, 'get_old_steps_duration_secs': 0.0001838207244873047, 'checkpoint_manager_blocking_start_time': 1768957142.0818837, 'checkpoint_manager_blocking_duration_secs': 0.8829286098480225}
I0121 08:59:03.049307 140042274076224 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 08:59:04.787664 140042265683520 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.922055s (commit=1.763831s, array_metadata_write=0.158224s)
I0121 08:59:04.791449 140042139842112 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 31.747 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 08:59:04.791887 140042139842112 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.829847s.
I0121 08:59:04.794436 140042139842112 checkpoint.py:228] Read Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1768957142164264410, 'commit_timestamp_nsecs': None, 'custom_metadata': {}} from /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/450.orbax-checkpoint-tmp/_CHECKPOINT_METADATA
I0121 08:59:04.809951 140042139842112 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 08:59:04.815422 140045092648512 checkpoint.py:247] Updated Metadata={'item_handlers': {'default': 'orbax.checkpoint._src.handlers.standard_checkpoint_handler.StandardCheckpointHandler'}, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1768957142164264410, 'commit_timestamp_nsecs': None, 'custom_metadata': {}} to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/450.orbax-checkpoint-tmp/_CHECKPOINT_METADATA
I0121 08:59:04.883900 140042139842112 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.088195s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 08:59:04.886301 140042139842112 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/450.orbax-checkpoint-tmp/default
I0121 08:59:04.892591 140042139842112 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/450.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/450
I0121 08:59:04.910032 140042139842112 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/450`.
I0121 08:59:04.912479 140042139842112 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.829055s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/450
I0121 08:59:04.913148 140042139842112 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.951101s.
I0121 08:59:04.914827 140040009143872 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 08:59:04.915457 140040009143872 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 08:59:04.916137 140040009143872 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=450] CheckpointManager Save Finalize is syncing with other hosts...
I0121 08:59:04.916658 140040009143872 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=450] CheckpointManager Save Finalize is done on all hosts.
step: 900,  loss data: 1.945e-02, loss res: 8.597e-02, time: 1.734e+02
step: 1350,  loss data: 3.269e-03, loss res: 1.659e-02, time: 1.727e+02
I0121 09:04:49.329262 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 09:04:49.451880 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 1350
I0121 09:04:49.453525 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/1350.
I0121 09:04:49.479777 140040000751168 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/1350.orbax-checkpoint-tmp
I0121 09:04:49.560729 140039044441664 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/1350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 09:04:49.604367 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 09:04:49.605883 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 09:04:50.121251 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.519410s
I0121 09:04:50.128898 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 128.708 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 664 milliseconds) (per-host)
I0121 09:04:50.140477 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.676199s (batch_requests_ready=0.086104s, total_serialization_initiated=0.572542s, others=0.017553s)
I0121 09:04:50.141901 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.684605s (all_items=0.000034s, per_item={'default': '0.00003433'}, temp_paths=0.684571)
I0121 09:04:50.730432 140041871406656 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 09:04:50.731233 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 1.278689s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/1350.
I0121 09:04:50.739983 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=1350] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 09:04:50.752849 140040512443968 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 09:04:50.762804 140165176223552 standard_logger.py:34] {'step': Array(1350, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768957489.3291557, 'wait_for_prev_duration_secs': 0.0007076263427734375, 'time_between_consecutive_saves_sec': 344.41225242614746, 'checkpointer_blocking_start_time': 1768957489.452472, 'checkpointer_blocking_duration_secs': 1.2870666980743408, 'get_old_steps_start_time': 1768957490.7396214, 'get_old_steps_duration_secs': 0.00021266937255859375, 'checkpoint_manager_blocking_start_time': 1768957489.2074459, 'checkpoint_manager_blocking_duration_secs': 1.553177833557129}
I0121 09:04:50.806550 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/1350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 09:04:52.286580 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 2.151724s (commit=2.028070s, array_metadata_write=0.123654s)
I0121 09:04:52.289943 140041871406656 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 30.270 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 09:04:52.290524 140041871406656 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.556916s.
I0121 09:04:52.303574 140041871406656 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 09:04:52.399111 140041871406656 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.105209s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/1350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 09:04:52.401350 140041871406656 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/1350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/1350.orbax-checkpoint-tmp/default
I0121 09:04:52.406825 140041871406656 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/1350.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/1350
I0121 09:04:52.421465 140041871406656 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/1350`.
I0121 09:04:52.423120 140041871406656 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.970605s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/1350
I0121 09:04:52.423613 140041871406656 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.690000s.
I0121 09:04:52.424340 140040512443968 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 09:04:52.424892 140040512443968 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 09:04:52.485256 140040512443968 deleter.py:273] Deleted step 450.
I0121 09:04:52.485642 140040512443968 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=1350] CheckpointManager Save Finalize is syncing with other hosts...
I0121 09:04:52.485967 140040512443968 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=1350] CheckpointManager Save Finalize is done on all hosts.
step: 1800,  loss data: 6.520e-03, loss res: 4.733e-02, time: 1.731e+02
step: 2250,  loss data: 5.303e-03, loss res: 8.644e-03, time: 1.732e+02
I0121 09:10:37.052652 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 09:10:37.054901 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 2250
I0121 09:10:37.056488 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/2250.
I0121 09:10:37.083430 140040554407488 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/2250.orbax-checkpoint-tmp
I0121 09:10:37.185606 140040529229376 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/2250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 09:10:37.221797 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 09:10:37.223284 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 09:10:37.836892 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.617661s
I0121 09:10:37.854662 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 108.799 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 786 milliseconds) (per-host)
I0121 09:10:37.860265 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.791845s (batch_requests_ready=0.096707s, total_serialization_initiated=0.683309s, others=0.011830s)
I0121 09:10:37.866647 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.805743s (all_items=0.000034s, per_item={'default': '0.00003433'}, temp_paths=0.805709)
I0121 09:10:37.937635 140042139842112 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 09:10:37.938512 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.883010s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/2250.
I0121 09:10:37.941039 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=2250] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 09:10:37.945364 140041879799360 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 09:10:37.949103 140165176223552 standard_logger.py:34] {'step': Array(2250, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768957837.0525398, 'wait_for_prev_duration_secs': 0.0006413459777832031, 'time_between_consecutive_saves_sec': 344.56636023521423, 'checkpointer_blocking_start_time': 1768957837.0554304, 'checkpointer_blocking_duration_secs': 0.8851842880249023, 'get_old_steps_start_time': 1768957837.9406846, 'get_old_steps_duration_secs': 0.00020313262939453125, 'checkpoint_manager_blocking_start_time': 1768957837.0514698, 'checkpoint_manager_blocking_duration_secs': 0.896289587020874}
I0121 09:10:37.959402 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/2250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 09:10:39.618947 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.764664s (commit=1.600030s, array_metadata_write=0.164634s)
I0121 09:10:39.622092 140042139842112 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 33.494 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 09:10:39.622518 140042139842112 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.683430s.
I0121 09:10:39.634847 140042139842112 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 09:10:39.693822 140042139842112 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.068037s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/2250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 09:10:39.695943 140042139842112 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/2250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/2250.orbax-checkpoint-tmp/default
I0121 09:10:39.701717 140042139842112 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/2250.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/2250
I0121 09:10:39.718241 140042139842112 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/2250`.
I0121 09:10:39.719835 140042139842112 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.664361s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/2250
I0121 09:10:39.720332 140042139842112 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.781237s.
I0121 09:10:39.721141 140041879799360 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 09:10:39.721879 140041879799360 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 09:10:39.769061 140041879799360 deleter.py:273] Deleted step 1350.
I0121 09:10:39.769435 140041879799360 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=2250] CheckpointManager Save Finalize is syncing with other hosts...
I0121 09:10:39.769761 140041879799360 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=2250] CheckpointManager Save Finalize is done on all hosts.
step: 2700,  loss data: 3.548e-02, loss res: 1.724e-05, time: 1.712e+02
step: 3150,  loss data: 5.444e-02, loss res: 1.231e-06, time: 1.722e+02
I0121 09:16:21.281391 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 09:16:21.283329 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 3150
I0121 09:16:21.284757 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/3150.
I0121 09:16:21.311281 140040546014784 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/3150.orbax-checkpoint-tmp
I0121 09:16:21.406747 140039078012480 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/3150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 09:16:21.448856 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 09:16:21.450345 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 09:16:22.012888 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.566605s
I0121 09:16:22.037426 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 115.278 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 741 milliseconds) (per-host)
I0121 09:16:22.053483 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.758106s (batch_requests_ready=0.095991s, total_serialization_initiated=0.628917s, others=0.033198s)
I0121 09:16:22.059473 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.770574s (all_items=0.000034s, per_item={'default': '0.00003409'}, temp_paths=0.770540)
I0121 09:16:22.118482 140042173412928 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 09:16:22.119323 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.835477s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/3150.
I0121 09:16:22.121668 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=3150] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 09:16:22.122790 140042131449408 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 09:16:22.125188 140165176223552 standard_logger.py:34] {'step': Array(3150, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768958181.2812853, 'wait_for_prev_duration_secs': 0.0005755424499511719, 'time_between_consecutive_saves_sec': 341.51131868362427, 'checkpointer_blocking_start_time': 1768958181.283779, 'checkpointer_blocking_duration_secs': 0.8374879360198975, 'get_old_steps_start_time': 1768958182.1213353, 'get_old_steps_duration_secs': 0.00018858909606933594, 'checkpoint_manager_blocking_start_time': 1768958181.2802138, 'checkpoint_manager_blocking_duration_secs': 0.8440439701080322}
I0121 09:16:22.143907 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/3150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 09:16:23.756253 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.724699s (commit=1.590170s, array_metadata_write=0.134529s)
I0121 09:16:23.759484 140042173412928 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 34.712 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 09:16:23.759896 140042173412928 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.639866s.
I0121 09:16:23.773116 140042173412928 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 09:16:23.894092 140042173412928 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.130806s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/3150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 09:16:23.896334 140042173412928 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/3150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/3150.orbax-checkpoint-tmp/default
I0121 09:16:23.902260 140042173412928 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/3150.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/3150
I0121 09:16:23.928287 140042173412928 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/3150`.
I0121 09:16:23.929906 140042173412928 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.646086s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/3150
I0121 09:16:23.930419 140042173412928 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.810384s.
I0121 09:16:23.930876 140042131449408 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 09:16:23.931427 140042131449408 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 09:16:23.987126 140042131449408 deleter.py:273] Deleted step 2250.
I0121 09:16:23.987481 140042131449408 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=3150] CheckpointManager Save Finalize is syncing with other hosts...
I0121 09:16:23.987797 140042131449408 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=3150] CheckpointManager Save Finalize is done on all hosts.
step: 3600,  loss data: 4.077e-02, loss res: 1.660e-07, time: 1.714e+02
step: 4050,  loss data: 2.161e-02, loss res: 2.461e-05, time: 1.722e+02
I0121 09:22:05.825109 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 09:22:05.827395 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 4050
I0121 09:22:05.828973 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4050.
I0121 09:22:05.860024 140042156627520 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4050.orbax-checkpoint-tmp
I0121 09:22:05.954698 140039036048960 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 09:22:05.991381 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 09:22:05.992184 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 09:22:06.570095 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.581213s
I0121 09:22:06.583918 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 115.159 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 742 milliseconds) (per-host)
I0121 09:22:06.601687 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.760527s (batch_requests_ready=0.092955s, total_serialization_initiated=0.643013s, others=0.024559s)
I0121 09:22:06.623081 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.790321s (all_items=0.000034s, per_item={'default': '0.00003409'}, temp_paths=0.790287)
I0121 09:22:06.684222 140041871406656 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 09:22:06.684467 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.856488s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4050.
I0121 09:22:06.689432 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=4050] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 09:22:06.692276 140042165020224 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 09:22:06.695230 140165176223552 standard_logger.py:34] {'step': Array(4050, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768958525.8249984, 'wait_for_prev_duration_secs': 0.0006387233734130859, 'time_between_consecutive_saves_sec': 341.8370006084442, 'checkpointer_blocking_start_time': 1768958525.8279145, 'checkpointer_blocking_duration_secs': 0.8611009120941162, 'get_old_steps_start_time': 1768958526.6890934, 'get_old_steps_duration_secs': 0.00018858909606933594, 'checkpoint_manager_blocking_start_time': 1768958525.8238695, 'checkpoint_manager_blocking_duration_secs': 0.8696393966674805}
I0121 09:22:06.707021 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 09:22:08.151590 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.528144s (commit=1.397246s, array_metadata_write=0.130898s)
I0121 09:22:08.155242 140041871406656 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 36.961 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 09:22:08.155858 140041871406656 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.471006s.
I0121 09:22:08.170693 140041871406656 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 09:22:08.242635 140041871406656 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.082782s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 09:22:08.244831 140041871406656 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4050.orbax-checkpoint-tmp/default
I0121 09:22:08.250226 140041871406656 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4050.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4050
I0121 09:22:08.266079 140041871406656 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4050`.
I0121 09:22:08.268767 140041871406656 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.440802s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4050
I0121 09:22:08.270018 140041871406656 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.585158s.
I0121 09:22:08.275216 140042165020224 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 09:22:08.275821 140042165020224 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 09:22:08.332728 140042165020224 deleter.py:273] Deleted step 3150.
I0121 09:22:08.333284 140042165020224 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=4050] CheckpointManager Save Finalize is syncing with other hosts...
I0121 09:22:08.333921 140042165020224 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=4050] CheckpointManager Save Finalize is done on all hosts.
step: 4500,  loss data: 4.480e-02, loss res: 6.496e-06, time: 1.719e+02
Epoch 10, getting batches from DataLoader...
step: 4950,  loss data: 2.586e-02, loss res: 5.133e-07, time: 1.724e+02
I0121 09:27:50.993529 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 09:27:50.995856 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 4950
I0121 09:27:50.997482 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4950.
I0121 09:27:51.018687 140039061227072 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4950.orbax-checkpoint-tmp
I0121 09:27:51.131492 140039078012480 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 09:27:51.179347 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 09:27:51.180709 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 09:27:51.755423 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.578806s
I0121 09:27:51.779226 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 111.295 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 768 milliseconds) (per-host)
I0121 09:27:51.784801 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.774155s (batch_requests_ready=0.110234s, total_serialization_initiated=0.636436s, others=0.027485s)
I0121 09:27:51.785385 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.784034s (all_items=0.000036s, per_item={'default': '0.00003648'}, temp_paths=0.783998)
I0121 09:27:51.858878 140042131449408 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 09:27:51.859814 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.863391s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4950.
I0121 09:27:51.865271 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=4950] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 09:27:51.866520 140041879799360 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 09:27:51.869774 140165176223552 standard_logger.py:34] {'step': Array(4950, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768958870.993414, 'wait_for_prev_duration_secs': 0.0007097721099853516, 'time_between_consecutive_saves_sec': 342.6589705944061, 'checkpointer_blocking_start_time': 1768958870.9963672, 'checkpointer_blocking_duration_secs': 0.8686106204986572, 'get_old_steps_start_time': 1768958871.8650355, 'get_old_steps_duration_secs': 0.00013875961303710938, 'checkpoint_manager_blocking_start_time': 1768958870.9923368, 'checkpoint_manager_blocking_duration_secs': 0.8763852119445801}
I0121 09:27:51.879797 140042274076224 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 09:27:53.400012 140042265683520 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.621156s (commit=1.482681s, array_metadata_write=0.138475s)
I0121 09:27:53.403580 140042131449408 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 35.745 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 09:27:53.404117 140042131449408 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.543381s.
I0121 09:27:53.417896 140042131449408 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 09:27:53.500891 140042131449408 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.093310s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 09:27:53.503181 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4950.orbax-checkpoint-tmp/default
I0121 09:27:53.508713 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4950.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4950
I0121 09:27:53.524971 140042131449408 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4950`.
I0121 09:27:53.528156 140042131449408 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.531747s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4950
I0121 09:27:53.528660 140042131449408 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.667917s.
I0121 09:27:53.529638 140041879799360 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 09:27:53.530302 140041879799360 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 09:27:53.595216 140041879799360 deleter.py:273] Deleted step 4050.
I0121 09:27:53.596072 140041879799360 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=4950] CheckpointManager Save Finalize is syncing with other hosts...
I0121 09:27:53.596927 140041879799360 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=4950] CheckpointManager Save Finalize is done on all hosts.
step: 5400,  loss data: 3.692e-02, loss res: 7.369e-02, time: 1.733e+02
step: 5850,  loss data: 3.598e-02, loss res: 3.758e-02, time: 1.735e+02
I0121 09:33:38.687014 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 09:33:38.689076 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 5850
I0121 09:33:38.690582 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/5850.
I0121 09:33:38.722428 140038507570752 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/5850.orbax-checkpoint-tmp
I0121 09:33:38.812424 140038541141568 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/5850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 09:33:38.857458 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 09:33:38.858422 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 09:33:39.424706 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.570588s
I0121 09:33:39.443312 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 115.515 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 740 milliseconds) (per-host)
I0121 09:33:39.456413 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.753673s (batch_requests_ready=0.099268s, total_serialization_initiated=0.629032s, others=0.025373s)
I0121 09:33:39.463394 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.768459s (all_items=0.000046s, per_item={'default': '0.00004554'}, temp_paths=0.768413)
I0121 09:33:39.557815 140042139842112 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 09:33:39.558667 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.869052s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/5850.
I0121 09:33:39.561616 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=5850] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 09:33:39.563005 140042131449408 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 09:33:39.570337 140165176223552 standard_logger.py:34] {'step': Array(5850, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768959218.68689, 'wait_for_prev_duration_secs': 0.0006396770477294922, 'time_between_consecutive_saves_sec': 345.08973026275635, 'checkpointer_blocking_start_time': 1768959218.6895275, 'checkpointer_blocking_duration_secs': 0.8717823028564453, 'get_old_steps_start_time': 1768959219.5613673, 'get_old_steps_duration_secs': 0.00015687942504882812, 'checkpoint_manager_blocking_start_time': 1768959218.6858244, 'checkpoint_manager_blocking_duration_secs': 0.8792734146118164}
I0121 09:33:39.643300 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/5850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 09:33:41.721477 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 2.276426s (commit=2.147848s, array_metadata_write=0.128577s)
I0121 09:33:41.724823 140042139842112 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 28.303 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 3 seconds) (per-host)
I0121 09:33:41.725465 140042139842112 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 2.165601s.
I0121 09:33:41.738237 140042139842112 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 09:33:41.823369 140042139842112 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.094504s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/5850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 09:33:41.825486 140042139842112 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/5850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/5850.orbax-checkpoint-tmp/default
I0121 09:33:41.831014 140042139842112 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/5850.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/5850
I0121 09:33:41.845668 140042139842112 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/5850`.
I0121 09:33:41.847270 140042139842112 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 3.157692s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/5850
I0121 09:33:41.847762 140042139842112 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 2.287906s.
I0121 09:33:41.848480 140042131449408 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 09:33:41.849260 140042131449408 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 09:33:41.894705 140042131449408 deleter.py:273] Deleted step 4950.
I0121 09:33:41.895262 140042131449408 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=5850] CheckpointManager Save Finalize is syncing with other hosts...
I0121 09:33:41.895922 140042131449408 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=5850] CheckpointManager Save Finalize is done on all hosts.
step: 6300,  loss data: 3.244e-02, loss res: 5.365e-03, time: 1.746e+02
step: 6750,  loss data: 1.921e-02, loss res: 3.023e-02, time: 1.732e+02
I0121 09:39:27.393948 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 09:39:27.396792 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 6750
I0121 09:39:27.398731 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/6750.
I0121 09:39:27.425737 140045084255808 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/6750.orbax-checkpoint-tmp
I0121 09:39:27.530773 140037962307136 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/6750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 09:39:27.569946 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 09:39:27.570815 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 09:39:28.156552 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.589161s
I0121 09:39:28.165490 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 113.564 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 753 milliseconds) (per-host)
I0121 09:39:28.171108 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.758984s (batch_requests_ready=0.103245s, total_serialization_initiated=0.643265s, others=0.012474s)
I0121 09:39:28.182256 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.779825s (all_items=0.000089s, per_item={'default': '0.00008941'}, temp_paths=0.779736)
I0121 09:39:28.262409 140042173412928 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 09:39:28.263366 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.866007s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/6750.
I0121 09:39:28.266701 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=6750] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 09:39:28.272777 140040554407488 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 09:39:28.275916 140165176223552 standard_logger.py:34] {'step': Array(6750, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768959567.3937201, 'wait_for_prev_duration_secs': 0.0008971691131591797, 'time_between_consecutive_saves_sec': 345.4972815513611, 'checkpointer_blocking_start_time': 1768959567.3972762, 'checkpointer_blocking_duration_secs': 0.8689432144165039, 'get_old_steps_start_time': 1768959568.2662954, 'get_old_steps_duration_secs': 0.00025963783264160156, 'checkpoint_manager_blocking_start_time': 1768959567.3920445, 'checkpoint_manager_blocking_duration_secs': 0.8818671703338623}
I0121 09:39:28.334516 140042274076224 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/6750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 09:39:29.997605 140042265683520 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.832667s (commit=1.708006s, array_metadata_write=0.124661s)
I0121 09:39:30.001176 140042173412928 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 33.037 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 09:39:30.001667 140042173412928 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.737759s.
I0121 09:39:30.019354 140042173412928 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 09:39:30.093282 140042173412928 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.088042s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/6750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 09:39:30.095254 140042173412928 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/6750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/6750.orbax-checkpoint-tmp/default
I0121 09:39:30.100650 140042173412928 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/6750.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/6750
I0121 09:39:30.115065 140042173412928 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/6750`.
I0121 09:39:30.116481 140042173412928 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.719152s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/6750
I0121 09:39:30.116772 140042173412928 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.852872s.
I0121 09:39:30.117244 140040554407488 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 09:39:30.118001 140040554407488 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 09:39:30.175338 140040554407488 deleter.py:273] Deleted step 5850.
I0121 09:39:30.176053 140040554407488 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=6750] CheckpointManager Save Finalize is syncing with other hosts...
I0121 09:39:30.176728 140040554407488 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=6750] CheckpointManager Save Finalize is done on all hosts.
step: 7200,  loss data: 2.134e-02, loss res: 2.260e-02, time: 1.740e+02
step: 7650,  loss data: 1.509e-02, loss res: 1.606e-02, time: 1.731e+02
I0121 09:45:15.360024 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 09:45:15.362352 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 7650
I0121 09:45:15.363920 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/7650.
I0121 09:45:15.385372 140038532748864 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/7650.orbax-checkpoint-tmp
I0121 09:45:15.495191 140038499178048 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/7650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 09:45:15.531160 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 09:45:15.531806 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 09:45:16.079669 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.551316s
I0121 09:45:16.103355 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 117.640 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 727 milliseconds) (per-host)
I0121 09:45:16.109734 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.733523s (batch_requests_ready=0.098420s, total_serialization_initiated=0.606107s, others=0.028996s)
I0121 09:45:16.115618 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.747680s (all_items=0.000048s, per_item={'default': '0.00004840'}, temp_paths=0.747632)
I0121 09:45:16.184473 140042265683520 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 09:45:16.186062 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.823202s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/7650.
I0121 09:45:16.187791 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=7650] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 09:45:16.189569 140041879799360 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 09:45:16.191956 140165176223552 standard_logger.py:34] {'step': Array(7650, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768959915.3598776, 'wait_for_prev_duration_secs': 0.0006608963012695312, 'time_between_consecutive_saves_sec': 345.1827402114868, 'checkpointer_blocking_start_time': 1768959915.3628056, 'checkpointer_blocking_duration_secs': 0.8245670795440674, 'get_old_steps_start_time': 1768959916.1874454, 'get_old_steps_duration_secs': 0.00019621849060058594, 'checkpoint_manager_blocking_start_time': 1768959915.3587883, 'checkpoint_manager_blocking_duration_secs': 0.8316669464111328}
I0121 09:45:16.213253 140043767756352 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/7650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 09:45:17.752186 140043725809216 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.654641s (commit=1.504292s, array_metadata_write=0.150348s)
I0121 09:45:17.756258 140042265683520 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 35.938 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 09:45:17.756748 140042265683520 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.571107s.
I0121 09:45:17.770229 140042265683520 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 09:45:17.891676 140042265683520 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.131569s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/7650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 09:45:17.893967 140042265683520 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/7650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/7650.orbax-checkpoint-tmp/default
I0121 09:45:17.899021 140042265683520 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/7650.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/7650
I0121 09:45:17.912131 140042265683520 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/7650`.
I0121 09:45:17.913796 140042265683520 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.550943s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/7650
I0121 09:45:17.914330 140042265683520 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.728683s.
I0121 09:45:17.915152 140041879799360 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 09:45:17.915786 140041879799360 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 09:45:17.978247 140041879799360 deleter.py:273] Deleted step 6750.
I0121 09:45:17.978629 140041879799360 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=7650] CheckpointManager Save Finalize is syncing with other hosts...
I0121 09:45:17.978955 140041879799360 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=7650] CheckpointManager Save Finalize is done on all hosts.
step: 8100,  loss data: 7.147e-03, loss res: 4.697e-02, time: 1.728e+02
step: 8550,  loss data: 6.983e-03, loss res: 2.039e-02, time: 1.729e+02
I0121 09:51:01.928156 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 09:51:01.930401 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 8550
I0121 09:51:01.931916 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/8550.
I0121 09:51:01.958191 140040529229376 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/8550.orbax-checkpoint-tmp
I0121 09:51:02.067775 140039983965760 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/8550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 09:51:02.103589 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 09:51:02.104990 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 09:51:02.633284 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.532434s
I0121 09:51:02.646000 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 121.729 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 702 milliseconds) (per-host)
I0121 09:51:02.652325 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.709070s (batch_requests_ready=0.104076s, total_serialization_initiated=0.597732s, others=0.007262s)
I0121 09:51:02.663722 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.727909s (all_items=0.000035s, per_item={'default': '0.00003505'}, temp_paths=0.727874)
I0121 09:51:02.735179 140042139842112 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 09:51:02.736676 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.805725s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/8550.
I0121 09:51:02.744174 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=8550] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 09:51:02.745588 140041879799360 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 09:51:02.747999 140165176223552 standard_logger.py:34] {'step': Array(8550, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768960261.9280438, 'wait_for_prev_duration_secs': 0.0006744861602783203, 'time_between_consecutive_saves_sec': 343.9488844871521, 'checkpointer_blocking_start_time': 1768960261.9308953, 'checkpointer_blocking_duration_secs': 0.8128578662872314, 'get_old_steps_start_time': 1768960262.7438247, 'get_old_steps_duration_secs': 0.00020265579223632812, 'checkpoint_manager_blocking_start_time': 1768960261.9270732, 'checkpoint_manager_blocking_duration_secs': 0.8198630809783936}
I0121 09:51:02.756889 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/8550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 09:51:04.322202 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.670644s (commit=1.532268s, array_metadata_write=0.138376s)
I0121 09:51:04.326199 140042139842112 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 35.895 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 09:51:04.326710 140042139842112 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.585058s.
I0121 09:51:04.340036 140042139842112 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 09:51:04.414355 140042139842112 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.084315s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/8550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 09:51:04.416516 140042139842112 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/8550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/8550.orbax-checkpoint-tmp/default
I0121 09:51:04.422235 140042139842112 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/8550.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/8550
I0121 09:51:04.437411 140042139842112 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/8550`.
I0121 09:51:04.438924 140042139842112 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.507988s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/8550
I0121 09:51:04.439404 140042139842112 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.697748s.
I0121 09:51:04.440334 140041879799360 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 09:51:04.440922 140041879799360 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 09:51:04.507807 140041879799360 deleter.py:273] Deleted step 7650.
I0121 09:51:04.508263 140041879799360 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=8550] CheckpointManager Save Finalize is syncing with other hosts...
I0121 09:51:04.508769 140041879799360 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=8550] CheckpointManager Save Finalize is done on all hosts.
step: 9000,  loss data: 5.317e-03, loss res: 4.198e-03, time: 1.736e+02
Epoch 20, getting batches from DataLoader...
step: 9450,  loss data: 2.754e-03, loss res: 7.874e-03, time: 1.739e+02
I0121 09:56:50.228172 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 09:56:50.230702 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 9450
I0121 09:56:50.232313 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/9450.
I0121 09:56:50.248776 140038004270656 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/9450.orbax-checkpoint-tmp
I0121 09:56:50.380384 140039975573056 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/9450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 09:56:50.406295 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 09:56:50.407181 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 09:56:51.575923 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 1.172537s
I0121 09:56:51.599648 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 63.177 MiB/s (total gbytes: 85.5 MiB) (time elapsed: a second) (per-host)
I0121 09:56:51.605956 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 1.360228s (batch_requests_ready=0.103957s, total_serialization_initiated=1.228194s, others=0.028077s)
I0121 09:56:51.681258 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 1.444867s (all_items=0.000052s, per_item={'default': '0.00005245'}, temp_paths=1.444814)
I0121 09:56:51.695196 140042131449408 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 09:56:51.695468 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 1.464275s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/9450.
I0121 09:56:51.697125 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=9450] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 09:56:51.697683 140042257290816 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 09:56:51.699751 140165176223552 standard_logger.py:34] {'step': Array(9450, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768960610.2280364, 'wait_for_prev_duration_secs': 0.0006575584411621094, 'time_between_consecutive_saves_sec': 345.71899247169495, 'checkpointer_blocking_start_time': 1768960610.231146, 'checkpointer_blocking_duration_secs': 1.4657495021820068, 'get_old_steps_start_time': 1768960611.6969492, 'get_old_steps_duration_secs': 0.00010442733764648438, 'checkpoint_manager_blocking_start_time': 1768960610.2269533, 'checkpoint_manager_blocking_duration_secs': 1.4715855121612549}
I0121 09:56:51.713116 140042274076224 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/9450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 09:56:53.229818 140042265683520 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.618287s (commit=1.475029s, array_metadata_write=0.143258s)
I0121 09:56:53.234401 140042131449408 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 28.620 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 09:56:53.234862 140042131449408 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.538952s.
I0121 09:56:53.247474 140042131449408 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 09:56:53.313102 140042131449408 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.074721s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/9450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 09:56:53.315602 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/9450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/9450.orbax-checkpoint-tmp/default
I0121 09:56:53.320629 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/9450.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/9450
I0121 09:56:53.335210 140042131449408 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/9450`.
I0121 09:56:53.336839 140042131449408 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 3.105643s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/9450
I0121 09:56:53.337356 140042131449408 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.641440s.
I0121 09:56:53.338024 140042257290816 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 09:56:53.338765 140042257290816 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 09:56:53.402596 140042257290816 deleter.py:273] Deleted step 8550.
I0121 09:56:53.403372 140042257290816 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=9450] CheckpointManager Save Finalize is syncing with other hosts...
I0121 09:56:53.404189 140042257290816 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=9450] CheckpointManager Save Finalize is done on all hosts.
step: 9900,  loss data: 3.796e-03, loss res: 2.874e-02, time: 1.748e+02
step: 10350,  loss data: 6.149e-03, loss res: 2.417e-02, time: 1.740e+02
I0121 10:02:40.555920 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 10:02:40.558631 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 10350
I0121 10:02:40.560317 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/10350.
I0121 10:02:40.581486 140040017536576 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/10350.orbax-checkpoint-tmp
I0121 10:02:40.686528 140039983965760 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/10350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 10:02:40.754844 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 10:02:40.755997 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 10:02:41.376718 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.624908s
I0121 10:02:41.421022 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 100.855 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 848 milliseconds) (per-host)
I0121 10:02:41.473670 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.900826s (batch_requests_ready=0.114846s, total_serialization_initiated=0.706248s, others=0.079731s)
I0121 10:02:41.474693 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.910440s (all_items=0.000058s, per_item={'default': '0.00005841'}, temp_paths=0.910382)
I0121 10:02:41.481661 140042165020224 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 10:02:41.487706 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.928478s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/10350.
I0121 10:02:41.490465 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=10350] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 10:02:41.491931 140041879799360 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 10:02:41.494482 140165176223552 standard_logger.py:34] {'step': Array(10350, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768960960.5557814, 'wait_for_prev_duration_secs': 0.0007171630859375, 'time_between_consecutive_saves_sec': 347.15113043785095, 'checkpointer_blocking_start_time': 1768960960.5591404, 'checkpointer_blocking_duration_secs': 0.9307775497436523, 'get_old_steps_start_time': 1768960961.4900079, 'get_old_steps_duration_secs': 0.00030231475830078125, 'checkpoint_manager_blocking_start_time': 1768960960.5546143, 'checkpoint_manager_blocking_duration_secs': 0.9390952587127686}
I0121 10:02:41.503526 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/10350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 10:02:43.591159 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 2.164531s (commit=1.399905s, array_metadata_write=0.764626s)
I0121 10:02:43.594592 140042165020224 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 28.306 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 3 seconds) (per-host)
I0121 10:02:43.595057 140042165020224 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 2.112132s.
I0121 10:02:43.611058 140042165020224 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 10:02:43.682699 140042165020224 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.082978s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/10350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 10:02:43.685213 140042165020224 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/10350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/10350.orbax-checkpoint-tmp/default
I0121 10:02:43.690540 140042165020224 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/10350.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/10350
I0121 10:02:43.703609 140042165020224 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/10350`.
I0121 10:02:43.705379 140042165020224 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 3.146189s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/10350
I0121 10:02:43.705868 140042165020224 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 2.222938s.
I0121 10:02:43.706745 140041879799360 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 10:02:43.707357 140041879799360 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 10:02:43.760808 140041879799360 deleter.py:273] Deleted step 9450.
I0121 10:02:43.761371 140041879799360 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=10350] CheckpointManager Save Finalize is syncing with other hosts...
I0121 10:02:43.761749 140041879799360 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=10350] CheckpointManager Save Finalize is done on all hosts.
step: 10800,  loss data: 2.564e-02, loss res: 7.796e-02, time: 1.741e+02
step: 11250,  loss data: 3.489e-03, loss res: 2.691e-02, time: 1.733e+02
I0121 10:08:28.961948 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 10:08:28.963401 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 11250
I0121 10:08:28.964272 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/11250.
I0121 10:08:28.994337 140039044441664 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/11250.orbax-checkpoint-tmp
I0121 10:08:29.034099 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 10:08:29.034632 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 10:08:29.049820 140040000751168 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/11250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 10:08:29.386086 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.355736s
I0121 10:08:29.394534 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 202.392 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 422 milliseconds) (per-host)
I0121 10:08:29.400963 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.429240s (batch_requests_ready=0.034560s, total_serialization_initiated=0.386561s, others=0.008119s)
I0121 10:08:29.407211 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.440145s (all_items=0.000036s, per_item={'default': '0.00003552'}, temp_paths=0.440109)
I0121 10:08:29.495653 140041879799360 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 10:08:29.496534 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.532881s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/11250.
I0121 10:08:29.499149 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=11250] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 10:08:29.504430 140041871406656 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 10:08:29.507239 140165176223552 standard_logger.py:34] {'step': Array(11250, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768961308.96185, 'wait_for_prev_duration_secs': 0.0004036426544189453, 'time_between_consecutive_saves_sec': 345.19987511634827, 'checkpointer_blocking_start_time': 1768961308.9635887, 'checkpointer_blocking_duration_secs': 0.5350415706634521, 'get_old_steps_start_time': 1768961309.4987268, 'get_old_steps_duration_secs': 0.0002701282501220703, 'checkpoint_manager_blocking_start_time': 1768961308.9610515, 'checkpoint_manager_blocking_duration_secs': 0.5446131229400635}
I0121 10:08:29.534615 140042274076224 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/11250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 10:08:30.981553 140042265683520 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.586244s (commit=1.441568s, array_metadata_write=0.144676s)
I0121 10:08:30.986251 140041879799360 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 42.460 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 10:08:30.986792 140041879799360 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.489715s.
I0121 10:08:30.999451 140041879799360 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 10:08:31.064196 140041879799360 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.073904s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/11250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 10:08:31.066612 140041879799360 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/11250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/11250.orbax-checkpoint-tmp/default
I0121 10:08:31.072036 140041879799360 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/11250.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/11250
I0121 10:08:31.086715 140041879799360 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/11250`.
I0121 10:08:31.088385 140041879799360 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.124750s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/11250
I0121 10:08:31.088890 140041879799360 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.591809s.
I0121 10:08:31.089855 140041871406656 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 10:08:31.090375 140041871406656 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 10:08:31.141921 140041871406656 deleter.py:273] Deleted step 10350.
I0121 10:08:31.142402 140041871406656 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=11250] CheckpointManager Save Finalize is syncing with other hosts...
I0121 10:08:31.142765 140041871406656 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=11250] CheckpointManager Save Finalize is done on all hosts.
step: 11700,  loss data: 6.252e-03, loss res: 1.773e-02, time: 1.725e+02
step: 12150,  loss data: 3.292e-03, loss res: 2.716e-02, time: 1.707e+02
I0121 10:14:12.776342 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 10:14:12.779288 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 12150
I0121 10:14:12.781455 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/12150.
I0121 10:14:12.807516 140042139842112 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/12150.orbax-checkpoint-tmp
I0121 10:14:12.913648 140039069619776 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/12150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 10:14:12.954129 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 10:14:12.955691 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 10:14:13.514323 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.563023s
I0121 10:14:13.542895 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 114.427 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 747 milliseconds) (per-host)
I0121 10:14:13.548570 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.753380s (batch_requests_ready=0.103005s, total_serialization_initiated=0.633163s, others=0.017212s)
I0121 10:14:13.559367 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.774351s (all_items=0.000092s, per_item={'default': '0.00009155'}, temp_paths=0.774260)
I0121 10:14:13.613673 140042265683520 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 10:14:13.614271 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.834400s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/12150.
I0121 10:14:13.616051 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=12150] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 10:14:13.617340 140041871406656 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 10:14:13.618998 140165176223552 standard_logger.py:34] {'step': Array(12150, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768961652.776111, 'wait_for_prev_duration_secs': 0.0008907318115234375, 'time_between_consecutive_saves_sec': 341.6331388950348, 'checkpointer_blocking_start_time': 1768961652.7798097, 'checkpointer_blocking_duration_secs': 0.8359925746917725, 'get_old_steps_start_time': 1768961653.6158545, 'get_old_steps_duration_secs': 0.00014138221740722656, 'checkpoint_manager_blocking_start_time': 1768961652.7746017, 'checkpoint_manager_blocking_duration_secs': 0.8436853885650635}
I0121 10:14:13.638397 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/12150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 10:14:15.122733 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.531466s (commit=1.404158s, array_metadata_write=0.127309s)
I0121 10:14:15.126653 140042265683520 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 36.686 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 10:14:15.127189 140042265683520 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.512565s.
I0121 10:14:15.139786 140042265683520 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 10:14:15.207539 140042265683520 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.077112s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/12150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 10:14:15.209438 140042265683520 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/12150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/12150.orbax-checkpoint-tmp/default
I0121 10:14:15.214417 140042265683520 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/12150.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/12150
I0121 10:14:15.254256 140042265683520 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/12150`.
I0121 10:14:15.255814 140042265683520 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.475945s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/12150
I0121 10:14:15.256166 140042265683520 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.641551s.
I0121 10:14:15.256789 140041871406656 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 10:14:15.257288 140041871406656 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 10:14:15.298805 140041871406656 deleter.py:273] Deleted step 11250.
I0121 10:14:15.299248 140041871406656 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=12150] CheckpointManager Save Finalize is syncing with other hosts...
I0121 10:14:15.299594 140041871406656 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=12150] CheckpointManager Save Finalize is done on all hosts.
step: 12600,  loss data: 4.820e-03, loss res: 1.901e-02, time: 1.716e+02
step: 13050,  loss data: 9.124e-03, loss res: 1.552e-02, time: 1.736e+02
I0121 10:19:58.887044 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 10:19:58.889554 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 13050
I0121 10:19:58.891248 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13050.
I0121 10:19:58.914527 140040537622080 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13050.orbax-checkpoint-tmp
I0121 10:19:59.020901 140039983965760 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 10:19:59.059581 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 10:19:59.060487 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 10:19:59.639494 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.582659s
I0121 10:19:59.658535 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 113.317 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 754 milliseconds) (per-host)
I0121 10:19:59.685622 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.781982s (batch_requests_ready=0.100275s, total_serialization_initiated=0.642455s, others=0.039252s)
I0121 10:19:59.707956 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.812293s (all_items=0.000041s, per_item={'default': '0.00004053'}, temp_paths=0.812253)
I0121 10:19:59.749202 140042257290816 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 10:19:59.749959 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.859855s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13050.
I0121 10:19:59.752063 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=13050] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 10:19:59.756384 140042131449408 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 10:19:59.759149 140165176223552 standard_logger.py:34] {'step': Array(13050, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768961998.8869233, 'wait_for_prev_duration_secs': 0.0006988048553466797, 'time_between_consecutive_saves_sec': 343.5871229171753, 'checkpointer_blocking_start_time': 1768961998.8900437, 'checkpointer_blocking_duration_secs': 0.861588716506958, 'get_old_steps_start_time': 1768961999.7517178, 'get_old_steps_duration_secs': 0.00021886825561523438, 'checkpoint_manager_blocking_start_time': 1768961998.885569, 'checkpoint_manager_blocking_duration_secs': 0.8721296787261963}
I0121 10:19:59.785485 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 10:20:01.387872 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.713318s (commit=1.600178s, array_metadata_write=0.113139s)
I0121 10:20:01.391378 140042257290816 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 34.382 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 10:20:01.391970 140042257290816 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.641591s.
I0121 10:20:01.412480 140042257290816 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 10:20:01.522406 140042257290816 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.124751s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 10:20:01.524833 140042257290816 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13050.orbax-checkpoint-tmp/default
I0121 10:20:01.531317 140042257290816 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13050.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13050
I0121 10:20:01.551673 140042257290816 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13050`.
I0121 10:20:01.553260 140042257290816 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.663174s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13050
I0121 10:20:01.553748 140042257290816 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.803373s.
I0121 10:20:01.554467 140042131449408 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 10:20:01.555076 140042131449408 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 10:20:01.666404 140042131449408 deleter.py:273] Deleted step 12150.
I0121 10:20:01.667313 140042131449408 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=13050] CheckpointManager Save Finalize is syncing with other hosts...
I0121 10:20:01.668150 140042131449408 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=13050] CheckpointManager Save Finalize is done on all hosts.
step: 13500,  loss data: 1.919e-03, loss res: 1.181e-02, time: 1.735e+02
Epoch 30, getting batches from DataLoader...
step: 13950,  loss data: 5.468e-03, loss res: 1.321e-02, time: 1.742e+02
I0121 10:25:47.504648 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 10:25:47.506923 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 13950
I0121 10:25:47.508339 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13950.
I0121 10:25:47.540000 140040000751168 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13950.orbax-checkpoint-tmp
I0121 10:25:47.645294 140039052834368 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 10:25:47.675866 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 10:25:47.676679 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 10:25:48.185253 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.512076s
I0121 10:25:48.203367 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 125.176 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 683 milliseconds) (per-host)
I0121 10:25:48.214785 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.694833s (batch_requests_ready=0.100162s, total_serialization_initiated=0.571365s, others=0.023306s)
I0121 10:25:48.221071 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.708617s (all_items=0.000035s, per_item={'default': '0.00003529'}, temp_paths=0.708582)
I0121 10:25:48.892909 140033222755904 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 10:25:48.897674 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 1.390255s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13950.
I0121 10:25:48.900509 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=13950] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 10:25:48.901308 140032711063104 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 10:25:48.919069 140165176223552 standard_logger.py:34] {'step': Array(13950, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768962347.5045385, 'wait_for_prev_duration_secs': 0.0006070137023925781, 'time_between_consecutive_saves_sec': 345.8360457420349, 'checkpointer_blocking_start_time': 1768962347.507364, 'checkpointer_blocking_duration_secs': 1.3927996158599854, 'get_old_steps_start_time': 1768962348.9002361, 'get_old_steps_duration_secs': 0.00017070770263671875, 'checkpoint_manager_blocking_start_time': 1768962347.5035746, 'checkpoint_manager_blocking_duration_secs': 1.402590274810791}
I0121 10:25:49.116122 140042265683520 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 10:25:50.290473 140042257290816 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 2.087514s (commit=2.017953s, array_metadata_write=0.069561s)
I0121 10:25:50.293275 140033222755904 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 30.841 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 10:25:50.293837 140033222755904 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.395051s.
I0121 10:25:50.310059 140033222755904 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 10:25:50.382582 140033222755904 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.085074s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 10:25:50.385189 140033222755904 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13950.orbax-checkpoint-tmp/default
I0121 10:25:50.391796 140033222755904 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13950.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13950
I0121 10:25:50.415771 140033222755904 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13950`.
I0121 10:25:50.417297 140033222755904 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.909890s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13950
I0121 10:25:50.417789 140033222755904 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.519003s.
I0121 10:25:50.418486 140032711063104 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 10:25:50.419242 140032711063104 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 10:25:50.475144 140032711063104 deleter.py:273] Deleted step 13050.
I0121 10:25:50.475615 140032711063104 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=13950] CheckpointManager Save Finalize is syncing with other hosts...
I0121 10:25:50.476139 140032711063104 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=13950] CheckpointManager Save Finalize is done on all hosts.
step: 14400,  loss data: 3.028e-03, loss res: 1.332e-02, time: 1.743e+02
step: 14850,  loss data: 3.926e-03, loss res: 1.600e-02, time: 1.747e+02
I0121 10:31:38.007812 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 10:31:38.010699 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 14850
I0121 10:31:38.012774 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/14850.
I0121 10:31:38.041044 140034850154048 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/14850.orbax-checkpoint-tmp
I0121 10:31:38.155113 140035949041216 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/14850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 10:31:38.191388 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 10:31:38.193075 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 10:31:38.770438 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.581894s
I0121 10:31:38.788216 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 112.718 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 758 milliseconds) (per-host)
I0121 10:31:38.800559 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.771356s (batch_requests_ready=0.105222s, total_serialization_initiated=0.642091s, others=0.024043s)
I0121 10:31:38.837945 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.820384s (all_items=0.000090s, per_item={'default': '0.00009036'}, temp_paths=0.820294)
I0121 10:31:38.860076 140042139842112 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 10:31:38.860864 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.849589s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/14850.
I0121 10:31:38.864415 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=14850] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 10:31:38.866080 140042131449408 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 10:31:38.871638 140165176223552 standard_logger.py:34] {'step': Array(14850, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768962698.0075831, 'wait_for_prev_duration_secs': 0.0008862018585205078, 'time_between_consecutive_saves_sec': 347.5312170982361, 'checkpointer_blocking_start_time': 1768962698.011182, 'checkpointer_blocking_duration_secs': 0.8526978492736816, 'get_old_steps_start_time': 1768962698.8639693, 'get_old_steps_duration_secs': 0.00028395652770996094, 'checkpoint_manager_blocking_start_time': 1768962698.0059807, 'checkpoint_manager_blocking_duration_secs': 0.8615014553070068}
I0121 10:31:38.887331 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/14850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 10:31:40.424799 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.630985s (commit=1.506371s, array_metadata_write=0.124614s)
I0121 10:31:40.428805 140042139842112 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 35.645 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 10:31:40.429278 140042139842112 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.567432s.
I0121 10:31:40.446781 140042139842112 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 10:31:40.540299 140042139842112 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.105974s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/14850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 10:31:40.542818 140042139842112 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/14850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/14850.orbax-checkpoint-tmp/default
I0121 10:31:40.548382 140042139842112 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/14850.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/14850
I0121 10:31:40.564016 140042139842112 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/14850`.
I0121 10:31:40.565646 140042139842112 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.554393s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/14850
I0121 10:31:40.566342 140042139842112 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.704490s.
I0121 10:31:40.567379 140042131449408 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 10:31:40.567968 140042131449408 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 10:31:40.641873 140042131449408 deleter.py:273] Deleted step 13950.
I0121 10:31:40.642416 140042131449408 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=14850] CheckpointManager Save Finalize is syncing with other hosts...
I0121 10:31:40.642767 140042131449408 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=14850] CheckpointManager Save Finalize is done on all hosts.
step: 15300,  loss data: 3.949e-03, loss res: 1.679e-02, time: 1.736e+02
step: 15750,  loss data: 2.928e-03, loss res: 9.447e-03, time: 1.729e+02
I0121 10:37:25.427452 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 10:37:25.429859 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 15750
I0121 10:37:25.431433 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/15750.
I0121 10:37:25.467679 140041871406656 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/15750.orbax-checkpoint-tmp
I0121 10:37:25.572268 140042173412928 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/15750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 10:37:25.597796 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 10:37:25.598472 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 10:37:26.204468 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.609267s
I0121 10:37:26.207030 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 111.939 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 764 milliseconds) (per-host)
I0121 10:37:26.224334 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.781482s (batch_requests_ready=0.098538s, total_serialization_initiated=0.664582s, others=0.018361s)
I0121 10:37:26.230880 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.795872s (all_items=0.000035s, per_item={'default': '0.00003529'}, temp_paths=0.795836)
I0121 10:37:26.313255 140042139842112 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 10:37:26.315696 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.885279s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/15750.
I0121 10:37:26.321899 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=15750] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 10:37:26.331351 140042131449408 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 10:37:26.334928 140165176223552 standard_logger.py:34] {'step': Array(15750, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768963045.4273345, 'wait_for_prev_duration_secs': 0.0006353855133056641, 'time_between_consecutive_saves_sec': 344.78436517715454, 'checkpointer_blocking_start_time': 1768963045.4303598, 'checkpointer_blocking_duration_secs': 0.8906817436218262, 'get_old_steps_start_time': 1768963046.3213916, 'get_old_steps_duration_secs': 0.00031638145446777344, 'checkpoint_manager_blocking_start_time': 1768963045.42623, 'checkpoint_manager_blocking_duration_secs': 0.9073846340179443}
I0121 10:37:26.347375 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/15750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 10:37:27.988853 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.765145s (commit=1.640652s, array_metadata_write=0.124493s)
I0121 10:37:27.992492 140042139842112 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 33.547 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 10:37:27.992901 140042139842112 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.677978s.
I0121 10:37:28.004788 140042139842112 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 10:37:28.089652 140042139842112 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.093707s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/15750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 10:37:28.092903 140042139842112 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/15750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/15750.orbax-checkpoint-tmp/default
I0121 10:37:28.098728 140042139842112 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/15750.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/15750
I0121 10:37:28.141703 140042139842112 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/15750`.
I0121 10:37:28.144129 140042139842112 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.713723s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/15750
I0121 10:37:28.145202 140042139842112 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.830269s.
I0121 10:37:28.146274 140042131449408 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 10:37:28.147255 140042131449408 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 10:37:28.206939 140042131449408 deleter.py:273] Deleted step 14850.
I0121 10:37:28.207320 140042131449408 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=15750] CheckpointManager Save Finalize is syncing with other hosts...
I0121 10:37:28.207668 140042131449408 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=15750] CheckpointManager Save Finalize is done on all hosts.
step: 16200,  loss data: 3.790e-03, loss res: 8.691e-03, time: 1.754e+02
step: 16650,  loss data: 1.698e-03, loss res: 4.680e-03, time: 1.733e+02
I0121 10:43:15.073785 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 10:43:15.076869 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 16650
I0121 10:43:15.079053 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/16650.
I0121 10:43:15.111706 140040546014784 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/16650.orbax-checkpoint-tmp
I0121 10:43:15.218689 140039044441664 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/16650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 10:43:15.260817 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 10:43:15.261712 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 10:43:15.855710 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.598336s
I0121 10:43:15.890700 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 107.332 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 796 milliseconds) (per-host)
I0121 10:43:15.896333 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.802729s (batch_requests_ready=0.109534s, total_serialization_initiated=0.659735s, others=0.033461s)
I0121 10:43:15.902262 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.818676s (all_items=0.000090s, per_item={'default': '0.00008965'}, temp_paths=0.818586)
I0121 10:43:15.965169 140042139842112 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 10:43:15.966547 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.889086s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/16650.
I0121 10:43:15.972300 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=16650] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 10:43:15.974059 140042131449408 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 10:43:15.977712 140165176223552 standard_logger.py:34] {'step': Array(16650, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768963395.0735621, 'wait_for_prev_duration_secs': 0.0009233951568603516, 'time_between_consecutive_saves_sec': 346.8656816482544, 'checkpointer_blocking_start_time': 1768963395.077381, 'checkpointer_blocking_duration_secs': 0.8944222927093506, 'get_old_steps_start_time': 1768963395.9718897, 'get_old_steps_duration_secs': 0.00026345252990722656, 'checkpoint_manager_blocking_start_time': 1768963395.072099, 'checkpoint_manager_blocking_duration_secs': 0.9039719104766846}
I0121 10:43:16.028405 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/16650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 10:43:17.688249 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.814176s (commit=1.662892s, array_metadata_write=0.151283s)
I0121 10:43:17.695122 140042139842112 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 32.878 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 10:43:17.695991 140042139842112 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.728952s.
I0121 10:43:17.717145 140042139842112 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 10:43:17.803615 140042139842112 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.102171s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/16650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 10:43:17.806082 140042139842112 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/16650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/16650.orbax-checkpoint-tmp/default
I0121 10:43:17.811870 140042139842112 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/16650.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/16650
I0121 10:43:17.826545 140042139842112 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/16650`.
I0121 10:43:17.828143 140042139842112 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.750696s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/16650
I0121 10:43:17.828610 140042139842112 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.861578s.
I0121 10:43:17.829224 140042131449408 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 10:43:17.829892 140042131449408 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 10:43:17.889687 140042131449408 deleter.py:273] Deleted step 15750.
I0121 10:43:17.890428 140042131449408 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=16650] CheckpointManager Save Finalize is syncing with other hosts...
I0121 10:43:17.891164 140042131449408 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=16650] CheckpointManager Save Finalize is done on all hosts.
step: 17100,  loss data: 4.968e-03, loss res: 2.211e-02, time: 1.730e+02
step: 17550,  loss data: 1.681e-03, loss res: 9.509e-03, time: 1.732e+02
I0121 10:49:02.237897 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 10:49:02.240497 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 17550
I0121 10:49:02.242127 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/17550.
I0121 10:49:02.258023 140039983965760 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/17550.orbax-checkpoint-tmp
I0121 10:49:02.358450 140039975573056 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/17550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 10:49:02.414618 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 10:49:02.415643 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 10:49:02.948112 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.536178s
I0121 10:49:02.987980 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 116.693 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 732 milliseconds) (per-host)
I0121 10:49:03.017061 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.762120s (batch_requests_ready=0.104425s, total_serialization_initiated=0.595458s, others=0.062238s)
I0121 10:49:03.054674 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.808795s (all_items=0.000041s, per_item={'default': '0.00004125'}, temp_paths=0.808754)
I0121 10:49:03.065343 140042257290816 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 10:49:03.066706 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.825661s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/17550.
I0121 10:49:03.068618 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=17550] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 10:49:03.070354 140041871406656 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 10:49:03.073329 140165176223552 standard_logger.py:34] {'step': Array(17550, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768963742.2377818, 'wait_for_prev_duration_secs': 0.0006959438323974609, 'time_between_consecutive_saves_sec': 344.34615087509155, 'checkpointer_blocking_start_time': 1768963742.2409859, 'checkpointer_blocking_duration_secs': 0.8271722793579102, 'get_old_steps_start_time': 1768963743.0682464, 'get_old_steps_duration_secs': 0.0002117156982421875, 'checkpoint_manager_blocking_start_time': 1768963742.2365582, 'checkpoint_manager_blocking_duration_secs': 0.8355741500854492}
I0121 10:49:03.081529 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/17550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 10:49:04.487691 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.472225s (commit=1.337564s, array_metadata_write=0.134661s)
I0121 10:49:04.491566 140042257290816 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 38.241 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 10:49:04.491991 140042257290816 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.425390s.
I0121 10:49:04.509510 140042257290816 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 10:49:04.576107 140042257290816 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.079827s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/17550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 10:49:04.578690 140042257290816 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/17550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/17550.orbax-checkpoint-tmp/default
I0121 10:49:04.584081 140042257290816 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/17550.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/17550
I0121 10:49:04.599041 140042257290816 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/17550`.
I0121 10:49:04.600702 140042257290816 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.359674s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/17550
I0121 10:49:04.601184 140042257290816 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.534575s.
I0121 10:49:04.602012 140041871406656 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 10:49:04.603360 140041871406656 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 10:49:04.669756 140041871406656 deleter.py:273] Deleted step 16650.
I0121 10:49:04.670352 140041871406656 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=17550] CheckpointManager Save Finalize is syncing with other hosts...
I0121 10:49:04.671082 140041871406656 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=17550] CheckpointManager Save Finalize is done on all hosts.
step: 18000,  loss data: 2.723e-03, loss res: 9.125e-03, time: 1.750e+02
Epoch 40, getting batches from DataLoader...
step: 18450,  loss data: 2.919e-03, loss res: 1.485e-02, time: 1.745e+02
I0121 10:54:52.635555 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 10:54:52.638423 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 18450
I0121 10:54:52.640623 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/18450.
I0121 10:54:52.678034 140038541141568 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/18450.orbax-checkpoint-tmp
I0121 10:54:52.804590 140038004270656 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/18450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 10:54:52.819117 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 10:54:52.819971 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 10:54:53.415770 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.599650s
I0121 10:54:53.434831 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 109.837 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 778 milliseconds) (per-host)
I0121 10:54:53.446458 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.790547s (batch_requests_ready=0.107823s, total_serialization_initiated=0.653399s, others=0.029325s)
I0121 10:54:53.447589 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.802444s (all_items=0.000092s, per_item={'default': '0.00009203'}, temp_paths=0.802352)
I0121 10:54:53.522019 140042131449408 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 10:54:53.523179 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.884142s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/18450.
I0121 10:54:53.525650 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=18450] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 10:54:53.532446 140041879799360 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 10:54:53.535268 140165176223552 standard_logger.py:34] {'step': Array(18450, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768964092.6353369, 'wait_for_prev_duration_secs': 0.0008196830749511719, 'time_between_consecutive_saves_sec': 347.963919878006, 'checkpointer_blocking_start_time': 1768964092.6389496, 'checkpointer_blocking_duration_secs': 0.8861832618713379, 'get_old_steps_start_time': 1768964093.5252118, 'get_old_steps_duration_secs': 0.00028777122497558594, 'checkpoint_manager_blocking_start_time': 1768964092.6338904, 'checkpoint_manager_blocking_duration_secs': 0.8996481895446777}
I0121 10:54:53.555957 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/18450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 10:54:55.892236 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 2.463224s (commit=2.308462s, array_metadata_write=0.154762s)
I0121 10:54:55.896747 140042131449408 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 26.392 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 3 seconds) (per-host)
I0121 10:54:55.897389 140042131449408 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 2.374035s.
I0121 10:54:55.941920 140042131449408 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 10:54:56.068064 140042131449408 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.152546s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/18450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 10:54:56.070797 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/18450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/18450.orbax-checkpoint-tmp/default
I0121 10:54:56.076413 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/18450.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/18450
I0121 10:54:56.099338 140042131449408 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/18450`.
I0121 10:54:56.100853 140042131449408 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 3.461836s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/18450
I0121 10:54:56.101335 140042131449408 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 2.577989s.
I0121 10:54:56.102376 140041879799360 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 10:54:56.102903 140041879799360 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 10:54:56.233544 140041879799360 deleter.py:273] Deleted step 17550.
I0121 10:54:56.234458 140041879799360 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=18450] CheckpointManager Save Finalize is syncing with other hosts...
I0121 10:54:56.235064 140041879799360 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=18450] CheckpointManager Save Finalize is done on all hosts.
step: 18900,  loss data: 1.219e-03, loss res: 3.298e-03, time: 1.713e+02
step: 19350,  loss data: 2.373e-03, loss res: 1.645e-02, time: 1.727e+02
I0121 11:00:37.486113 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 11:00:37.488523 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 19350
I0121 11:00:37.490020 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/19350.
I0121 11:00:37.520401 140040529229376 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/19350.orbax-checkpoint-tmp
I0121 11:00:37.628438 140039052834368 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/19350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 11:00:37.653202 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 11:00:37.653866 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 11:00:38.189570 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.539164s
I0121 11:00:38.207263 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 121.182 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 705 milliseconds) (per-host)
I0121 11:00:38.218095 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.716740s (batch_requests_ready=0.096591s, total_serialization_initiated=0.593223s, others=0.026926s)
I0121 11:00:38.235454 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.741870s (all_items=0.000036s, per_item={'default': '0.00003552'}, temp_paths=0.741834)
I0121 11:00:38.294626 140042257290816 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 11:00:38.295505 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.806456s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/19350.
I0121 11:00:38.302758 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=19350] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 11:00:38.305811 140042173412928 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 11:00:38.308182 140165176223552 standard_logger.py:34] {'step': Array(19350, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768964437.4860065, 'wait_for_prev_duration_secs': 0.000637054443359375, 'time_between_consecutive_saves_sec': 341.2505750656128, 'checkpointer_blocking_start_time': 1768964437.488981, 'checkpointer_blocking_duration_secs': 0.813330888748169, 'get_old_steps_start_time': 1768964438.3023996, 'get_old_steps_duration_secs': 0.0002052783966064453, 'checkpoint_manager_blocking_start_time': 1768964437.4850166, 'checkpoint_manager_blocking_duration_secs': 0.8214874267578125}
I0121 11:00:38.400894 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/19350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 11:00:39.857875 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.633595s (commit=1.494189s, array_metadata_write=0.139406s)
I0121 11:00:39.862338 140042257290816 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 36.228 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 11:00:39.862844 140042257290816 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.566688s.
I0121 11:00:39.875638 140042257290816 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 11:00:39.940867 140042257290816 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.074719s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/19350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 11:00:39.943364 140042257290816 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/19350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/19350.orbax-checkpoint-tmp/default
I0121 11:00:39.948391 140042257290816 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/19350.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/19350
I0121 11:00:39.964964 140042257290816 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/19350`.
I0121 11:00:39.966656 140042257290816 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.477634s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/19350
I0121 11:00:39.967146 140042257290816 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.670986s.
I0121 11:00:39.968144 140042173412928 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 11:00:39.968640 140042173412928 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 11:00:40.026960 140042173412928 deleter.py:273] Deleted step 18450.
I0121 11:00:40.027953 140042173412928 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=19350] CheckpointManager Save Finalize is syncing with other hosts...
I0121 11:00:40.028678 140042173412928 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=19350] CheckpointManager Save Finalize is done on all hosts.
step: 19800,  loss data: 1.501e-03, loss res: 3.574e-03, time: 1.728e+02
step: 20250,  loss data: 1.713e-03, loss res: 1.272e-02, time: 1.727e+02
I0121 11:06:23.847984 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 11:06:23.850706 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 20250
I0121 11:06:23.852767 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/20250.
I0121 11:06:23.900942 140039069619776 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/20250.orbax-checkpoint-tmp
I0121 11:06:24.026295 140040025929280 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/20250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 11:06:24.026872 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 11:06:24.028577 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 11:06:24.623881 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.600482s
I0121 11:06:24.632052 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 111.614 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 766 milliseconds) (per-host)
I0121 11:06:24.643861 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.778313s (batch_requests_ready=0.102386s, total_serialization_initiated=0.657411s, others=0.018516s)
I0121 11:06:24.671550 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.814668s (all_items=0.000080s, per_item={'default': '0.00008035'}, temp_paths=0.814588)
I0121 11:06:24.729386 140042148234816 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 11:06:24.730620 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.879322s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/20250.
I0121 11:06:24.732309 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=20250] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 11:06:24.734578 140042139842112 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 11:06:24.740056 140165176223552 standard_logger.py:34] {'step': Array(20250, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768964783.8478055, 'wait_for_prev_duration_secs': 0.0007956027984619141, 'time_between_consecutive_saves_sec': 343.8188614845276, 'checkpointer_blocking_start_time': 1768964783.8512177, 'checkpointer_blocking_duration_secs': 0.8805675506591797, 'get_old_steps_start_time': 1768964784.7318692, 'get_old_steps_duration_secs': 0.00029540061950683594, 'checkpoint_manager_blocking_start_time': 1768964783.8464248, 'checkpoint_manager_blocking_duration_secs': 0.8921473026275635}
I0121 11:06:24.755755 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/20250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 11:06:26.341720 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.703990s (commit=1.557206s, array_metadata_write=0.146784s)
I0121 11:06:26.346566 140042148234816 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 34.475 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 11:06:26.347048 140042148234816 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.616538s.
I0121 11:06:26.360464 140042148234816 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 11:06:26.453812 140042148234816 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.103361s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/20250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 11:06:26.456426 140042148234816 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/20250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/20250.orbax-checkpoint-tmp/default
I0121 11:06:26.462083 140042148234816 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/20250.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/20250
I0121 11:06:26.496503 140042148234816 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/20250`.
I0121 11:06:26.498096 140042148234816 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.646813s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/20250
I0121 11:06:26.498731 140042148234816 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.768205s.
I0121 11:06:26.502330 140042139842112 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 11:06:26.502989 140042139842112 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 11:06:26.563909 140042139842112 deleter.py:273] Deleted step 19350.
I0121 11:06:26.566160 140042139842112 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=20250] CheckpointManager Save Finalize is syncing with other hosts...
I0121 11:06:26.566912 140042139842112 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=20250] CheckpointManager Save Finalize is done on all hosts.
step: 20700,  loss data: 1.688e-03, loss res: 1.007e-02, time: 1.751e+02
step: 21150,  loss data: 1.294e-03, loss res: 1.149e-02, time: 1.739e+02
I0121 11:12:13.708654 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 11:12:13.710932 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 21150
I0121 11:12:13.712315 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/21150.
I0121 11:12:13.732207 140042173412928 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/21150.orbax-checkpoint-tmp
I0121 11:12:13.833680 140039983965760 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/21150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 11:12:13.875653 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 11:12:13.876417 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 11:12:14.442763 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.570464s
I0121 11:12:14.446751 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 118.297 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 723 milliseconds) (per-host)
I0121 11:12:14.452462 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.728837s (batch_requests_ready=0.094789s, total_serialization_initiated=0.625996s, others=0.008052s)
I0121 11:12:14.463970 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.748481s (all_items=0.000036s, per_item={'default': '0.00003624'}, temp_paths=0.748444)
I0121 11:12:14.550961 140042131449408 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 11:12:14.551194 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.839766s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/21150.
I0121 11:12:14.556974 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=21150] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 11:12:14.558238 140041879799360 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 11:12:14.562582 140165176223552 standard_logger.py:34] {'step': Array(21150, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768965133.708545, 'wait_for_prev_duration_secs': 0.0005750656127929688, 'time_between_consecutive_saves_sec': 347.141197681427, 'checkpointer_blocking_start_time': 1768965133.7113698, 'checkpointer_blocking_duration_secs': 0.8451423645019531, 'get_old_steps_start_time': 1768965134.5565991, 'get_old_steps_duration_secs': 0.00021529197692871094, 'checkpoint_manager_blocking_start_time': 1768965133.7075465, 'checkpoint_manager_blocking_duration_secs': 0.8536741733551025}
I0121 11:12:14.571776 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/21150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 11:12:16.417242 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.959319s (commit=1.763392s, array_metadata_write=0.195928s)
I0121 11:12:16.421555 140042131449408 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 31.702 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 11:12:16.421871 140042131449408 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.870205s.
I0121 11:12:16.438257 140042131449408 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 11:12:16.579036 140042131449408 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.154401s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/21150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 11:12:16.584204 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/21150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/21150.orbax-checkpoint-tmp/default
I0121 11:12:16.594316 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/21150.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/21150
I0121 11:12:16.607861 140042131449408 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/21150`.
I0121 11:12:16.609001 140042131449408 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.897601s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/21150
I0121 11:12:16.609319 140042131449408 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 2.057650s.
I0121 11:12:16.609820 140041879799360 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 11:12:16.610556 140041879799360 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 11:12:16.640228 140041879799360 deleter.py:273] Deleted step 20250.
I0121 11:12:16.640823 140041879799360 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=21150] CheckpointManager Save Finalize is syncing with other hosts...
I0121 11:12:16.641520 140041879799360 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=21150] CheckpointManager Save Finalize is done on all hosts.
step: 21600,  loss data: 3.187e-03, loss res: 6.876e-03, time: 1.742e+02
step: 22050,  loss data: 1.650e-03, loss res: 5.364e-03, time: 1.744e+02
I0121 11:18:03.117801 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 11:18:03.120719 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 22050
I0121 11:18:03.122856 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22050.
I0121 11:18:03.149493 140040546014784 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22050.orbax-checkpoint-tmp
I0121 11:18:03.258211 140040529229376 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 11:18:03.290696 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 11:18:03.291546 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 11:18:04.551148 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 1.264226s
I0121 11:18:04.590580 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 58.801 MiB/s (total gbytes: 85.5 MiB) (time elapsed: a second) (per-host)
I0121 11:18:04.648722 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 1.512816s (batch_requests_ready=0.096019s, total_serialization_initiated=1.320593s, others=0.096204s)
I0121 11:18:04.650542 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 1.523307s (all_items=0.000095s, per_item={'default': '0.00009513'}, temp_paths=1.523211)
I0121 11:18:04.657174 140041879799360 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 11:18:04.658386 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 1.537093s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22050.
I0121 11:18:04.659860 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=22050] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 11:18:04.664847 140042257290816 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 11:18:04.666940 140165176223552 standard_logger.py:34] {'step': Array(22050, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768965483.1175835, 'wait_for_prev_duration_secs': 0.0009200572967529297, 'time_between_consecutive_saves_sec': 346.47558188438416, 'checkpointer_blocking_start_time': 1768965483.1212137, 'checkpointer_blocking_duration_secs': 1.538172721862793, 'get_old_steps_start_time': 1768965484.6594799, 'get_old_steps_duration_secs': 0.00023651123046875, 'checkpoint_manager_blocking_start_time': 1768965483.1159928, 'checkpoint_manager_blocking_duration_secs': 1.5497424602508545}
I0121 11:18:05.525022 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 11:18:11.236442 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 6.646393s (commit=6.277025s, array_metadata_write=0.369368s)
I0121 11:18:11.240266 140041879799360 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 10.554 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 8 seconds) (per-host)
I0121 11:18:11.240787 140041879799360 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 6.582556s.
I0121 11:18:11.253828 140041879799360 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 11:18:11.670170 140041879799360 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.426067s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 11:18:11.672879 140041879799360 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22050.orbax-checkpoint-tmp/default
I0121 11:18:11.684173 140041879799360 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22050.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22050
I0121 11:18:11.726790 140041879799360 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22050`.
I0121 11:18:11.728402 140041879799360 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 8.607120s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22050
I0121 11:18:11.728904 140041879799360 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 7.070667s.
I0121 11:18:11.729862 140042257290816 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 11:18:11.730367 140042257290816 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 11:18:11.781770 140042257290816 deleter.py:273] Deleted step 21150.
I0121 11:18:11.782356 140042257290816 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=22050] CheckpointManager Save Finalize is syncing with other hosts...
I0121 11:18:11.782748 140042257290816 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=22050] CheckpointManager Save Finalize is done on all hosts.
step: 22500,  loss data: 1.741e-03, loss res: 4.053e-03, time: 1.745e+02
Epoch 50, getting batches from DataLoader...
step: 22950,  loss data: 2.382e-03, loss res: 4.110e-03, time: 1.747e+02
I0121 11:23:53.967485 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 11:23:53.969773 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 22950
I0121 11:23:53.971200 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22950.
I0121 11:23:53.981616 140039036048960 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22950.orbax-checkpoint-tmp
I0121 11:23:54.106058 140039086405184 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 11:23:54.137212 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 11:23:54.137897 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 11:23:54.721573 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.586967s
I0121 11:23:54.744746 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 112.345 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 761 milliseconds) (per-host)
I0121 11:23:54.756174 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.772869s (batch_requests_ready=0.097065s, total_serialization_initiated=0.642475s, others=0.033329s)
I0121 11:23:54.768007 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.792961s (all_items=0.000037s, per_item={'default': '0.00003695'}, temp_paths=0.792924)
I0121 11:23:54.823433 140042156627520 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 11:23:54.824083 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.853801s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22950.
I0121 11:23:54.826246 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=22950] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 11:23:54.827448 140042148234816 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 11:23:54.832849 140165176223552 standard_logger.py:34] {'step': Array(22950, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768965833.967384, 'wait_for_prev_duration_secs': 0.0005738735198974609, 'time_between_consecutive_saves_sec': 342.1844229698181, 'checkpointer_blocking_start_time': 1768965833.9702222, 'checkpointer_blocking_duration_secs': 0.8555557727813721, 'get_old_steps_start_time': 1768965834.8258595, 'get_old_steps_duration_secs': 0.00022602081298828125, 'checkpoint_manager_blocking_start_time': 1768965833.9663393, 'checkpoint_manager_blocking_duration_secs': 0.8624775409698486}
I0121 11:23:54.969864 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 11:24:03.827239 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 9.076705s (commit=8.363047s, array_metadata_write=0.713658s)
I0121 11:24:03.830621 140042156627520 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 8.686 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 9 seconds) (per-host)
I0121 11:24:03.831075 140042156627520 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 9.006678s.
I0121 11:24:03.843588 140042156627520 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 11:24:04.730067 140042156627520 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.895989s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 11:24:04.732224 140042156627520 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22950.orbax-checkpoint-tmp/default
I0121 11:24:04.737410 140042156627520 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22950.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22950
I0121 11:24:05.703317 140042156627520 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22950`.
I0121 11:24:05.705660 140042156627520 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 11.735391s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22950
I0121 11:24:05.706236 140042156627520 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 10.881829s.
I0121 11:24:05.706985 140042148234816 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 11:24:05.708023 140042148234816 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 11:24:05.747802 140042148234816 deleter.py:273] Deleted step 22050.
I0121 11:24:05.748443 140042148234816 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=22950] CheckpointManager Save Finalize is syncing with other hosts...
I0121 11:24:05.749119 140042148234816 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=22950] CheckpointManager Save Finalize is done on all hosts.
step: 23400,  loss data: 2.347e-03, loss res: 3.072e-03, time: 1.748e+02
step: 23850,  loss data: 2.493e-03, loss res: 5.595e-03, time: 1.735e+02
I0121 11:29:43.109522 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 11:29:43.111462 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 23850
I0121 11:29:43.112816 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/23850.
I0121 11:29:43.143863 140039078012480 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/23850.orbax-checkpoint-tmp
I0121 11:29:43.233972 140042131449408 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/23850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 11:29:43.277471 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 11:29:43.278536 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 11:29:43.842790 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.567891s
I0121 11:29:43.851219 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 117.664 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 726 milliseconds) (per-host)
I0121 11:29:43.862044 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.737825s (batch_requests_ready=0.094352s, total_serialization_initiated=0.625348s, others=0.018125s)
I0121 11:29:43.883290 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.766768s (all_items=0.000036s, per_item={'default': '0.00003648'}, temp_paths=0.766731)
I0121 11:29:43.946923 140042173412928 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 11:29:43.947231 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.835261s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/23850.
I0121 11:29:43.950036 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=23850] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 11:29:43.957101 140165176223552 standard_logger.py:34] {'step': Array(23850, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768966183.109407, 'wait_for_prev_duration_secs': 0.0005934238433837891, 'time_between_consecutive_saves_sec': 337.35977959632874, 'checkpointer_blocking_start_time': 1768966183.1119115, 'checkpointer_blocking_duration_secs': 0.8377265930175781, 'get_old_steps_start_time': 1768966183.9496996, 'get_old_steps_duration_secs': 0.00018286705017089844, 'checkpoint_manager_blocking_start_time': 1768966183.1085012, 'checkpoint_manager_blocking_duration_secs': 0.8474411964416504}
I0121 11:29:43.968048 140042257290816 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 11:29:44.106894 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/23850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 11:29:55.949944 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 12.099543s (commit=10.748311s, array_metadata_write=1.351232s)
I0121 11:29:55.956411 140042173412928 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 6.665 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 12 seconds) (per-host)
I0121 11:29:55.956932 140042173412928 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 12.009180s.
I0121 11:29:55.999883 140042173412928 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 11:29:56.501136 140042173412928 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.525868s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/23850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 11:29:56.505880 140042173412928 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/23850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/23850.orbax-checkpoint-tmp/default
I0121 11:29:56.513119 140042173412928 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/23850.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/23850
I0121 11:29:57.345049 140042173412928 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/23850`.
I0121 11:29:57.347383 140042173412928 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 14.235415s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/23850
I0121 11:29:57.348161 140042173412928 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 13.400379s.
I0121 11:29:57.350172 140042257290816 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 11:29:57.351686 140042257290816 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 11:29:57.449294 140042257290816 deleter.py:273] Deleted step 22950.
I0121 11:29:57.449723 140042257290816 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=23850] CheckpointManager Save Finalize is syncing with other hosts...
I0121 11:29:57.450261 140042257290816 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=23850] CheckpointManager Save Finalize is done on all hosts.
step: 24300,  loss data: 1.462e-03, loss res: 1.234e-02, time: 1.732e+02
step: 24750,  loss data: 2.047e-03, loss res: 4.865e-03, time: 1.731e+02
I0121 11:35:30.286230 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 11:35:30.289393 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 24750
I0121 11:35:30.291479 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/24750.
I0121 11:35:30.323074 140040000751168 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/24750.orbax-checkpoint-tmp
I0121 11:35:30.415703 140045084255808 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/24750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 11:35:30.457680 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 11:35:30.458462 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 11:35:30.981603 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.526954s
I0121 11:35:30.999330 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 123.144 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 694 milliseconds) (per-host)
I0121 11:35:31.011362 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.706791s (batch_requests_ready=0.095807s, total_serialization_initiated=0.592763s, others=0.018221s)
I0121 11:35:31.017616 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.722123s (all_items=0.000086s, per_item={'default': '0.00008607'}, temp_paths=0.722037)
I0121 11:35:31.084552 140042173412928 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 11:35:31.084815 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.794846s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/24750.
I0121 11:35:31.086665 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=24750] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 11:35:31.091492 140165176223552 standard_logger.py:34] {'step': Array(24750, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768966530.2860022, 'wait_for_prev_duration_secs': 0.0009570121765136719, 'time_between_consecutive_saves_sec': 332.8355026245117, 'checkpointer_blocking_start_time': 1768966530.289906, 'checkpointer_blocking_duration_secs': 0.7965042591094971, 'get_old_steps_start_time': 1768966531.0864575, 'get_old_steps_duration_secs': 0.0001347064971923828, 'checkpoint_manager_blocking_start_time': 1768966530.2843657, 'checkpoint_manager_blocking_duration_secs': 0.8036642074584961}
I0121 11:35:32.002040 140042139842112 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 11:35:32.010692 140042274076224 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/24750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 11:35:44.489691 140042265683520 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 13.489488s (commit=12.596118s, array_metadata_write=0.893370s)
I0121 11:35:44.493446 140042173412928 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 6.028 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 14 seconds) (per-host)
I0121 11:35:44.493884 140042173412928 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 13.408586s.
I0121 11:35:44.514694 140042173412928 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 11:35:44.842292 140042173412928 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.340753s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/24750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 11:35:44.844713 140042173412928 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/24750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/24750.orbax-checkpoint-tmp/default
I0121 11:35:44.850131 140042173412928 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/24750.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/24750
I0121 11:35:45.430271 140042173412928 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/24750`.
I0121 11:35:45.432600 140042173412928 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 15.142622s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/24750
I0121 11:35:45.433151 140042173412928 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 14.347847s.
I0121 11:35:45.435527 140042139842112 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 11:35:45.436105 140042139842112 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 11:35:45.492834 140042139842112 deleter.py:273] Deleted step 23850.
I0121 11:35:45.493245 140042139842112 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=24750] CheckpointManager Save Finalize is syncing with other hosts...
I0121 11:35:45.493592 140042139842112 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=24750] CheckpointManager Save Finalize is done on all hosts.
step: 25200,  loss data: 1.538e-03, loss res: 5.257e-03, time: 1.720e+02
step: 25650,  loss data: 2.157e-03, loss res: 1.062e-02, time: 1.725e+02
I0121 11:41:15.543091 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 11:41:15.545309 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 25650
I0121 11:41:15.546735 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/25650.
I0121 11:41:15.583378 140043767756352 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/25650.orbax-checkpoint-tmp
I0121 11:41:15.707930 140039086405184 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/25650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 11:41:15.715203 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 11:41:15.716059 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 11:41:16.299949 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.587670s
I0121 11:41:16.327384 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 111.421 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 767 milliseconds) (per-host)
I0121 11:41:16.339104 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.779461s (batch_requests_ready=0.100412s, total_serialization_initiated=0.651334s, others=0.027714s)
I0121 11:41:16.396515 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.845941s (all_items=0.000035s, per_item={'default': '0.00003481'}, temp_paths=0.845906)
I0121 11:41:16.405847 140041879799360 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 11:41:16.406135 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.860319s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/25650.
I0121 11:41:16.409614 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=25650] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 11:41:16.412640 140041871406656 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 11:41:16.414901 140165176223552 standard_logger.py:34] {'step': Array(25650, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768966875.542986, 'wait_for_prev_duration_secs': 0.0005962848663330078, 'time_between_consecutive_saves_sec': 330.0491871833801, 'checkpointer_blocking_start_time': 1768966875.5457566, 'checkpointer_blocking_duration_secs': 0.8634397983551025, 'get_old_steps_start_time': 1768966876.4092658, 'get_old_steps_duration_secs': 0.0002033710479736328, 'checkpoint_manager_blocking_start_time': 1768966875.5418773, 'checkpoint_manager_blocking_duration_secs': 0.8717231750488281}
I0121 11:41:16.419707 140042274076224 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/25650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 11:41:25.805557 140042265683520 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 9.472543s (commit=9.324907s, array_metadata_write=0.147636s)
I0121 11:41:25.809568 140041879799360 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 8.344 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 10 seconds) (per-host)
I0121 11:41:25.809986 140041879799360 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 9.402109s.
I0121 11:41:25.822211 140041879799360 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 11:41:26.833208 140041879799360 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 1.019911s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/25650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 11:41:26.835946 140041879799360 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/25650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/25650.orbax-checkpoint-tmp/default
I0121 11:41:26.841800 140041879799360 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/25650.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/25650
I0121 11:41:26.902190 140041879799360 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/25650`.
I0121 11:41:26.903831 140041879799360 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 11.358032s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/25650
I0121 11:41:26.904338 140041879799360 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 10.496454s.
I0121 11:41:26.905333 140041871406656 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 11:41:26.905831 140041871406656 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 11:41:26.959294 140041871406656 deleter.py:273] Deleted step 24750.
I0121 11:41:26.959674 140041871406656 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=25650] CheckpointManager Save Finalize is syncing with other hosts...
I0121 11:41:26.960001 140041871406656 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=25650] CheckpointManager Save Finalize is done on all hosts.
step: 26100,  loss data: 2.590e-03, loss res: 5.229e-03, time: 1.715e+02
step: 26550,  loss data: 2.038e-03, loss res: 7.103e-03, time: 1.714e+02
I0121 11:46:59.274662 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 11:46:59.277521 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 26550
I0121 11:46:59.279674 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/26550.
I0121 11:46:59.307249 140039069619776 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/26550.orbax-checkpoint-tmp
I0121 11:46:59.416931 140040546014784 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/26550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 11:46:59.456190 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 11:46:59.457670 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 11:47:00.045506 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.592278s
I0121 11:47:00.638267 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 63.597 MiB/s (total gbytes: 85.5 MiB) (time elapsed: a second) (per-host)
I0121 11:47:00.656276 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 1.363007s (batch_requests_ready=0.103209s, total_serialization_initiated=1.235302s, others=0.024497s)
I0121 11:47:00.662214 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 1.378315s (all_items=0.000076s, per_item={'default': '0.00007558'}, temp_paths=1.378239)
I0121 11:47:00.715261 140042173412928 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 11:47:00.716267 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 1.438169s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/26550.
I0121 11:47:00.721926 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=26550] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 11:47:00.723862 140042131449408 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 11:47:00.726380 140165176223552 standard_logger.py:34] {'step': Array(26550, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768967219.2744102, 'wait_for_prev_duration_secs': 0.0009715557098388672, 'time_between_consecutive_saves_sec': 332.3141915798187, 'checkpointer_blocking_start_time': 1768967219.2780142, 'checkpointer_blocking_duration_secs': 1.4434833526611328, 'get_old_steps_start_time': 1768967220.7215796, 'get_old_steps_duration_secs': 0.00019621849060058594, 'checkpoint_manager_blocking_start_time': 1768967219.2726507, 'checkpoint_manager_blocking_duration_secs': 1.4526066780090332}
I0121 11:47:00.739466 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/26550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 11:47:02.246768 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.591370s (commit=1.414872s, array_metadata_write=0.176498s)
I0121 11:47:02.251247 140042173412928 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 28.916 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 11:47:02.251756 140042173412928 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.535249s.
I0121 11:47:02.267844 140042173412928 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 11:47:02.341047 140042173412928 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.085821s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/26550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 11:47:02.343289 140042173412928 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/26550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/26550.orbax-checkpoint-tmp/default
I0121 11:47:02.347015 140042173412928 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/26550.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/26550
I0121 11:47:02.359604 140042173412928 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/26550`.
I0121 11:47:02.361092 140042173412928 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 3.083014s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/26550
I0121 11:47:02.361608 140042173412928 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.645096s.
I0121 11:47:02.362604 140042131449408 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 11:47:02.363085 140042131449408 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 11:47:02.404564 140042131449408 deleter.py:273] Deleted step 25650.
I0121 11:47:02.405122 140042131449408 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=26550] CheckpointManager Save Finalize is syncing with other hosts...
I0121 11:47:02.405860 140042131449408 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=26550] CheckpointManager Save Finalize is done on all hosts.
step: 27000,  loss data: 1.240e-03, loss res: 1.629e-03, time: 1.732e+02
Epoch 60, getting batches from DataLoader...
step: 27450,  loss data: 3.390e-03, loss res: 8.010e-03, time: 1.737e+02
I0121 11:52:47.625924 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 11:52:47.628036 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 27450
I0121 11:52:47.629471 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/27450.
I0121 11:52:47.650485 140039069619776 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/27450.orbax-checkpoint-tmp
I0121 11:52:47.771084 140040000751168 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/27450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 11:52:47.795487 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 11:52:47.796128 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 11:52:48.375379 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.582390s
I0121 11:52:48.397804 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 113.023 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 756 milliseconds) (per-host)
I0121 11:52:48.409263 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.768313s (batch_requests_ready=0.099387s, total_serialization_initiated=0.640916s, others=0.028010s)
I0121 11:52:48.450311 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.817062s (all_items=0.000034s, per_item={'default': '0.00003409'}, temp_paths=0.817028)
I0121 11:52:48.471453 140042131449408 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 11:52:48.472029 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.843492s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/27450.
I0121 11:52:48.474625 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=27450] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 11:52:48.478777 140042257290816 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 11:52:48.481100 140165176223552 standard_logger.py:34] {'step': Array(27450, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768967567.6258118, 'wait_for_prev_duration_secs': 0.0006134510040283203, 'time_between_consecutive_saves_sec': 345.219398021698, 'checkpointer_blocking_start_time': 1768967567.62848, 'checkpointer_blocking_duration_secs': 0.8457202911376953, 'get_old_steps_start_time': 1768967568.4742672, 'get_old_steps_duration_secs': 0.00021719932556152344, 'checkpoint_manager_blocking_start_time': 1768967567.6249244, 'checkpoint_manager_blocking_duration_secs': 0.8551938533782959}
I0121 11:52:48.574947 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/27450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 11:52:51.439046 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 3.035418s (commit=2.342220s, array_metadata_write=0.693197s)
I0121 11:52:51.442421 140042131449408 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 22.500 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 3 seconds) (per-host)
I0121 11:52:51.442899 140042131449408 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 2.969929s.
I0121 11:52:51.455817 140042131449408 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 11:52:51.576762 140042131449408 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.130353s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/27450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 11:52:51.579101 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/27450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/27450.orbax-checkpoint-tmp/default
I0121 11:52:51.584367 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/27450.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/27450
I0121 11:52:51.601231 140042131449408 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/27450`.
I0121 11:52:51.603092 140042131449408 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 3.974568s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/27450
I0121 11:52:51.603604 140042131449408 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 3.130619s.
I0121 11:52:51.604604 140042257290816 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 11:52:51.605044 140042257290816 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 11:52:51.655849 140042257290816 deleter.py:273] Deleted step 26550.
I0121 11:52:51.656410 140042257290816 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=27450] CheckpointManager Save Finalize is syncing with other hosts...
I0121 11:52:51.657030 140042257290816 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=27450] CheckpointManager Save Finalize is done on all hosts.
step: 27900,  loss data: 1.634e-03, loss res: 3.218e-03, time: 1.720e+02
step: 28350,  loss data: 9.361e-04, loss res: 2.037e-03, time: 1.726e+02
I0121 11:58:33.121120 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 11:58:33.123603 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 28350
I0121 11:58:33.125318 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/28350.
I0121 11:58:33.161640 140043767756352 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/28350.orbax-checkpoint-tmp
I0121 11:58:33.240705 140038549534272 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/28350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 11:58:33.301753 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 11:58:33.302670 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 11:58:33.894235 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.595077s
I0121 11:58:33.933032 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 107.508 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 795 milliseconds) (per-host)
I0121 11:58:33.997247 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.859869s (batch_requests_ready=0.104125s, total_serialization_initiated=0.653723s, others=0.102021s)
I0121 11:58:33.999186 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.870154s (all_items=0.000051s, per_item={'default': '0.00005054'}, temp_paths=0.870103)
I0121 11:58:34.008416 140041879799360 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 11:58:34.009389 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.885222s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/28350.
I0121 11:58:34.011977 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=28350] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 11:58:34.014131 140042173412928 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 11:58:34.017219 140165176223552 standard_logger.py:34] {'step': Array(28350, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768967913.1209273, 'wait_for_prev_duration_secs': 0.00080108642578125, 'time_between_consecutive_saves_sec': 341.46346831321716, 'checkpointer_blocking_start_time': 1768967913.1241038, 'checkpointer_blocking_duration_secs': 0.8874125480651855, 'get_old_steps_start_time': 1768967914.0116036, 'get_old_steps_duration_secs': 0.00021719932556152344, 'checkpoint_manager_blocking_start_time': 1768967913.1197662, 'checkpoint_manager_blocking_duration_secs': 0.8959918022155762}
I0121 11:58:36.112898 140042274076224 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/28350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 11:58:41.818413 140042265683520 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 7.820691s (commit=7.700750s, array_metadata_write=0.119941s)
I0121 11:58:41.821779 140041879799360 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 9.849 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 8 seconds) (per-host)
I0121 11:58:41.822258 140041879799360 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 7.812967s.
I0121 11:58:41.842172 140041879799360 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 11:58:42.920722 140041879799360 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 1.095050s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/28350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 11:58:42.923472 140041879799360 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/28350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/28350.orbax-checkpoint-tmp/default
I0121 11:58:42.931304 140041879799360 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/28350.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/28350
I0121 11:58:43.611533 140041879799360 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/28350`.
I0121 11:58:43.613693 140041879799360 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 10.489539s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/28350
I0121 11:58:43.614233 140041879799360 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 9.604934s.
I0121 11:58:43.614931 140042173412928 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 11:58:43.615637 140042173412928 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 11:58:43.666023 140042173412928 deleter.py:273] Deleted step 27450.
I0121 11:58:43.666479 140042173412928 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=28350] CheckpointManager Save Finalize is syncing with other hosts...
I0121 11:58:43.667031 140042173412928 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=28350] CheckpointManager Save Finalize is done on all hosts.
step: 28800,  loss data: 1.962e-03, loss res: 4.002e-03, time: 1.737e+02
step: 29250,  loss data: 1.703e-03, loss res: 1.919e-03, time: 1.731e+02
I0121 12:04:20.797503 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 12:04:20.799469 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 29250
I0121 12:04:20.800717 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/29250.
I0121 12:04:20.822441 140039983965760 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/29250.orbax-checkpoint-tmp
I0121 12:04:20.934266 140039052834368 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/29250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 12:04:20.970461 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 12:04:20.971914 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 12:04:21.560221 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.592408s
I0121 12:04:21.568433 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 113.355 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 754 milliseconds) (per-host)
I0121 12:04:21.574285 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.760504s (batch_requests_ready=0.099863s, total_serialization_initiated=0.647750s, others=0.012890s)
I0121 12:04:21.575569 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.770642s (all_items=0.000035s, per_item={'default': '0.00003505'}, temp_paths=0.770607)
I0121 12:04:21.609958 140042173412928 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 12:04:21.615549 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.815628s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/29250.
I0121 12:04:21.665922 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=29250] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 12:04:21.667575 140042148234816 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 12:04:21.670048 140165176223552 standard_logger.py:34] {'step': Array(29250, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768968260.7974026, 'wait_for_prev_duration_secs': 0.0005497932434082031, 'time_between_consecutive_saves_sec': 337.1301112174988, 'checkpointer_blocking_start_time': 1768968260.7998717, 'checkpointer_blocking_duration_secs': 0.865614652633667, 'get_old_steps_start_time': 1768968261.6655576, 'get_old_steps_duration_secs': 0.0002224445343017578, 'checkpoint_manager_blocking_start_time': 1768968260.7964835, 'checkpoint_manager_blocking_duration_secs': 0.8724532127380371}
I0121 12:04:22.244044 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/29250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 12:04:32.921466 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 11.358656s (commit=11.185540s, array_metadata_write=0.173116s)
I0121 12:04:32.924573 140042173412928 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 7.062 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 12 seconds) (per-host)
I0121 12:04:32.925088 140042173412928 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 11.309632s.
I0121 12:04:32.946984 140042173412928 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 12:04:33.361818 140042173412928 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.432641s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/29250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 12:04:33.364364 140042173412928 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/29250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/29250.orbax-checkpoint-tmp/default
I0121 12:04:33.372378 140042173412928 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/29250.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/29250
I0121 12:04:34.586348 140042173412928 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/29250`.
I0121 12:04:34.589713 140042173412928 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 13.789798s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/29250
I0121 12:04:34.590396 140042173412928 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 12.974932s.
I0121 12:04:34.591073 140042148234816 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 12:04:34.592483 140042148234816 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 12:04:34.649896 140042148234816 deleter.py:273] Deleted step 28350.
I0121 12:04:34.650369 140042148234816 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=29250] CheckpointManager Save Finalize is syncing with other hosts...
I0121 12:04:34.650785 140042148234816 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=29250] CheckpointManager Save Finalize is done on all hosts.
step: 29700,  loss data: 2.209e-03, loss res: 7.170e-03, time: 1.733e+02
step: 30150,  loss data: 9.461e-04, loss res: 2.817e-03, time: 1.733e+02
I0121 12:10:08.230526 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 12:10:08.232540 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 30150
I0121 12:10:08.233979 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/30150.
I0121 12:10:08.264097 140040009143872 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/30150.orbax-checkpoint-tmp
I0121 12:10:08.365851 140040554407488 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/30150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 12:10:08.404055 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 12:10:08.404705 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 12:10:08.984922 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.583366s
I0121 12:10:08.987758 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 115.918 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 737 milliseconds) (per-host)
I0121 12:10:09.004274 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.754467s (batch_requests_ready=0.095564s, total_serialization_initiated=0.641346s, others=0.017557s)
I0121 12:10:09.005068 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.763301s (all_items=0.000035s, per_item={'default': '0.00003529'}, temp_paths=0.763266)
I0121 12:10:09.039549 140042173412928 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 12:10:09.084869 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.851816s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/30150.
I0121 12:10:09.097035 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=30150] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 12:10:09.100696 140165176223552 standard_logger.py:34] {'step': Array(30150, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768968608.2304242, 'wait_for_prev_duration_secs': 0.0005929470062255859, 'time_between_consecutive_saves_sec': 333.5792398452759, 'checkpointer_blocking_start_time': 1768968608.2329679, 'checkpointer_blocking_duration_secs': 0.8636343479156494, 'get_old_steps_start_time': 1768968609.0966754, 'get_old_steps_duration_secs': 0.0001976490020751953, 'checkpoint_manager_blocking_start_time': 1768968608.229436, 'checkpoint_manager_blocking_duration_secs': 0.8704960346221924}
I0121 12:10:10.047995 140042139842112 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 12:10:10.058123 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/30150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 12:10:28.489255 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 19.478166s (commit=19.015500s, array_metadata_write=0.462666s)
I0121 12:10:28.493576 140042173412928 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 4.225 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 20 seconds) (per-host)
I0121 12:10:28.494216 140042173412928 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 19.399125s.
I0121 12:10:28.526066 140042173412928 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 12:10:29.001538 140042173412928 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.490121s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/30150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 12:10:29.003924 140042173412928 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/30150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/30150.orbax-checkpoint-tmp/default
I0121 12:10:29.016089 140042173412928 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/30150.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/30150
I0121 12:10:29.391333 140045092648512 checkpoint.py:188] Wrote Metadata={'item_handlers': {'default': 'orbax.checkpoint._src.handlers.standard_checkpoint_handler.StandardCheckpointHandler'}, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1768968608321040182, 'commit_timestamp_nsecs': None, 'custom_metadata': {}}, json={"item_handlers": {"default": "orbax.checkpoint._src.handlers.standard_checkpoint_handler.StandardCheckpointHandler"}, "metrics": {}, "performance_metrics": {}, "init_timestamp_nsecs": 1768968608321040182, "commit_timestamp_nsecs": null, "custom_metadata": {}} to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/30150.orbax-checkpoint-tmp/_CHECKPOINT_METADATA
I0121 12:10:29.441209 140042173412928 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/30150`.
I0121 12:10:29.443053 140042173412928 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 21.210039s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/30150
I0121 12:10:29.443589 140042173412928 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 20.348503s.
I0121 12:10:29.444265 140042139842112 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 12:10:29.445014 140042139842112 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 12:10:29.608703 140042139842112 deleter.py:273] Deleted step 29250.
I0121 12:10:29.609169 140042139842112 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=30150] CheckpointManager Save Finalize is syncing with other hosts...
I0121 12:10:29.609710 140042139842112 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=30150] CheckpointManager Save Finalize is done on all hosts.
step: 30600,  loss data: 1.924e-03, loss res: 3.778e-03, time: 1.733e+02
step: 31050,  loss data: 1.349e-03, loss res: 8.165e-04, time: 1.732e+02
I0121 12:15:55.697299 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 12:15:55.700002 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 31050
I0121 12:15:55.701947 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/31050.
I0121 12:15:55.744400 140040520836672 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/31050.orbax-checkpoint-tmp
I0121 12:15:55.840561 140038499178048 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/31050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 12:15:55.869750 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 12:15:55.871291 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 12:15:56.420026 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.552989s
I0121 12:15:56.444532 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 117.602 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 727 milliseconds) (per-host)
I0121 12:15:56.456637 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.740037s (batch_requests_ready=0.097584s, total_serialization_initiated=0.623611s, others=0.018842s)
I0121 12:15:56.490777 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.784464s (all_items=0.000096s, per_item={'default': '0.00009584'}, temp_paths=0.784369)
I0121 12:15:56.531856 140042148234816 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 12:15:56.532167 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.831635s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/31050.
I0121 12:15:56.539815 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=31050] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 12:15:56.543186 140165176223552 standard_logger.py:34] {'step': Array(31050, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768968955.6970818, 'wait_for_prev_duration_secs': 0.0009300708770751953, 'time_between_consecutive_saves_sec': 326.087110042572, 'checkpointer_blocking_start_time': 1768968955.700453, 'checkpointer_blocking_duration_secs': 0.8388645648956299, 'get_old_steps_start_time': 1768968956.539386, 'get_old_steps_duration_secs': 0.0002765655517578125, 'checkpoint_manager_blocking_start_time': 1768968955.695541, 'checkpoint_manager_blocking_duration_secs': 0.8465399742126465}
I0121 12:15:57.062146 140042274076224 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/31050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 12:15:57.644319 140042257290816 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 12:16:08.530896 140042265683520 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 12.080067s (commit=11.818855s, array_metadata_write=0.261212s)
I0121 12:16:08.533988 140042148234816 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 6.673 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 12 seconds) (per-host)
I0121 12:16:08.534415 140042148234816 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 12.001416s.
I0121 12:16:08.547758 140042148234816 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 12:16:08.611495 140042148234816 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.073599s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/31050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 12:16:08.613583 140042148234816 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/31050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/31050.orbax-checkpoint-tmp/default
I0121 12:16:08.618182 140042148234816 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/31050.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/31050
I0121 12:16:08.837328 140042148234816 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/31050`.
I0121 12:16:08.839078 140042148234816 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 13.138559s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/31050
I0121 12:16:08.839572 140042148234816 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 12.306568s.
I0121 12:16:08.840395 140042257290816 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 12:16:08.841096 140042257290816 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 12:16:08.896569 140042257290816 deleter.py:273] Deleted step 30150.
I0121 12:16:08.897156 140042257290816 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=31050] CheckpointManager Save Finalize is syncing with other hosts...
I0121 12:16:08.897768 140042257290816 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=31050] CheckpointManager Save Finalize is done on all hosts.
step: 31500,  loss data: 1.012e-03, loss res: 1.411e-03, time: 1.723e+02
Epoch 70, getting batches from DataLoader...
step: 31950,  loss data: 7.422e-04, loss res: 1.347e-03, time: 1.725e+02
I0121 12:21:41.312758 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 12:21:41.315007 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 31950
I0121 12:21:41.316608 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/31950.
I0121 12:21:41.343424 140043767756352 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/31950.orbax-checkpoint-tmp
I0121 12:21:41.446825 140038515963456 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/31950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 12:21:41.482298 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 12:21:41.483826 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 12:21:42.087118 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.607443s
I0121 12:21:42.105380 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 110.012 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 777 milliseconds) (per-host)
I0121 12:21:42.111386 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.783589s (batch_requests_ready=0.098361s, total_serialization_initiated=0.672992s, others=0.012236s)
I0121 12:21:42.112461 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.791454s (all_items=0.000034s, per_item={'default': '0.00003433'}, temp_paths=0.791420)
I0121 12:21:42.141005 140042173412928 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 12:21:42.180083 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.864525s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/31950.
I0121 12:21:42.183129 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=31950] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 12:21:42.184480 140042156627520 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 12:21:42.186729 140165176223552 standard_logger.py:34] {'step': Array(31950, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768969301.3126316, 'wait_for_prev_duration_secs': 0.0006473064422607422, 'time_between_consecutive_saves_sec': 332.4143178462982, 'checkpointer_blocking_start_time': 1768969301.315517, 'checkpointer_blocking_duration_secs': 0.8673281669616699, 'get_old_steps_start_time': 1768969302.182899, 'get_old_steps_duration_secs': 0.00013375282287597656, 'checkpoint_manager_blocking_start_time': 1768969301.3116548, 'checkpoint_manager_blocking_duration_secs': 0.8739285469055176}
I0121 12:21:45.322184 140042274076224 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/31950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 12:21:53.043229 140042265683520 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 10.930422s (commit=10.214497s, array_metadata_write=0.715925s)
I0121 12:21:53.050892 140042173412928 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 7.296 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 11 seconds) (per-host)
I0121 12:21:53.051561 140042173412928 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 10.870480s.
I0121 12:21:53.071616 140042173412928 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 12:21:53.958821 140042173412928 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.902317s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/31950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 12:21:53.961479 140042173412928 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/31950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/31950.orbax-checkpoint-tmp/default
I0121 12:21:53.966402 140042173412928 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/31950.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/31950
I0121 12:21:54.409711 140042173412928 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/31950`.
I0121 12:21:54.411669 140042173412928 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 13.096105s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/31950
I0121 12:21:54.412206 140042173412928 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 12.231129s.
I0121 12:21:54.412923 140042156627520 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 12:21:54.413462 140042156627520 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 12:21:54.468872 140042156627520 deleter.py:273] Deleted step 31050.
I0121 12:21:54.469227 140042156627520 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=31950] CheckpointManager Save Finalize is syncing with other hosts...
I0121 12:21:54.469544 140042156627520 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=31950] CheckpointManager Save Finalize is done on all hosts.
step: 32400,  loss data: 1.674e-03, loss res: 5.982e-03, time: 1.711e+02
step: 32850,  loss data: 7.282e-04, loss res: 1.213e-03, time: 1.713e+02
I0121 12:27:24.550949 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 12:27:24.553253 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 32850
I0121 12:27:24.554867 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/32850.
I0121 12:27:24.581859 140038541141568 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/32850.orbax-checkpoint-tmp
I0121 12:27:24.704053 140039078012480 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/32850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 12:27:24.726816 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 12:27:24.727535 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 12:27:25.300639 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.576659s
I0121 12:27:25.339117 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 110.883 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 771 milliseconds) (per-host)
I0121 12:27:25.380346 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.812682s (batch_requests_ready=0.098731s, total_serialization_initiated=0.666414s, others=0.047537s)
I0121 12:27:25.400827 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.841551s (all_items=0.000050s, per_item={'default': '0.00004983'}, temp_paths=0.841501)
I0121 12:27:25.405685 140042156627520 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 12:27:25.406171 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.852401s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/32850.
I0121 12:27:25.408830 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=32850] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 12:27:25.412959 140042139842112 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 12:27:25.415388 140165176223552 standard_logger.py:34] {'step': Array(32850, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768969644.5507822, 'wait_for_prev_duration_secs': 0.0007534027099609375, 'time_between_consecutive_saves_sec': 330.08101773262024, 'checkpointer_blocking_start_time': 1768969644.553698, 'checkpointer_blocking_duration_secs': 0.8546721935272217, 'get_old_steps_start_time': 1768969645.4084556, 'get_old_steps_duration_secs': 0.0002231597900390625, 'checkpoint_manager_blocking_start_time': 1768969644.5496984, 'checkpoint_manager_blocking_duration_secs': 0.8644649982452393}
I0121 12:27:25.977698 140042274076224 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/32850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 12:27:30.893527 140042265683520 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 5.548299s (commit=4.716129s, array_metadata_write=0.832170s)
I0121 12:27:30.898272 140042156627520 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 13.511 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 6 seconds) (per-host)
I0121 12:27:30.898684 140042156627520 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 5.491642s.
I0121 12:27:30.918825 140042156627520 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 12:27:31.055557 140042156627520 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.149356s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/32850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 12:27:31.057980 140042156627520 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/32850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/32850.orbax-checkpoint-tmp/default
I0121 12:27:31.062870 140042156627520 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/32850.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/32850
I0121 12:27:39.787349 140042156627520 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/32850`.
I0121 12:27:39.789793 140042156627520 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 15.236042s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/32850
I0121 12:27:39.790361 140042156627520 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 14.383310s.
I0121 12:27:39.791090 140042139842112 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 12:27:39.791854 140042139842112 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 12:27:39.843556 140042139842112 deleter.py:273] Deleted step 31950.
I0121 12:27:39.844361 140042139842112 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=32850] CheckpointManager Save Finalize is syncing with other hosts...
I0121 12:27:39.845379 140042139842112 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=32850] CheckpointManager Save Finalize is done on all hosts.
step: 33300,  loss data: 2.518e-03, loss res: 3.180e-03, time: 1.733e+02
step: 33750,  loss data: 2.109e-03, loss res: 5.079e-03, time: 1.725e+02
I0121 12:33:11.159582 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 12:33:11.161958 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 33750
I0121 12:33:11.163573 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/33750.
I0121 12:33:11.190384 140040512443968 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/33750.orbax-checkpoint-tmp
I0121 12:33:11.293895 140042148234816 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/33750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 12:33:11.333323 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 12:33:11.334838 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 12:33:11.933870 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.603218s
I0121 12:33:11.947240 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 110.911 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 771 milliseconds) (per-host)
I0121 12:33:11.969350 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.793389s (batch_requests_ready=0.096926s, total_serialization_initiated=0.667530s, others=0.028933s)
I0121 12:33:12.032758 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.865151s (all_items=0.000037s, per_item={'default': '0.00003672'}, temp_paths=0.865114)
I0121 12:33:12.037828 140042131449408 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 12:33:12.038141 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.875582s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/33750.
I0121 12:33:12.042588 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=33750] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 12:33:12.043772 140042173412928 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 12:33:12.047336 140165176223552 standard_logger.py:34] {'step': Array(33750, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768969991.159463, 'wait_for_prev_duration_secs': 0.0006709098815917969, 'time_between_consecutive_saves_sec': 331.3133671283722, 'checkpointer_blocking_start_time': 1768969991.1624987, 'checkpointer_blocking_duration_secs': 0.8796632289886475, 'get_old_steps_start_time': 1768969992.042236, 'get_old_steps_duration_secs': 0.00021266937255859375, 'checkpoint_manager_blocking_start_time': 1768969991.1583953, 'checkpoint_manager_blocking_duration_secs': 0.8873915672302246}
I0121 12:33:12.123833 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/33750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 12:33:13.982226 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 2.029278s (commit=1.900281s, array_metadata_write=0.128997s)
I0121 12:33:13.985716 140042131449408 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 30.442 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 12:33:13.986224 140042131449408 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.947359s.
I0121 12:33:13.997348 140042131449408 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 12:33:14.064809 140042131449408 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.075589s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/33750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 12:33:14.066984 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/33750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/33750.orbax-checkpoint-tmp/default
I0121 12:33:14.071733 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/33750.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/33750
I0121 12:33:14.108865 140042131449408 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/33750`.
I0121 12:33:14.110535 140042131449408 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.947990s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/33750
I0121 12:33:14.111027 140042131449408 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 2.072155s.
I0121 12:33:14.111932 140042173412928 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 12:33:14.112359 140042173412928 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 12:33:14.164743 140042173412928 deleter.py:273] Deleted step 32850.
I0121 12:33:14.165113 140042173412928 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=33750] CheckpointManager Save Finalize is syncing with other hosts...
I0121 12:33:14.165436 140042173412928 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=33750] CheckpointManager Save Finalize is done on all hosts.
step: 34200,  loss data: 8.879e-04, loss res: 3.722e-03, time: 1.716e+02
step: 34650,  loss data: 1.711e-03, loss res: 4.979e-03, time: 1.714e+02
I0121 12:38:55.122477 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 12:38:55.125005 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 34650
I0121 12:38:55.126635 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/34650.
I0121 12:38:55.157845 140040546014784 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/34650.orbax-checkpoint-tmp
I0121 12:38:55.255430 140038532748864 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/34650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 12:38:55.292036 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 12:38:55.293438 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 12:38:55.868413 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.579057s
I0121 12:38:55.876108 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 115.943 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 737 milliseconds) (per-host)
I0121 12:38:55.887461 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.749146s (batch_requests_ready=0.096651s, total_serialization_initiated=0.634991s, others=0.017504s)
I0121 12:38:55.893828 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.763586s (all_items=0.000036s, per_item={'default': '0.00003624'}, temp_paths=0.763550)
I0121 12:38:55.971543 140042156627520 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 12:38:55.972339 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.846771s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/34650.
I0121 12:38:55.974778 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=34650] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 12:38:55.979760 140042148234816 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 12:38:55.981774 140165176223552 standard_logger.py:34] {'step': Array(34650, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768970335.1223533, 'wait_for_prev_duration_secs': 0.0006632804870605469, 'time_between_consecutive_saves_sec': 340.9567151069641, 'checkpointer_blocking_start_time': 1768970335.125513, 'checkpointer_blocking_duration_secs': 0.8488566875457764, 'get_old_steps_start_time': 1768970335.9744356, 'get_old_steps_duration_secs': 0.00019097328186035156, 'checkpoint_manager_blocking_start_time': 1768970335.121186, 'checkpoint_manager_blocking_duration_secs': 0.8595185279846191}
I0121 12:38:56.037424 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/34650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 12:39:01.161570 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 5.274491s (commit=5.120677s, array_metadata_write=0.153814s)
I0121 12:39:01.164926 140042156627520 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 14.192 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 6 seconds) (per-host)
I0121 12:39:01.165357 140042156627520 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 5.192599s.
I0121 12:39:01.186034 140042156627520 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 12:39:01.311156 140042156627520 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.139813s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/34650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 12:39:01.313426 140042156627520 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/34650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/34650.orbax-checkpoint-tmp/default
I0121 12:39:01.319052 140042156627520 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/34650.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/34650
I0121 12:39:02.074831 140042156627520 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/34650`.
I0121 12:39:02.076956 140042156627520 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 6.951396s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/34650
I0121 12:39:02.077484 140042156627520 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 6.104721s.
I0121 12:39:02.078353 140042148234816 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 12:39:02.078931 140042148234816 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 12:39:02.131303 140042148234816 deleter.py:273] Deleted step 33750.
I0121 12:39:02.131663 140042148234816 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=34650] CheckpointManager Save Finalize is syncing with other hosts...
I0121 12:39:02.131984 140042148234816 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=34650] CheckpointManager Save Finalize is done on all hosts.
step: 35100,  loss data: 1.882e-03, loss res: 1.896e-03, time: 1.736e+02
step: 35550,  loss data: 9.532e-04, loss res: 3.033e-03, time: 1.735e+02
I0121 12:44:43.080932 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 12:44:43.087130 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 35550
I0121 12:44:43.089871 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/35550.
I0121 12:44:43.133879 140040000751168 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/35550.orbax-checkpoint-tmp
I0121 12:44:43.245144 140039061227072 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/35550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 12:44:43.264647 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 12:44:43.265294 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 12:44:43.847746 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.586054s
I0121 12:44:43.871855 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 111.516 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 766 milliseconds) (per-host)
I0121 12:44:43.887969 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.783305s (batch_requests_ready=0.103202s, total_serialization_initiated=0.657186s, others=0.022917s)
I0121 12:44:43.943845 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.849084s (all_items=0.000094s, per_item={'default': '0.00009370'}, temp_paths=0.848990)
I0121 12:44:43.953581 140042139842112 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 12:44:43.955567 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.867301s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/35550.
I0121 12:44:43.962260 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=35550] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 12:44:43.963855 140042173412928 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 12:44:43.966762 140165176223552 standard_logger.py:34] {'step': Array(35550, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768970683.0801494, 'wait_for_prev_duration_secs': 0.0026657581329345703, 'time_between_consecutive_saves_sec': 340.9479579925537, 'checkpointer_blocking_start_time': 1768970683.088155, 'checkpointer_blocking_duration_secs': 0.8735330104827881, 'get_old_steps_start_time': 1768970683.9617748, 'get_old_steps_duration_secs': 0.0003032684326171875, 'checkpoint_manager_blocking_start_time': 1768970683.0780816, 'checkpoint_manager_blocking_duration_secs': 0.8873262405395508}
I0121 12:44:44.595177 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/35550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 12:44:55.006600 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 11.129178s (commit=10.617379s, array_metadata_write=0.511799s)
I0121 12:44:55.017271 140042139842112 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 7.180 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 11 seconds) (per-host)
I0121 12:44:55.017922 140042139842112 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 11.063276s.
I0121 12:44:55.045294 140042139842112 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 12:44:55.185347 140042139842112 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.159420s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/35550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 12:44:55.188172 140042139842112 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/35550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/35550.orbax-checkpoint-tmp/default
I0121 12:44:55.200527 140042139842112 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/35550.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/35550
I0121 12:44:55.311608 140042139842112 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/35550`.
I0121 12:44:55.313450 140042139842112 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 12.225220s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/35550
I0121 12:44:55.313986 140042139842112 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 11.359350s.
I0121 12:44:55.315025 140042173412928 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 12:44:55.315539 140042173412928 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 12:44:55.467462 140042173412928 deleter.py:273] Deleted step 34650.
I0121 12:44:55.468149 140042173412928 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=35550] CheckpointManager Save Finalize is syncing with other hosts...
I0121 12:44:55.468908 140042173412928 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=35550] CheckpointManager Save Finalize is done on all hosts.
step: 36000,  loss data: 6.495e-04, loss res: 1.717e-03, time: 1.735e+02
Epoch 80, getting batches from DataLoader...
step: 36450,  loss data: 1.429e-03, loss res: 1.602e-03, time: 1.721e+02
I0121 12:50:29.528126 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 12:50:29.530959 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 36450
I0121 12:50:29.533135 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/36450.
I0121 12:50:29.569472 140036427163200 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/36450.orbax-checkpoint-tmp
I0121 12:50:29.669750 140037995877952 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/36450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 12:50:29.708853 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 12:50:29.709472 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 12:50:30.311288 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.605078s
I0121 12:50:30.344895 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 107.209 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 797 milliseconds) (per-host)
I0121 12:50:30.352153 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.805218s (batch_requests_ready=0.106689s, total_serialization_initiated=0.679574s, others=0.018954s)
I0121 12:50:30.363558 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.826584s (all_items=0.000097s, per_item={'default': '0.00009656'}, temp_paths=0.826487)
I0121 12:50:30.420448 140042131449408 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 12:50:30.425535 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.893975s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/36450.
I0121 12:50:30.427906 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=36450] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 12:50:30.431768 140165176223552 standard_logger.py:34] {'step': Array(36450, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768971029.5278842, 'wait_for_prev_duration_secs': 0.0009775161743164062, 'time_between_consecutive_saves_sec': 334.0586540699005, 'checkpointer_blocking_start_time': 1768971029.5314772, 'checkpointer_blocking_duration_secs': 0.8959362506866455, 'get_old_steps_start_time': 1768971030.427488, 'get_old_steps_duration_secs': 0.0002639293670654297, 'checkpoint_manager_blocking_start_time': 1768971029.526413, 'checkpoint_manager_blocking_duration_secs': 0.9039440155029297}
I0121 12:50:30.569717 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/36450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 12:50:31.463351 140042257290816 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 12:50:36.204630 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 5.858875s (commit=5.741200s, array_metadata_write=0.117676s)
I0121 12:50:36.208101 140042131449408 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 12.840 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 6 seconds) (per-host)
I0121 12:50:36.208512 140042131449408 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 5.782740s.
I0121 12:50:36.220571 140042131449408 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 12:50:36.465753 140042131449408 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.254031s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/36450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 12:50:36.468105 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/36450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/36450.orbax-checkpoint-tmp/default
I0121 12:50:36.473823 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/36450.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/36450
I0121 12:50:37.124036 140042131449408 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/36450`.
I0121 12:50:37.126192 140042131449408 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 7.594625s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/36450
I0121 12:50:37.126729 140042131449408 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 6.700948s.
I0121 12:50:37.127562 140042257290816 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 12:50:37.128405 140042257290816 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 12:50:37.185986 140042257290816 deleter.py:273] Deleted step 35550.
I0121 12:50:37.186583 140042257290816 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=36450] CheckpointManager Save Finalize is syncing with other hosts...
I0121 12:50:37.187341 140042257290816 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=36450] CheckpointManager Save Finalize is done on all hosts.
step: 36900,  loss data: 1.993e-03, loss res: 5.154e-03, time: 1.735e+02
step: 37350,  loss data: 1.513e-03, loss res: 1.720e-03, time: 1.730e+02
I0121 12:56:16.914885 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 12:56:16.917146 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 37350
I0121 12:56:16.918703 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/37350.
I0121 12:56:16.940013 140038541141568 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/37350.orbax-checkpoint-tmp
I0121 12:56:17.052927 140042156627520 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/37350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 12:56:17.079694 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 12:56:17.080505 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 12:56:17.645744 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.568667s
I0121 12:56:17.653338 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 118.404 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 722 milliseconds) (per-host)
I0121 12:56:17.659479 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.728607s (batch_requests_ready=0.096539s, total_serialization_initiated=0.619622s, others=0.012447s)
I0121 12:56:17.665364 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.742611s (all_items=0.000035s, per_item={'default': '0.00003529'}, temp_paths=0.742575)
I0121 12:56:17.757695 140042131449408 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 12:56:17.758057 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.840364s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/37350.
I0121 12:56:17.761500 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=37350] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 12:56:17.766888 140041879799360 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 12:56:17.769456 140165176223552 standard_logger.py:34] {'step': Array(37350, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768971376.9147632, 'wait_for_prev_duration_secs': 0.0006549358367919922, 'time_between_consecutive_saves_sec': 339.72686982154846, 'checkpointer_blocking_start_time': 1768971376.917625, 'checkpointer_blocking_duration_secs': 0.8434481620788574, 'get_old_steps_start_time': 1768971377.7611477, 'get_old_steps_duration_secs': 0.000202178955078125, 'checkpoint_manager_blocking_start_time': 1768971376.913567, 'checkpoint_manager_blocking_duration_secs': 0.8546831607818604}
I0121 12:56:19.720822 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/37350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 12:56:24.392267 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 6.733458s (commit=6.565598s, array_metadata_write=0.167860s)
I0121 12:56:24.396047 140042131449408 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 11.457 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 7 seconds) (per-host)
I0121 12:56:24.396550 140042131449408 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 6.637848s.
I0121 12:56:24.410379 140042131449408 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 12:56:24.487532 140042131449408 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.087774s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/37350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 12:56:24.490366 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/37350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/37350.orbax-checkpoint-tmp/default
I0121 12:56:24.495963 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/37350.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/37350
I0121 12:56:24.591275 140042131449408 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/37350`.
I0121 12:56:24.592920 140042131449408 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 7.675251s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/37350
I0121 12:56:24.593393 140042131449408 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 6.834685s.
I0121 12:56:24.594341 140041879799360 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 12:56:24.594836 140041879799360 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 12:56:24.648854 140041879799360 deleter.py:273] Deleted step 36450.
I0121 12:56:24.649217 140041879799360 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=37350] CheckpointManager Save Finalize is syncing with other hosts...
I0121 12:56:24.649540 140041879799360 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=37350] CheckpointManager Save Finalize is done on all hosts.
step: 37800,  loss data: 1.198e-03, loss res: 2.171e-03, time: 1.729e+02
step: 38250,  loss data: 1.038e-03, loss res: 2.164e-03, time: 1.733e+02
I0121 13:02:03.985608 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 13:02:03.987744 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 38250
I0121 13:02:03.989275 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/38250.
I0121 13:02:04.016097 140040512443968 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/38250.orbax-checkpoint-tmp
I0121 13:02:04.121829 140040520836672 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/38250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 13:02:04.160074 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 13:02:04.160882 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 13:02:04.729835 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.572411s
I0121 13:02:04.736325 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 116.607 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 733 milliseconds) (per-host)
I0121 13:02:04.742419 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.739652s (batch_requests_ready=0.098421s, total_serialization_initiated=0.629455s, others=0.011777s)
I0121 13:02:04.742801 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.749626s (all_items=0.000054s, per_item={'default': '0.00005364'}, temp_paths=0.749572)
I0121 13:02:04.826249 140042148234816 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 13:02:04.827140 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.838896s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/38250.
I0121 13:02:04.829116 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=38250] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 13:02:04.830455 140042139842112 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 13:02:04.836119 140165176223552 standard_logger.py:34] {'step': Array(38250, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768971723.9854841, 'wait_for_prev_duration_secs': 0.0006508827209472656, 'time_between_consecutive_saves_sec': 339.3357391357422, 'checkpointer_blocking_start_time': 1768971723.9881718, 'checkpointer_blocking_duration_secs': 0.8404910564422607, 'get_old_steps_start_time': 1768971724.8287315, 'get_old_steps_duration_secs': 0.0002307891845703125, 'checkpoint_manager_blocking_start_time': 1768971723.9844275, 'checkpoint_manager_blocking_duration_secs': 0.8476946353912354}
I0121 13:02:04.851445 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/38250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 13:02:09.274970 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 4.532899s (commit=4.427190s, array_metadata_write=0.105709s)
I0121 13:02:09.278653 140042148234816 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 16.212 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 5 seconds) (per-host)
I0121 13:02:09.279106 140042148234816 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 4.451603s.
I0121 13:02:09.291899 140042148234816 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 13:02:09.377242 140042148234816 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.094837s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/38250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 13:02:09.379545 140042148234816 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/38250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/38250.orbax-checkpoint-tmp/default
I0121 13:02:09.384734 140042148234816 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/38250.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/38250
I0121 13:02:09.483319 140042148234816 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/38250`.
I0121 13:02:09.485552 140042148234816 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 5.497335s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/38250
I0121 13:02:09.486803 140042148234816 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 4.659293s.
I0121 13:02:09.487466 140042139842112 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 13:02:09.488263 140042139842112 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 13:02:09.545985 140042139842112 deleter.py:273] Deleted step 37350.
I0121 13:02:09.546367 140042139842112 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=38250] CheckpointManager Save Finalize is syncing with other hosts...
I0121 13:02:09.546690 140042139842112 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=38250] CheckpointManager Save Finalize is done on all hosts.
step: 38700,  loss data: 1.293e-03, loss res: 1.693e-03, time: 1.729e+02
step: 39150,  loss data: 9.197e-04, loss res: 1.488e-03, time: 1.730e+02
I0121 13:07:50.676898 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 13:07:50.679128 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 39150
I0121 13:07:50.680590 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/39150.
I0121 13:07:50.712297 140039061227072 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/39150.orbax-checkpoint-tmp
I0121 13:07:50.816614 140040009143872 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/39150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 13:07:50.847923 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 13:07:50.848734 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 13:07:51.392111 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.546867s
I0121 13:07:51.405038 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 120.230 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 711 milliseconds) (per-host)
I0121 13:07:51.421780 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.728243s (batch_requests_ready=0.097572s, total_serialization_initiated=0.607533s, others=0.023139s)
I0121 13:07:51.427638 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.742887s (all_items=0.000036s, per_item={'default': '0.00003624'}, temp_paths=0.742851)
I0121 13:07:51.496321 140042139842112 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 13:07:51.497374 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.817750s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/39150.
I0121 13:07:51.499606 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=39150] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 13:07:51.504465 140042131449408 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 13:07:51.507770 140165176223552 standard_logger.py:34] {'step': Array(39150, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768972070.6767862, 'wait_for_prev_duration_secs': 0.0006146430969238281, 'time_between_consecutive_saves_sec': 341.1298975944519, 'checkpointer_blocking_start_time': 1768972070.679572, 'checkpointer_blocking_duration_secs': 0.8196618556976318, 'get_old_steps_start_time': 1768972071.4993029, 'get_old_steps_duration_secs': 0.00017523765563964844, 'checkpoint_manager_blocking_start_time': 1768972070.6758337, 'checkpoint_manager_blocking_duration_secs': 0.830247163772583}
I0121 13:07:51.856281 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/39150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 13:08:02.131072 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 10.720135s (commit=10.574404s, array_metadata_write=0.145731s)
I0121 13:08:02.137282 140042139842112 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 7.474 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 11 seconds) (per-host)
I0121 13:08:02.138762 140042139842112 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 10.640502s.
I0121 13:08:02.155751 140042139842112 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 13:08:02.249338 140042139842112 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.105090s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/39150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 13:08:02.251826 140042139842112 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/39150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/39150.orbax-checkpoint-tmp/default
I0121 13:08:02.257207 140042139842112 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/39150.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/39150
I0121 13:08:02.327063 140042139842112 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/39150`.
I0121 13:08:02.328682 140042139842112 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 11.649066s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/39150
I0121 13:08:02.329179 140042139842112 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 10.830945s.
I0121 13:08:02.329993 140042131449408 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 13:08:02.330574 140042131449408 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 13:08:02.383487 140042131449408 deleter.py:273] Deleted step 38250.
I0121 13:08:02.384032 140042131449408 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=39150] CheckpointManager Save Finalize is syncing with other hosts...
I0121 13:08:02.384627 140042131449408 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=39150] CheckpointManager Save Finalize is done on all hosts.
step: 39600,  loss data: 7.784e-04, loss res: 1.517e-03, time: 1.722e+02
step: 40050,  loss data: 1.018e-03, loss res: 1.492e-03, time: 1.721e+02
I0121 13:13:35.836170 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 13:13:35.838862 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 40050
I0121 13:13:35.840939 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/40050.
I0121 13:13:35.878822 140040512443968 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/40050.orbax-checkpoint-tmp
I0121 13:13:35.996071 140040529229376 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/40050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 13:13:36.020976 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 13:13:36.021756 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 13:13:36.574710 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.556466s
I0121 13:13:36.582736 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 117.737 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 726 milliseconds) (per-host)
I0121 13:13:36.588571 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.732506s (batch_requests_ready=0.104013s, total_serialization_initiated=0.616541s, others=0.011951s)
I0121 13:13:36.601046 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.755492s (all_items=0.000094s, per_item={'default': '0.00009418'}, temp_paths=0.755398)
I0121 13:13:36.660521 140042156627520 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 13:13:36.665771 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.826348s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/40050.
I0121 13:13:36.681873 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=40050] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 13:13:36.683932 140042131449408 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 13:13:36.689978 140165176223552 standard_logger.py:34] {'step': Array(40050, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768972415.8359299, 'wait_for_prev_duration_secs': 0.000904083251953125, 'time_between_consecutive_saves_sec': 333.450799703598, 'checkpointer_blocking_start_time': 1768972415.8393404, 'checkpointer_blocking_duration_secs': 0.8419196605682373, 'get_old_steps_start_time': 1768972416.681344, 'get_old_steps_duration_secs': 0.0003256797790527344, 'checkpoint_manager_blocking_start_time': 1768972415.8342845, 'checkpoint_manager_blocking_duration_secs': 0.8545842170715332}
I0121 13:13:36.705327 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/40050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 13:13:38.708950 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 2.120003s (commit=1.999778s, array_metadata_write=0.120226s)
I0121 13:13:38.712393 140042156627520 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 29.945 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 13:13:38.712918 140042156627520 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 2.046779s.
I0121 13:13:38.726866 140042156627520 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 13:13:38.802556 140042156627520 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.086323s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/40050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 13:13:38.804695 140042156627520 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/40050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/40050.orbax-checkpoint-tmp/default
I0121 13:13:38.810224 140042156627520 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/40050.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/40050
I0121 13:13:38.828479 140042156627520 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/40050`.
I0121 13:13:38.829995 140042156627520 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.990584s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/40050
I0121 13:13:38.830492 140042156627520 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 2.164347s.
I0121 13:13:38.831117 140042131449408 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 13:13:38.831827 140042131449408 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 13:13:38.893527 140042131449408 deleter.py:273] Deleted step 39150.
I0121 13:13:38.894069 140042131449408 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=40050] CheckpointManager Save Finalize is syncing with other hosts...
I0121 13:13:38.894436 140042131449408 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=40050] CheckpointManager Save Finalize is done on all hosts.
step: 40500,  loss data: 1.400e-03, loss res: 1.554e-03, time: 1.731e+02
Epoch 90, getting batches from DataLoader...
step: 40950,  loss data: 1.008e-03, loss res: 2.204e-03, time: 1.725e+02
I0121 13:19:22.293629 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 13:19:22.295786 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 40950
I0121 13:19:22.297422 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/40950.
I0121 13:19:22.329191 140039086405184 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/40950.orbax-checkpoint-tmp
I0121 13:19:22.437277 140038524356160 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/40950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 13:19:22.462949 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 13:19:22.463568 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 13:19:23.107907 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.647638s
I0121 13:19:23.130641 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 104.274 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 820 milliseconds) (per-host)
I0121 13:19:23.141484 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.831195s (batch_requests_ready=0.095329s, total_serialization_initiated=0.719180s, others=0.016686s)
I0121 13:19:23.153393 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.851663s (all_items=0.000035s, per_item={'default': '0.00003529'}, temp_paths=0.851627)
I0121 13:19:23.215923 140042139842112 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 13:19:23.216466 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.920124s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/40950.
I0121 13:19:23.219801 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=40950] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 13:19:23.224221 140042257290816 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 13:19:23.227026 140165176223552 standard_logger.py:34] {'step': Array(40950, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768972762.2935166, 'wait_for_prev_duration_secs': 0.0005962848663330078, 'time_between_consecutive_saves_sec': 343.39886593818665, 'checkpointer_blocking_start_time': 1768972762.2962744, 'checkpointer_blocking_duration_secs': 0.9230947494506836, 'get_old_steps_start_time': 1768972763.21944, 'get_old_steps_duration_secs': 0.0002090930938720703, 'checkpoint_manager_blocking_start_time': 1768972762.292413, 'checkpoint_manager_blocking_duration_secs': 0.9329886436462402}
I0121 13:19:23.297564 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/40950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 13:19:24.999050 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.846801s (commit=1.650673s, array_metadata_write=0.196128s)
I0121 13:19:25.003856 140042139842112 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 31.755 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 13:19:25.004688 140042139842112 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.787519s.
I0121 13:19:25.021173 140042139842112 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 13:19:25.127836 140042139842112 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.119852s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/40950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 13:19:25.130055 140042139842112 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/40950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/40950.orbax-checkpoint-tmp/default
I0121 13:19:25.134373 140042139842112 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/40950.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/40950
I0121 13:19:25.176170 140042139842112 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/40950`.
I0121 13:19:25.177735 140042139842112 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.881418s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/40950
I0121 13:19:25.178232 140042139842112 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.961057s.
I0121 13:19:25.178909 140042257290816 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 13:19:25.179371 140042257290816 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 13:19:25.222157 140042257290816 deleter.py:273] Deleted step 40050.
I0121 13:19:25.222478 140042257290816 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=40950] CheckpointManager Save Finalize is syncing with other hosts...
I0121 13:19:25.222760 140042257290816 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=40950] CheckpointManager Save Finalize is done on all hosts.
step: 41400,  loss data: 9.797e-04, loss res: 2.116e-03, time: 1.715e+02
step: 41850,  loss data: 7.629e-04, loss res: 2.747e-03, time: 1.714e+02
I0121 13:25:06.145020 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 13:25:06.147926 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 41850
I0121 13:25:06.150075 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/41850.
I0121 13:25:06.181184 140040017536576 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/41850.orbax-checkpoint-tmp
I0121 13:25:06.289685 140039052834368 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/41850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 13:25:06.323204 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 13:25:06.323850 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 13:25:06.915048 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.594596s
I0121 13:25:06.942522 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 110.463 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 774 milliseconds) (per-host)
I0121 13:25:06.943486 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.775458s (batch_requests_ready=0.100413s, total_serialization_initiated=0.663207s, others=0.011838s)
I0121 13:25:06.944288 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.785965s (all_items=0.000092s, per_item={'default': '0.00009155'}, temp_paths=0.785874)
I0121 13:25:07.020724 140042257290816 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 13:25:07.021030 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.872508s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/41850.
I0121 13:25:07.023734 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=41850] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 13:25:07.025033 140042131449408 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 13:25:07.030392 140165176223552 standard_logger.py:34] {'step': Array(41850, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768973106.1447542, 'wait_for_prev_duration_secs': 0.0010166168212890625, 'time_between_consecutive_saves_sec': 340.9218349456787, 'checkpointer_blocking_start_time': 1768973106.1484404, 'checkpointer_blocking_duration_secs': 0.874809980392456, 'get_old_steps_start_time': 1768973107.0233166, 'get_old_steps_duration_secs': 0.0002734661102294922, 'checkpoint_manager_blocking_start_time': 1768973106.1430118, 'checkpoint_manager_blocking_duration_secs': 0.8861713409423828}
I0121 13:25:07.067597 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/41850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 13:25:10.554882 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 3.604973s (commit=3.461622s, array_metadata_write=0.143351s)
I0121 13:25:10.557884 140042257290816 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 19.484 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 4 seconds) (per-host)
I0121 13:25:10.558302 140042257290816 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 3.536646s.
I0121 13:25:10.573712 140042257290816 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 13:25:10.904194 140042257290816 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.342143s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/41850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 13:25:10.906687 140042257290816 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/41850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/41850.orbax-checkpoint-tmp/default
I0121 13:25:10.917115 140042257290816 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/41850.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/41850
I0121 13:25:10.977847 140042257290816 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/41850`.
I0121 13:25:10.979637 140042257290816 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 4.831126s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/41850
I0121 13:25:10.980131 140042257290816 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 3.958467s.
I0121 13:25:10.981111 140042131449408 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 13:25:10.981561 140042131449408 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 13:25:11.089462 140042131449408 deleter.py:273] Deleted step 40950.
I0121 13:25:11.089830 140042131449408 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=41850] CheckpointManager Save Finalize is syncing with other hosts...
I0121 13:25:11.090183 140042131449408 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=41850] CheckpointManager Save Finalize is done on all hosts.
step: 42300,  loss data: 5.542e-04, loss res: 1.518e-03, time: 1.732e+02
step: 42750,  loss data: 9.902e-04, loss res: 2.617e-03, time: 1.734e+02
I0121 13:30:53.608646 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 13:30:53.610996 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 42750
I0121 13:30:53.612611 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/42750.
I0121 13:30:53.634097 140040537622080 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/42750.orbax-checkpoint-tmp
I0121 13:30:53.741262 140042173412928 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/42750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 13:30:53.776926 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 13:30:53.777778 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 13:30:54.371754 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.597497s
I0121 13:30:54.391213 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 111.507 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 767 milliseconds) (per-host)
I0121 13:30:54.412855 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.788784s (batch_requests_ready=0.096609s, total_serialization_initiated=0.658043s, others=0.034132s)
I0121 13:30:54.468782 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.852186s (all_items=0.000036s, per_item={'default': '0.00003648'}, temp_paths=0.852149)
I0121 13:30:54.473285 140041879799360 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 13:30:54.475117 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.863543s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/42750.
I0121 13:30:54.476450 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=42750] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 13:30:54.480520 140042165020224 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 13:30:54.482697 140165176223552 standard_logger.py:34] {'step': Array(42750, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768973453.6085134, 'wait_for_prev_duration_secs': 0.0007371902465820312, 'time_between_consecutive_saves_sec': 342.5181212425232, 'checkpointer_blocking_start_time': 1768973453.611517, 'checkpointer_blocking_duration_secs': 0.8645064830780029, 'get_old_steps_start_time': 1768973454.4760957, 'get_old_steps_duration_secs': 0.00020551681518554688, 'checkpoint_manager_blocking_start_time': 1768973453.6073933, 'checkpoint_manager_blocking_duration_secs': 0.8742079734802246}
I0121 13:30:54.590215 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/42750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 13:31:00.347212 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 5.956437s (commit=5.710358s, array_metadata_write=0.246078s)
I0121 13:31:00.350704 140041879799360 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 12.715 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 6 seconds) (per-host)
I0121 13:31:00.351239 140041879799360 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 5.876838s.
I0121 13:31:00.364210 140041879799360 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 13:31:00.436069 140041879799360 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.081517s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/42750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 13:31:00.438248 140041879799360 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/42750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/42750.orbax-checkpoint-tmp/default
I0121 13:31:00.443377 140041879799360 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/42750.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/42750
I0121 13:31:01.600583 140041879799360 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/42750`.
I0121 13:31:01.602776 140041879799360 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 7.991211s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/42750
I0121 13:31:01.603307 140041879799360 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 7.128899s.
I0121 13:31:01.604094 140042165020224 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 13:31:01.604703 140042165020224 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 13:31:01.658852 140042165020224 deleter.py:273] Deleted step 41850.
I0121 13:31:01.659402 140042165020224 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=42750] CheckpointManager Save Finalize is syncing with other hosts...
I0121 13:31:01.660042 140042165020224 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=42750] CheckpointManager Save Finalize is done on all hosts.
step: 43200,  loss data: 3.248e-03, loss res: 5.190e-03, time: 1.707e+02
step: 43650,  loss data: 7.027e-04, loss res: 1.289e-03, time: 1.713e+02
I0121 13:36:36.522174 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 13:36:36.524376 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 43650
I0121 13:36:36.525923 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/43650.
I0121 13:36:36.551751 140039036048960 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/43650.orbax-checkpoint-tmp
I0121 13:36:36.677758 140040009143872 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/43650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 13:36:36.703815 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 13:36:36.704695 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 13:36:37.704611 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 1.004008s
I0121 13:36:37.718174 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 72.303 MiB/s (total gbytes: 85.5 MiB) (time elapsed: a second) (per-host)
I0121 13:36:37.735004 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 1.199873s (batch_requests_ready=0.104756s, total_serialization_initiated=1.071689s, others=0.023428s)
I0121 13:36:37.741437 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 1.212732s (all_items=0.000035s, per_item={'default': '0.00003457'}, temp_paths=1.212697)
I0121 13:36:37.808992 140042173412928 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 13:36:37.809487 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 1.284585s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/43650.
I0121 13:36:37.815496 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=43650] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 13:36:37.816326 140041871406656 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 13:36:37.818446 140165176223552 standard_logger.py:34] {'step': Array(43650, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768973796.5220315, 'wait_for_prev_duration_secs': 0.0006725788116455078, 'time_between_consecutive_saves_sec': 334.86133670806885, 'checkpointer_blocking_start_time': 1768973796.5248609, 'checkpointer_blocking_duration_secs': 1.2903344631195068, 'get_old_steps_start_time': 1768973797.8152633, 'get_old_steps_duration_secs': 0.00013828277587890625, 'checkpoint_manager_blocking_start_time': 1768973796.5209231, 'checkpoint_manager_blocking_duration_secs': 1.2965939044952393}
I0121 13:36:39.626963 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/43650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 13:36:45.932852 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 8.215090s (commit=8.042563s, array_metadata_write=0.172527s)
I0121 13:36:45.937905 140042173412928 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 9.096 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 9 seconds) (per-host)
I0121 13:36:45.938362 140042173412928 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 8.127821s.
I0121 13:36:45.951768 140042173412928 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 13:36:46.172714 140042173412928 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.230597s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/43650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 13:36:46.175286 140042173412928 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/43650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/43650.orbax-checkpoint-tmp/default
I0121 13:36:46.179673 140042173412928 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/43650.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/43650
I0121 13:36:46.701397 140042173412928 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/43650`.
I0121 13:36:46.703507 140042173412928 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 10.178601s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/43650
I0121 13:36:46.704057 140042173412928 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 8.893506s.
I0121 13:36:46.704920 140041871406656 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 13:36:46.705650 140041871406656 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 13:36:46.752821 140041871406656 deleter.py:273] Deleted step 42750.
I0121 13:36:46.753401 140041871406656 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=43650] CheckpointManager Save Finalize is syncing with other hosts...
I0121 13:36:46.754069 140041871406656 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=43650] CheckpointManager Save Finalize is done on all hosts.
step: 44100,  loss data: 1.268e-03, loss res: 3.356e-03, time: 1.730e+02
step: 44550,  loss data: 1.157e-03, loss res: 2.374e-03, time: 1.731e+02
I0121 13:42:24.000528 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 13:42:24.002908 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 44550
I0121 13:42:24.004561 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/44550.
I0121 13:42:24.036390 140040537622080 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/44550.orbax-checkpoint-tmp
I0121 13:42:24.136471 140040000751168 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/44550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 13:42:24.170859 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 13:42:24.172349 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 13:42:24.760707 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.592598s
I0121 13:42:24.762855 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 114.731 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 745 milliseconds) (per-host)
I0121 13:42:24.774979 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.757730s (batch_requests_ready=0.098666s, total_serialization_initiated=0.645746s, others=0.013317s)
I0121 13:42:24.776095 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.767227s (all_items=0.000058s, per_item={'default': '0.00005794'}, temp_paths=0.767169)
I0121 13:42:24.864243 140042131449408 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 13:42:24.864517 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.861067s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/44550.
I0121 13:42:24.867367 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=44550] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 13:42:24.868672 140041879799360 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 13:42:24.874669 140165176223552 standard_logger.py:34] {'step': Array(44550, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768974144.000386, 'wait_for_prev_duration_secs': 0.0006959438323974609, 'time_between_consecutive_saves_sec': 337.24578046798706, 'checkpointer_blocking_start_time': 1768974144.0033877, 'checkpointer_blocking_duration_secs': 0.863532543182373, 'get_old_steps_start_time': 1768974144.8669868, 'get_old_steps_duration_secs': 0.00024366378784179688, 'checkpoint_manager_blocking_start_time': 1768974143.999062, 'checkpoint_manager_blocking_duration_secs': 0.874253511428833}
I0121 13:42:24.888136 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/44550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 13:42:26.797844 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 2.023273s (commit=1.333433s, array_metadata_write=0.689840s)
I0121 13:42:26.801105 140042131449408 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 30.724 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 13:42:26.801530 140042131449408 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.936063s.
I0121 13:42:26.814219 140042131449408 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 13:42:26.887836 140042131449408 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.082826s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/44550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 13:42:26.890126 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/44550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/44550.orbax-checkpoint-tmp/default
I0121 13:42:26.895196 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/44550.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/44550
I0121 13:42:26.909642 140042131449408 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/44550`.
I0121 13:42:26.911103 140042131449408 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.907666s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/44550
I0121 13:42:26.911581 140042131449408 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 2.046106s.
I0121 13:42:26.912449 140041879799360 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 13:42:26.913060 140041879799360 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 13:42:26.960276 140041879799360 deleter.py:273] Deleted step 43650.
I0121 13:42:26.960826 140041879799360 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=44550] CheckpointManager Save Finalize is syncing with other hosts...
I0121 13:42:26.961575 140041879799360 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=44550] CheckpointManager Save Finalize is done on all hosts.
step: 45000,  loss data: 6.598e-04, loss res: 6.136e-04, time: 1.735e+02
Epoch 100, getting batches from DataLoader...
step: 45450,  loss data: 7.659e-04, loss res: 2.319e-03, time: 1.728e+02
I0121 13:48:11.107233 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 13:48:11.109396 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 45450
I0121 13:48:11.110870 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/45450.
I0121 13:48:11.138016 140039983965760 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/45450.orbax-checkpoint-tmp
I0121 13:48:11.237015 140038012663360 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/45450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 13:48:11.280318 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 13:48:11.281886 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 13:48:11.882326 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.604740s
I0121 13:48:11.927346 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 106.215 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 805 milliseconds) (per-host)
I0121 13:48:11.933372 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.811500s (batch_requests_ready=0.098586s, total_serialization_initiated=0.669144s, others=0.043770s)
I0121 13:48:11.964168 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.849793s (all_items=0.000036s, per_item={'default': '0.00003624'}, temp_paths=0.849757)
I0121 13:48:11.987437 140042148234816 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 13:48:11.988530 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.878632s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/45450.
I0121 13:48:11.995112 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=45450] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 13:48:11.996629 140042257290816 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 13:48:11.999049 140165176223552 standard_logger.py:34] {'step': Array(45450, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768974491.1071088, 'wait_for_prev_duration_secs': 0.0006308555603027344, 'time_between_consecutive_saves_sec': 344.14496898651123, 'checkpointer_blocking_start_time': 1768974491.109842, 'checkpointer_blocking_duration_secs': 0.8848552703857422, 'get_old_steps_start_time': 1768974491.9947684, 'get_old_steps_duration_secs': 0.0001914501190185547, 'checkpoint_manager_blocking_start_time': 1768974491.106207, 'checkpoint_manager_blocking_duration_secs': 0.8916516304016113}
I0121 13:48:12.163403 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/45450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 13:48:13.279338 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.345601s (commit=1.199029s, array_metadata_write=0.146571s)
I0121 13:48:13.282475 140042148234816 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 39.588 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 13:48:13.282984 140042148234816 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.294203s.
I0121 13:48:13.296060 140042148234816 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 13:48:13.296675 140045092648512 checkpoint.py:247] Updated Metadata={'item_handlers': {'default': 'orbax.checkpoint._src.handlers.standard_checkpoint_handler.StandardCheckpointHandler'}, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1768974491177374742, 'commit_timestamp_nsecs': None, 'custom_metadata': {}} to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/45450.orbax-checkpoint-tmp/_CHECKPOINT_METADATA
I0121 13:48:13.369826 140042148234816 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.082953s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/45450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 13:48:13.372091 140042148234816 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/45450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/45450.orbax-checkpoint-tmp/default
I0121 13:48:13.384513 140042148234816 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/45450.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/45450
I0121 13:48:13.405406 140042148234816 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/45450`.
I0121 13:48:13.407106 140042148234816 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.297220s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/45450
I0121 13:48:13.407608 140042148234816 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.418819s.
I0121 13:48:13.408402 140042257290816 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 13:48:13.408795 140042257290816 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 13:48:13.472462 140042257290816 deleter.py:273] Deleted step 44550.
I0121 13:48:13.473017 140042257290816 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=45450] CheckpointManager Save Finalize is syncing with other hosts...
I0121 13:48:13.473759 140042257290816 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=45450] CheckpointManager Save Finalize is done on all hosts.
step: 45900,  loss data: 5.899e-04, loss res: 1.408e-03, time: 1.731e+02
step: 46350,  loss data: 8.277e-04, loss res: 9.666e-04, time: 1.730e+02
I0121 13:53:58.116347 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 13:53:58.119256 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 46350
I0121 13:53:58.121462 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/46350.
I0121 13:53:58.148637 140039086405184 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/46350.orbax-checkpoint-tmp
I0121 13:53:58.243871 140039975573056 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/46350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 13:53:58.290393 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 13:53:58.291888 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 13:53:58.891647 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.603945s
I0121 13:53:58.918993 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 109.167 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 783 milliseconds) (per-host)
I0121 13:53:58.924716 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.789411s (batch_requests_ready=0.098150s, total_serialization_initiated=0.674717s, others=0.016544s)
I0121 13:53:58.930849 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.805246s (all_items=0.000095s, per_item={'default': '0.00009513'}, temp_paths=0.805151)
I0121 13:53:58.992357 140042165020224 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 13:53:58.993461 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.873616s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/46350.
I0121 13:53:58.996040 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=46350] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 13:53:58.997642 140042131449408 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 13:53:59.001379 140165176223552 standard_logger.py:34] {'step': Array(46350, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768974838.1160898, 'wait_for_prev_duration_secs': 0.0010311603546142578, 'time_between_consecutive_saves_sec': 344.64200711250305, 'checkpointer_blocking_start_time': 1768974838.119762, 'checkpointer_blocking_duration_secs': 0.8758077621459961, 'get_old_steps_start_time': 1768974838.9956439, 'get_old_steps_duration_secs': 0.0002498626708984375, 'checkpoint_manager_blocking_start_time': 1768974838.114455, 'checkpoint_manager_blocking_duration_secs': 0.8849029541015625}
I0121 13:53:59.023130 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/46350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 13:54:00.453637 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.511578s (commit=1.363857s, array_metadata_write=0.147721s)
I0121 13:54:00.457646 140042165020224 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 36.831 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 13:54:00.458109 140042165020224 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.463880s.
I0121 13:54:00.470854 140042165020224 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 13:54:00.559612 140042165020224 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.098142s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/46350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 13:54:00.561858 140042165020224 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/46350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/46350.orbax-checkpoint-tmp/default
I0121 13:54:00.567666 140042165020224 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/46350.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/46350
I0121 13:54:00.583209 140042165020224 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/46350`.
I0121 13:54:00.584788 140042165020224 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.464954s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/46350
I0121 13:54:00.585272 140042165020224 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.591038s.
I0121 13:54:00.586223 140042131449408 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 13:54:00.586716 140042131449408 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 13:54:00.651845 140042131449408 deleter.py:273] Deleted step 45450.
I0121 13:54:00.652203 140042131449408 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=46350] CheckpointManager Save Finalize is syncing with other hosts...
I0121 13:54:00.652527 140042131449408 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=46350] CheckpointManager Save Finalize is done on all hosts.
step: 46800,  loss data: 8.741e-04, loss res: 1.261e-03, time: 1.719e+02
step: 47250,  loss data: 1.801e-03, loss res: 6.433e-03, time: 1.727e+02
I0121 13:59:43.641251 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 13:59:43.643501 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 47250
I0121 13:59:43.645073 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/47250.
I0121 13:59:43.671074 140039983965760 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/47250.orbax-checkpoint-tmp
I0121 13:59:43.774447 140039078012480 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/47250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 13:59:43.823293 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 13:59:43.823987 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 13:59:44.404646 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.584222s
I0121 13:59:44.417094 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 112.388 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 761 milliseconds) (per-host)
I0121 13:59:44.427934 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.771937s (batch_requests_ready=0.108121s, total_serialization_initiated=0.641847s, others=0.021968s)
I0121 13:59:44.444255 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.795473s (all_items=0.000037s, per_item={'default': '0.00003672'}, temp_paths=0.795436)
I0121 13:59:44.502859 140042257290816 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 13:59:44.504407 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.860360s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/47250.
I0121 13:59:44.507836 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=47250] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 13:59:44.511805 140041879799360 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 13:59:44.515206 140165176223552 standard_logger.py:34] {'step': Array(47250, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768975183.641132, 'wait_for_prev_duration_secs': 0.0006470680236816406, 'time_between_consecutive_saves_sec': 342.9884011745453, 'checkpointer_blocking_start_time': 1768975183.643982, 'checkpointer_blocking_duration_secs': 0.863410472869873, 'get_old_steps_start_time': 1768975184.5074682, 'get_old_steps_duration_secs': 0.00020456314086914062, 'checkpoint_manager_blocking_start_time': 1768975183.6398916, 'checkpoint_manager_blocking_duration_secs': 0.8740460872650146}
I0121 13:59:44.526007 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/47250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 13:59:45.926141 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.476464s (commit=1.357708s, array_metadata_write=0.118756s)
I0121 13:59:45.929378 140042257290816 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 37.623 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 13:59:45.929796 140042257290816 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.425198s.
I0121 13:59:45.941648 140042257290816 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 13:59:46.014015 140042257290816 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.081316s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/47250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 13:59:46.018180 140042257290816 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/47250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/47250.orbax-checkpoint-tmp/default
I0121 13:59:46.023545 140042257290816 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/47250.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/47250
I0121 13:59:46.068640 140042257290816 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/47250`.
I0121 13:59:46.070266 140042257290816 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.426242s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/47250
I0121 13:59:46.070751 140042257290816 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.566144s.
I0121 13:59:46.071568 140041879799360 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 13:59:46.072017 140041879799360 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 13:59:46.127934 140041879799360 deleter.py:273] Deleted step 46350.
I0121 13:59:46.128311 140041879799360 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=47250] CheckpointManager Save Finalize is syncing with other hosts...
I0121 13:59:46.128639 140041879799360 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=47250] CheckpointManager Save Finalize is done on all hosts.
step: 47700,  loss data: 1.236e-03, loss res: 4.593e-03, time: 1.735e+02
step: 48150,  loss data: 1.516e-03, loss res: 1.830e-03, time: 1.734e+02
I0121 14:05:31.474222 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 14:05:31.476830 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 48150
I0121 14:05:31.478745 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/48150.
I0121 14:05:31.516854 140040017536576 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/48150.orbax-checkpoint-tmp
I0121 14:05:31.601442 140039983965760 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/48150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 14:05:31.655525 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 14:05:31.656323 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 14:05:32.231653 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.578767s
I0121 14:05:32.233863 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 115.452 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 740 milliseconds) (per-host)
I0121 14:05:32.239643 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.746809s (batch_requests_ready=0.098100s, total_serialization_initiated=0.641712s, others=0.006997s)
I0121 14:05:32.256414 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.773122s (all_items=0.000092s, per_item={'default': '0.00009179'}, temp_paths=0.773030)
I0121 14:05:32.943701 140039052834368 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 14:05:32.947125 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 1.469769s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/48150.
I0121 14:05:32.951633 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=48150] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 14:05:32.956694 140038549534272 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 14:05:32.959276 140165176223552 standard_logger.py:34] {'step': Array(48150, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768975531.4739652, 'wait_for_prev_duration_secs': 0.0009462833404541016, 'time_between_consecutive_saves_sec': 345.3451290130615, 'checkpointer_blocking_start_time': 1768975531.4772666, 'checkpointer_blocking_duration_secs': 1.4739010334014893, 'get_old_steps_start_time': 1768975532.951257, 'get_old_steps_duration_secs': 0.00021791458129882812, 'checkpoint_manager_blocking_start_time': 1768975531.4725645, 'checkpoint_manager_blocking_duration_secs': 1.4849824905395508}
I0121 14:05:32.972619 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/48150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 14:05:34.436996 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 2.174407s (commit=2.056471s, array_metadata_write=0.117937s)
I0121 14:05:34.440041 140039052834368 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 29.021 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 14:05:34.440473 140039052834368 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.491217s.
I0121 14:05:34.454550 140039052834368 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 14:05:34.525456 140039052834368 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.081611s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/48150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 14:05:34.527532 140039052834368 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/48150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/48150.orbax-checkpoint-tmp/default
I0121 14:05:34.532882 140039052834368 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/48150.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/48150
I0121 14:05:34.547944 140039052834368 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/48150`.
I0121 14:05:34.549414 140039052834368 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 3.072085s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/48150
I0121 14:05:34.549885 140039052834368 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.600623s.
I0121 14:05:34.553433 140038549534272 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 14:05:34.553903 140038549534272 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 14:05:34.625045 140038549534272 deleter.py:273] Deleted step 47250.
I0121 14:05:34.625393 140038549534272 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=48150] CheckpointManager Save Finalize is syncing with other hosts...
I0121 14:05:34.625703 140038549534272 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=48150] CheckpointManager Save Finalize is done on all hosts.
step: 48600,  loss data: 9.231e-04, loss res: 4.732e-03, time: 1.721e+02
step: 49050,  loss data: 6.944e-04, loss res: 1.661e-03, time: 1.728e+02
I0121 14:11:17.841056 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 14:11:17.842685 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 49050
I0121 14:11:17.843798 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/49050.
I0121 14:11:17.885803 140042156627520 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/49050.orbax-checkpoint-tmp
I0121 14:11:17.946575 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 14:11:17.947285 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 14:11:17.969917 140045084255808 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/49050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 14:11:18.529077 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.586350s
I0121 14:11:18.562513 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 120.536 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 709 milliseconds) (per-host)
I0121 14:11:18.578595 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.725864s (batch_requests_ready=0.052608s, total_serialization_initiated=0.629760s, others=0.043497s)
I0121 14:11:18.628989 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.781459s (all_items=0.000061s, per_item={'default': '0.00006080'}, temp_paths=0.781399)
I0121 14:11:18.636731 140043767756352 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 14:11:18.637104 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.794099s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/49050.
I0121 14:11:18.638343 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=49050] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 14:11:18.639873 140041879799360 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 14:11:18.641887 140165176223552 standard_logger.py:34] {'step': Array(49050, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768975877.840912, 'wait_for_prev_duration_secs': 0.0005617141723632812, 'time_between_consecutive_saves_sec': 343.2150025367737, 'checkpointer_blocking_start_time': 1768975877.8429399, 'checkpointer_blocking_duration_secs': 0.7948780059814453, 'get_old_steps_start_time': 1768975878.6378958, 'get_old_steps_duration_secs': 0.00029158592224121094, 'checkpoint_manager_blocking_start_time': 1768975877.8399546, 'checkpoint_manager_blocking_duration_secs': 0.800778865814209}
I0121 14:11:18.651278 140042265683520 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/49050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 14:11:20.999380 140042257290816 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 2.442842s (commit=1.712168s, array_metadata_write=0.730674s)
I0121 14:11:21.002833 140043767756352 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 27.152 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 3 seconds) (per-host)
I0121 14:11:21.003345 140043767756352 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 2.366334s.
I0121 14:11:21.014788 140043767756352 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 14:11:21.111638 140043767756352 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.105441s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/49050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 14:11:21.113889 140043767756352 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/49050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/49050.orbax-checkpoint-tmp/default
I0121 14:11:21.118310 140043767756352 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/49050.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/49050
I0121 14:11:21.136240 140043767756352 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/49050`.
I0121 14:11:21.137868 140043767756352 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 3.294876s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/49050
I0121 14:11:21.138454 140043767756352 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 2.501429s.
I0121 14:11:21.139849 140041879799360 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 14:11:21.140391 140041879799360 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 14:11:21.181678 140041879799360 deleter.py:273] Deleted step 48150.
I0121 14:11:21.182272 140041879799360 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=49050] CheckpointManager Save Finalize is syncing with other hosts...
I0121 14:11:21.183037 140041879799360 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=49050] CheckpointManager Save Finalize is done on all hosts.
step: 49500,  loss data: 4.945e-04, loss res: 1.508e-03, time: 1.726e+02
Epoch 110, getting batches from DataLoader...
step: 49950,  loss data: 1.337e-03, loss res: 2.782e-03, time: 1.731e+02
I0121 14:17:04.338295 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 14:17:04.340378 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 49950
I0121 14:17:04.341848 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/49950.
I0121 14:17:04.362876 140040554407488 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/49950.orbax-checkpoint-tmp
I0121 14:17:04.484145 140040025929280 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/49950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 14:17:04.508257 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 14:17:04.508859 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 14:17:05.092630 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.586859s
I0121 14:17:05.133133 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 109.690 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 779 milliseconds) (per-host)
I0121 14:17:05.144282 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.791013s (batch_requests_ready=0.100151s, total_serialization_initiated=0.650818s, others=0.040045s)
I0121 14:17:05.192908 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.847197s (all_items=0.000036s, per_item={'default': '0.00003624'}, temp_paths=0.847161)
I0121 14:17:05.199736 140042131449408 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 14:17:05.200633 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.859756s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/49950.
I0121 14:17:05.205871 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=49950] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 14:17:05.207235 140042148234816 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 14:17:05.210363 140165176223552 standard_logger.py:34] {'step': Array(49950, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768976224.3381777, 'wait_for_prev_duration_secs': 0.0006046295166015625, 'time_between_consecutive_saves_sec': 343.1546244621277, 'checkpointer_blocking_start_time': 1768976224.340824, 'checkpointer_blocking_duration_secs': 0.8646194934844971, 'get_old_steps_start_time': 1768976225.205527, 'get_old_steps_duration_secs': 0.00020122528076171875, 'checkpoint_manager_blocking_start_time': 1768976224.337225, 'checkpoint_manager_blocking_duration_secs': 0.8717093467712402}
I0121 14:17:05.225155 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/49950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 14:17:06.795608 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.662971s (commit=1.522366s, array_metadata_write=0.140604s)
I0121 14:17:06.799661 140042131449408 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 34.963 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 14:17:06.800173 140042131449408 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.599671s.
I0121 14:17:06.810242 140042131449408 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 14:17:06.876133 140042131449408 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.073448s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/49950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 14:17:06.878378 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/49950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/49950.orbax-checkpoint-tmp/default
I0121 14:17:06.883911 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/49950.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/49950
I0121 14:17:06.899063 140042131449408 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/49950`.
I0121 14:17:06.900760 140042131449408 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.559894s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/49950
I0121 14:17:06.901259 140042131449408 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.700749s.
I0121 14:17:06.902197 140042148234816 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 14:17:06.902703 140042148234816 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 14:17:06.951517 140042148234816 deleter.py:273] Deleted step 49050.
I0121 14:17:06.952058 140042148234816 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=49950] CheckpointManager Save Finalize is syncing with other hosts...
I0121 14:17:06.952800 140042148234816 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=49950] CheckpointManager Save Finalize is done on all hosts.
step: 50400,  loss data: 5.392e-04, loss res: 1.238e-03, time: 1.733e+02
step: 50850,  loss data: 5.905e-04, loss res: 1.109e-03, time: 1.731e+02
I0121 14:22:51.704802 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 14:22:51.707458 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 50850
I0121 14:22:51.709563 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/50850.
I0121 14:22:51.736225 140038012663360 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/50850.orbax-checkpoint-tmp
I0121 14:22:51.853420 140041879799360 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/50850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 14:22:51.875105 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 14:22:51.875844 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 14:22:52.488509 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.616130s
I0121 14:22:52.496045 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 110.536 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 773 milliseconds) (per-host)
I0121 14:22:52.511733 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.789670s (batch_requests_ready=0.094300s, total_serialization_initiated=0.673559s, others=0.021810s)
I0121 14:22:52.512729 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.799197s (all_items=0.000092s, per_item={'default': '0.00009179'}, temp_paths=0.799105)
I0121 14:22:52.591549 140042131449408 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 14:22:52.592135 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.884083s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/50850.
I0121 14:22:52.596644 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=50850] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 14:22:52.601069 140041871406656 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 14:22:52.603257 140165176223552 standard_logger.py:34] {'step': Array(50850, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768976571.7045498, 'wait_for_prev_duration_secs': 0.0009448528289794922, 'time_between_consecutive_saves_sec': 344.751188993454, 'checkpointer_blocking_start_time': 1768976571.7079682, 'checkpointer_blocking_duration_secs': 0.8881950378417969, 'get_old_steps_start_time': 1768976572.5962367, 'get_old_steps_duration_secs': 0.0002493858337402344, 'checkpoint_manager_blocking_start_time': 1768976571.7028844, 'checkpoint_manager_blocking_duration_secs': 0.8989977836608887}
I0121 14:22:52.613937 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/50850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 14:22:53.972035 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.442150s (commit=1.345773s, array_metadata_write=0.096378s)
I0121 14:22:53.976521 140042131449408 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 37.940 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 14:22:53.977030 140042131449408 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.382707s.
I0121 14:22:53.989186 140042131449408 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 14:22:54.101645 140042131449408 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.121246s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/50850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 14:22:54.103916 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/50850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/50850.orbax-checkpoint-tmp/default
I0121 14:22:54.109083 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/50850.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/50850
I0121 14:22:54.140648 140042131449408 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/50850`.
I0121 14:22:54.142202 140042131449408 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.434164s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/50850
I0121 14:22:54.142678 140042131449408 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.548349s.
I0121 14:22:54.143602 140041871406656 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 14:22:54.144036 140041871406656 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 14:22:54.192529 140041871406656 deleter.py:273] Deleted step 49950.
I0121 14:22:54.192881 140041871406656 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=50850] CheckpointManager Save Finalize is syncing with other hosts...
I0121 14:22:54.193196 140041871406656 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=50850] CheckpointManager Save Finalize is done on all hosts.
step: 51300,  loss data: 1.086e-03, loss res: 1.099e-03, time: 1.733e+02
step: 51750,  loss data: 7.830e-04, loss res: 8.535e-04, time: 1.732e+02
I0121 14:28:39.113626 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 14:28:39.115751 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 51750
I0121 14:28:39.117178 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/51750.
I0121 14:28:39.748199 140043767756352 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/51750.orbax-checkpoint-tmp
I0121 14:28:39.812706 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 14:28:39.813304 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 14:28:39.833132 140040554407488 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/51750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 14:28:40.348792 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.538142s
I0121 14:28:40.371583 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 132.188 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 647 milliseconds) (per-host)
I0121 14:28:40.388734 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.664265s (batch_requests_ready=0.049317s, total_serialization_initiated=0.591455s, others=0.023493s)
I0121 14:28:40.442983 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 1.322474s (all_items=0.000035s, per_item={'default': '0.00003505'}, temp_paths=1.322439)
I0121 14:28:40.451831 140042131449408 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 14:28:40.452495 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 1.336254s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/51750.
I0121 14:28:40.454853 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=51750] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 14:28:40.456347 140041879799360 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 14:28:40.460017 140165176223552 standard_logger.py:34] {'step': Array(51750, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768976919.1135132, 'wait_for_prev_duration_secs': 0.0005877017974853516, 'time_between_consecutive_saves_sec': 344.92011737823486, 'checkpointer_blocking_start_time': 1768976919.1161807, 'checkpointer_blocking_duration_secs': 1.3382189273834229, 'get_old_steps_start_time': 1768976920.454475, 'get_old_steps_duration_secs': 0.00023031234741210938, 'checkpoint_manager_blocking_start_time': 1768976919.1125634, 'checkpoint_manager_blocking_duration_secs': 1.346179723739624}
I0121 14:28:40.467560 140042274076224 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/51750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 14:28:41.964633 140042265683520 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.581700s (commit=1.468158s, array_metadata_write=0.113542s)
I0121 14:28:41.967935 140042131449408 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 38.125 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 14:28:41.968319 140042131449408 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.515516s.
I0121 14:28:41.982170 140042131449408 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 14:28:42.057283 140042131449408 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.085598s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/51750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 14:28:42.059352 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/51750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/51750.orbax-checkpoint-tmp/default
I0121 14:28:42.064667 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/51750.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/51750
I0121 14:28:42.146420 140042131449408 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/51750`.
I0121 14:28:42.148019 140042131449408 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 3.031797s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/51750
I0121 14:28:42.148510 140042131449408 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.695701s.
I0121 14:28:42.149187 140041879799360 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 14:28:42.149717 140041879799360 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 14:28:42.203493 140041879799360 deleter.py:273] Deleted step 50850.
I0121 14:28:42.203849 140041879799360 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=51750] CheckpointManager Save Finalize is syncing with other hosts...
I0121 14:28:42.204170 140041879799360 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=51750] CheckpointManager Save Finalize is done on all hosts.
step: 52200,  loss data: 7.692e-04, loss res: 1.212e-03, time: 1.733e+02
step: 52650,  loss data: 1.139e-03, loss res: 1.936e-03, time: 1.729e+02
I0121 14:34:26.691127 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 14:34:26.694009 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 52650
I0121 14:34:26.696100 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/52650.
I0121 14:34:26.718204 140039061227072 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/52650.orbax-checkpoint-tmp
I0121 14:34:26.834826 140040512443968 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/52650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 14:34:26.867066 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 14:34:26.868654 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 14:34:27.458301 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.594029s
I0121 14:34:27.487844 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 110.056 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 777 milliseconds) (per-host)
I0121 14:34:27.499517 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.789034s (batch_requests_ready=0.098855s, total_serialization_initiated=0.661154s, others=0.029024s)
I0121 14:34:27.505371 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.805145s (all_items=0.000095s, per_item={'default': '0.00009489'}, temp_paths=0.805050)
I0121 14:34:27.563638 140042131449408 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 14:34:27.563956 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.869345s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/52650.
I0121 14:34:27.566653 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=52650] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 14:34:27.567969 140041879799360 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 14:34:27.573980 140165176223552 standard_logger.py:34] {'step': Array(52650, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768977266.690887, 'wait_for_prev_duration_secs': 0.0010144710540771484, 'time_between_consecutive_saves_sec': 344.4865143299103, 'checkpointer_blocking_start_time': 1768977266.6945236, 'checkpointer_blocking_duration_secs': 0.8716537952423096, 'get_old_steps_start_time': 1768977267.5662425, 'get_old_steps_duration_secs': 0.00025773048400878906, 'checkpoint_manager_blocking_start_time': 1768977266.6890748, 'checkpoint_manager_blocking_duration_secs': 0.8811094760894775}
I0121 14:34:27.593101 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/52650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 14:34:29.618532 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 2.136844s (commit=2.014701s, array_metadata_write=0.122144s)
I0121 14:34:29.622028 140042131449408 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 29.377 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 14:34:29.622473 140042131449408 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 2.057488s.
I0121 14:34:29.634576 140042131449408 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 14:34:29.705618 140042131449408 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.079863s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/52650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 14:34:29.707762 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/52650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/52650.orbax-checkpoint-tmp/default
I0121 14:34:29.720243 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/52650.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/52650
I0121 14:34:29.734088 140042131449408 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/52650`.
I0121 14:34:29.735641 140042131449408 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 3.041052s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/52650
I0121 14:34:29.736102 140042131449408 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 2.171111s.
I0121 14:34:29.737045 140041879799360 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 14:34:29.737491 140041879799360 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 14:34:29.793301 140041879799360 deleter.py:273] Deleted step 51750.
I0121 14:34:29.793676 140041879799360 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=52650] CheckpointManager Save Finalize is syncing with other hosts...
I0121 14:34:29.793998 140041879799360 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=52650] CheckpointManager Save Finalize is done on all hosts.
step: 53100,  loss data: 4.326e-04, loss res: 4.995e-04, time: 1.740e+02
step: 53550,  loss data: 6.479e-04, loss res: 1.083e-03, time: 1.729e+02
I0121 14:40:14.446082 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 14:40:14.448071 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 53550
I0121 14:40:14.449517 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/53550.
I0121 14:40:14.482412 140042156627520 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/53550.orbax-checkpoint-tmp
I0121 14:40:14.585896 140039069619776 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/53550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 14:40:14.621785 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 14:40:14.622701 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 14:40:15.231630 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.612470s
I0121 14:40:15.244015 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 109.427 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 781 milliseconds) (per-host)
I0121 14:40:15.255797 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.793510s (batch_requests_ready=0.101794s, total_serialization_initiated=0.673779s, others=0.017938s)
I0121 14:40:15.267184 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.812693s (all_items=0.000036s, per_item={'default': '0.00003600'}, temp_paths=0.812657)
I0121 14:40:15.329885 140042131449408 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 14:40:15.330818 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.882258s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/53550.
I0121 14:40:15.333510 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=53550] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 14:40:15.336747 140042257290816 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 14:40:15.339351 140165176223552 standard_logger.py:34] {'step': Array(53550, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768977614.4459677, 'wait_for_prev_duration_secs': 0.0005934238433837891, 'time_between_consecutive_saves_sec': 344.6517586708069, 'checkpointer_blocking_start_time': 1768977614.448503, 'checkpointer_blocking_duration_secs': 0.8846871852874756, 'get_old_steps_start_time': 1768977615.3332715, 'get_old_steps_duration_secs': 0.00016164779663085938, 'checkpoint_manager_blocking_start_time': 1768977614.4450083, 'checkpoint_manager_blocking_duration_secs': 0.8928482532501221}
I0121 14:40:15.356764 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/53550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 14:40:17.061300 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.811471s (commit=1.663209s, array_metadata_write=0.148262s)
I0121 14:40:17.065157 140042131449408 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 32.861 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 14:40:17.065967 140042131449408 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.734403s.
I0121 14:40:17.086568 140042131449408 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 14:40:17.246327 140042131449408 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.171654s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/53550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 14:40:17.248607 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/53550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/53550.orbax-checkpoint-tmp/default
I0121 14:40:17.253962 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/53550.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/53550
I0121 14:40:17.292370 140042131449408 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/53550`.
I0121 14:40:17.293974 140042131449408 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.845430s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/53550
I0121 14:40:17.294466 140042131449408 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.962897s.
I0121 14:40:17.295103 140042257290816 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 14:40:17.295943 140042257290816 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 14:40:17.432662 140042257290816 deleter.py:273] Deleted step 52650.
I0121 14:40:17.433241 140042257290816 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=53550] CheckpointManager Save Finalize is syncing with other hosts...
I0121 14:40:17.434052 140042257290816 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=53550] CheckpointManager Save Finalize is done on all hosts.
step: 54000,  loss data: 6.970e-04, loss res: 1.843e-03, time: 1.726e+02
Epoch 120, getting batches from DataLoader...
step: 54450,  loss data: 6.910e-04, loss res: 8.569e-04, time: 1.719e+02
I0121 14:45:59.811982 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 14:45:59.814254 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 54450
I0121 14:45:59.815761 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/54450.
I0121 14:45:59.842120 140039975573056 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/54450.orbax-checkpoint-tmp
I0121 14:45:59.937273 140039086405184 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/54450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 14:45:59.984617 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 14:45:59.985328 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 14:46:00.573904 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.591886s
I0121 14:46:00.608620 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 109.424 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 781 milliseconds) (per-host)
I0121 14:46:00.624865 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.798006s (batch_requests_ready=0.100104s, total_serialization_initiated=0.653597s, others=0.044305s)
I0121 14:46:00.663614 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.843814s (all_items=0.000047s, per_item={'default': '0.00004745'}, temp_paths=0.843767)
I0121 14:46:00.682091 140042131449408 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 14:46:00.682484 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.867727s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/54450.
I0121 14:46:00.688664 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=54450] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 14:46:00.690766 140042173412928 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 14:46:00.693090 140165176223552 standard_logger.py:34] {'step': Array(54450, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768977959.8118224, 'wait_for_prev_duration_secs': 0.0007138252258300781, 'time_between_consecutive_saves_sec': 342.37669944763184, 'checkpointer_blocking_start_time': 1768977959.8146853, 'checkpointer_blocking_duration_secs': 0.8735358715057373, 'get_old_steps_start_time': 1768977960.6882992, 'get_old_steps_duration_secs': 0.000213623046875, 'checkpoint_manager_blocking_start_time': 1768977959.810733, 'checkpoint_manager_blocking_duration_secs': 0.8812956809997559}
I0121 14:46:00.707444 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/54450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 14:46:02.179629 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.576662s (commit=1.434244s, array_metadata_write=0.142419s)
I0121 14:46:02.183522 140042131449408 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 36.295 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 14:46:02.184038 140042131449408 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.500678s.
I0121 14:46:02.197759 140042131449408 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 14:46:02.318186 140042131449408 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.130960s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/54450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 14:46:02.320461 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/54450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/54450.orbax-checkpoint-tmp/default
I0121 14:46:02.325707 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/54450.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/54450
I0121 14:46:02.366220 140042131449408 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/54450`.
I0121 14:46:02.367810 140042131449408 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.553080s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/54450
I0121 14:46:02.368286 140042131449408 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.684921s.
I0121 14:46:02.369107 140042173412928 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 14:46:02.369683 140042173412928 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 14:46:02.424748 140042173412928 deleter.py:273] Deleted step 53550.
I0121 14:46:02.425115 140042173412928 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=54450] CheckpointManager Save Finalize is syncing with other hosts...
I0121 14:46:02.425435 140042173412928 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=54450] CheckpointManager Save Finalize is done on all hosts.
step: 54900,  loss data: 5.625e-04, loss res: 5.293e-04, time: 1.733e+02
step: 55350,  loss data: 1.108e-03, loss res: 3.201e-03, time: 1.736e+02
I0121 14:51:47.587857 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 14:51:47.590142 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 55350
I0121 14:51:47.591728 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/55350.
I0121 14:51:47.613659 140042139842112 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/55350.orbax-checkpoint-tmp
I0121 14:51:47.731815 140040529229376 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/55350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 14:51:47.763068 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 14:51:47.764296 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 14:51:48.311743 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.551098s
I0121 14:51:48.313939 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 120.641 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 708 milliseconds) (per-host)
I0121 14:51:48.325859 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.720982s (batch_requests_ready=0.101387s, total_serialization_initiated=0.606455s, others=0.013140s)
I0121 14:51:48.337240 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.741424s (all_items=0.000036s, per_item={'default': '0.00003648'}, temp_paths=0.741388)
I0121 14:51:48.415323 140041879799360 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 14:51:48.415600 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.824907s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/55350.
I0121 14:51:48.418657 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=55350] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 14:51:48.423381 140042257290816 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 14:51:48.426859 140165176223552 standard_logger.py:34] {'step': Array(55350, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768978307.5877445, 'wait_for_prev_duration_secs': 0.0006480216979980469, 'time_between_consecutive_saves_sec': 345.16210079193115, 'checkpointer_blocking_start_time': 1768978307.590631, 'checkpointer_blocking_duration_secs': 0.8276023864746094, 'get_old_steps_start_time': 1768978308.4183028, 'get_old_steps_duration_secs': 0.00020122528076171875, 'checkpoint_manager_blocking_start_time': 1768978307.5867972, 'checkpoint_manager_blocking_duration_secs': 0.8388059139251709}
I0121 14:51:48.477090 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/55350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 14:51:50.181324 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.855990s (commit=1.708162s, array_metadata_write=0.147828s)
I0121 14:51:50.185392 140041879799360 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 33.146 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 14:51:50.185819 140041879799360 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.769589s.
I0121 14:51:50.218835 140041879799360 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 14:51:50.291965 140041879799360 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.102709s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/55350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 14:51:50.297747 140041879799360 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/55350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/55350.orbax-checkpoint-tmp/default
I0121 14:51:50.303947 140041879799360 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/55350.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/55350
I0121 14:51:50.319327 140041879799360 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/55350`.
I0121 14:51:50.321282 140041879799360 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.730606s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/55350
I0121 14:51:50.321808 140041879799360 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.905571s.
I0121 14:51:50.322528 140042257290816 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 14:51:50.323247 140042257290816 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 14:51:50.380562 140042257290816 deleter.py:273] Deleted step 54450.
I0121 14:51:50.381110 140042257290816 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=55350] CheckpointManager Save Finalize is syncing with other hosts...
I0121 14:51:50.381713 140042257290816 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=55350] CheckpointManager Save Finalize is done on all hosts.
step: 55800,  loss data: 9.791e-04, loss res: 2.287e-03, time: 1.736e+02
step: 56250,  loss data: 6.071e-04, loss res: 2.231e-03, time: 1.733e+02
I0121 14:57:35.349928 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 14:57:35.352961 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 56250
I0121 14:57:35.355080 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/56250.
I0121 14:57:35.384428 140039052834368 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/56250.orbax-checkpoint-tmp
I0121 14:57:35.496742 140040546014784 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/56250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 14:57:35.526096 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 14:57:35.526722 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 14:57:36.100759 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.577313s
I0121 14:57:36.114406 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 115.385 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 741 milliseconds) (per-host)
I0121 14:57:36.136797 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.763908s (batch_requests_ready=0.097250s, total_serialization_initiated=0.637169s, others=0.029489s)
I0121 14:57:36.177171 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.817513s (all_items=0.000091s, per_item={'default': '0.00009108'}, temp_paths=0.817421)
I0121 14:57:36.815247 140032711063104 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 14:57:36.817832 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 1.464267s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/56250.
I0121 14:57:36.826387 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=56250] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 14:57:36.839276 140032702670400 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 14:57:36.846297 140165176223552 standard_logger.py:34] {'step': Array(56250, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768978655.349682, 'wait_for_prev_duration_secs': 0.0009815692901611328, 'time_between_consecutive_saves_sec': 344.9674229621887, 'checkpointer_blocking_start_time': 1768978655.3534617, 'checkpointer_blocking_duration_secs': 1.4724252223968506, 'get_old_steps_start_time': 1768978656.8259737, 'get_old_steps_duration_secs': 0.00025963783264160156, 'checkpoint_manager_blocking_start_time': 1768978655.3481216, 'checkpoint_manager_blocking_duration_secs': 1.49692702293396}
I0121 14:57:37.020377 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/56250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 14:57:38.272803 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 2.147254s (commit=2.002781s, array_metadata_write=0.144473s)
I0121 14:57:38.276446 140032711063104 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 29.458 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 14:57:38.276959 140032711063104 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.458731s.
I0121 14:57:38.289014 140032711063104 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 14:57:38.358684 140032711063104 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.078582s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/56250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 14:57:38.360263 140032711063104 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/56250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/56250.orbax-checkpoint-tmp/default
I0121 14:57:38.364933 140032711063104 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/56250.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/56250
I0121 14:57:38.378534 140032711063104 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/56250`.
I0121 14:57:38.379586 140032711063104 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 3.026069s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/56250
I0121 14:57:38.379886 140032711063104 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.561661s.
I0121 14:57:38.380372 140032702670400 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 14:57:38.381094 140032702670400 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 14:57:38.450283 140032702670400 deleter.py:273] Deleted step 55350.
I0121 14:57:38.450699 140032702670400 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=56250] CheckpointManager Save Finalize is syncing with other hosts...
I0121 14:57:38.451153 140032702670400 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=56250] CheckpointManager Save Finalize is done on all hosts.
step: 56700,  loss data: 1.185e-03, loss res: 9.858e-04, time: 1.733e+02
step: 57150,  loss data: 8.884e-04, loss res: 5.995e-04, time: 1.727e+02
I0121 15:03:22.832677 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 15:03:22.834706 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 57150
I0121 15:03:22.836174 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/57150.
I0121 15:03:22.862942 140038549534272 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/57150.orbax-checkpoint-tmp
I0121 15:03:22.980461 140036511090240 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/57150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 15:03:23.010706 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 15:03:23.012047 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 15:03:23.649120 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.641365s
I0121 15:03:23.667288 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 104.421 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 819 milliseconds) (per-host)
I0121 15:03:23.683684 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.835583s (batch_requests_ready=0.101300s, total_serialization_initiated=0.711395s, others=0.022888s)
I0121 15:03:23.690194 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.849825s (all_items=0.000035s, per_item={'default': '0.00003457'}, temp_paths=0.849790)
I0121 15:03:23.759439 140042257290816 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 15:03:23.759875 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.924662s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/57150.
I0121 15:03:23.764194 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=57150] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 15:03:23.765398 140041879799360 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 15:03:23.767144 140165176223552 standard_logger.py:34] {'step': Array(57150, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768979002.8325636, 'wait_for_prev_duration_secs': 0.0005967617034912109, 'time_between_consecutive_saves_sec': 344.3811709880829, 'checkpointer_blocking_start_time': 1768979002.8351536, 'checkpointer_blocking_duration_secs': 0.9286229610443115, 'get_old_steps_start_time': 1768979003.7638464, 'get_old_steps_duration_secs': 0.0001957416534423828, 'checkpoint_manager_blocking_start_time': 1768979002.8316255, 'checkpoint_manager_blocking_duration_secs': 0.9345626831054688}
I0121 15:03:23.778874 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/57150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 15:03:25.512063 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.833878s (commit=1.691594s, array_metadata_write=0.142283s)
I0121 15:03:25.516320 140042257290816 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 32.057 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 15:03:25.516827 140042257290816 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.753872s.
I0121 15:03:25.531890 140042257290816 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 15:03:25.600000 140042257290816 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.079499s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/57150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 15:03:25.602214 140042257290816 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/57150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/57150.orbax-checkpoint-tmp/default
I0121 15:03:25.608029 140042257290816 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/57150.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/57150
I0121 15:03:25.648469 140042257290816 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/57150`.
I0121 15:03:25.650315 140042257290816 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.815116s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/57150
I0121 15:03:25.650837 140042257290816 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.887873s.
I0121 15:03:25.651645 140041879799360 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 15:03:25.652142 140041879799360 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 15:03:25.710481 140041879799360 deleter.py:273] Deleted step 56250.
I0121 15:03:25.710842 140041879799360 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=57150] CheckpointManager Save Finalize is syncing with other hosts...
I0121 15:03:25.711169 140041879799360 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=57150] CheckpointManager Save Finalize is done on all hosts.
step: 57600,  loss data: 6.189e-04, loss res: 5.657e-04, time: 1.733e+02
step: 58050,  loss data: 1.563e-03, loss res: 4.980e-03, time: 1.729e+02
I0121 15:09:10.010682 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 15:09:10.013478 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 58050
I0121 15:09:10.015584 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/58050.
I0121 15:09:10.042953 140040512443968 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/58050.orbax-checkpoint-tmp
I0121 15:09:10.141383 140040017536576 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/58050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 15:09:10.182206 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 15:09:10.183105 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 15:09:10.764985 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.585405s
I0121 15:09:10.819658 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 108.269 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 789 milliseconds) (per-host)
I0121 15:09:10.866218 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.836754s (batch_requests_ready=0.096433s, total_serialization_initiated=0.667079s, others=0.073243s)
I0121 15:09:10.868585 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.848780s (all_items=0.000091s, per_item={'default': '0.00009084'}, temp_paths=0.848689)
I0121 15:09:10.876451 140042139842112 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 15:09:10.877482 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.863413s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/58050.
I0121 15:09:10.879584 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=58050] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 15:09:10.881601 140042173412928 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 15:09:10.884181 140165176223552 standard_logger.py:34] {'step': Array(58050, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768979350.0104256, 'wait_for_prev_duration_secs': 0.0010390281677246094, 'time_between_consecutive_saves_sec': 344.2990460395813, 'checkpointer_blocking_start_time': 1768979350.0139892, 'checkpointer_blocking_duration_secs': 0.8650815486907959, 'get_old_steps_start_time': 1768979350.8791487, 'get_old_steps_duration_secs': 0.00029158592224121094, 'checkpoint_manager_blocking_start_time': 1768979350.00867, 'checkpoint_manager_blocking_duration_secs': 0.8738629817962646}
I0121 15:09:10.893418 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/58050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 15:09:12.475944 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.676815s (commit=1.533272s, array_metadata_write=0.143543s)
I0121 15:09:12.480068 140042139842112 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 34.903 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 15:09:12.480588 140042139842112 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.602832s.
I0121 15:09:12.498363 140042139842112 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 15:09:12.580605 140042139842112 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.096991s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/58050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 15:09:12.583257 140042139842112 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/58050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/58050.orbax-checkpoint-tmp/default
I0121 15:09:12.588169 140042139842112 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/58050.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/58050
I0121 15:09:12.602192 140042139842112 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/58050`.
I0121 15:09:12.604245 140042139842112 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.590183s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/58050
I0121 15:09:12.605114 140042139842112 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.727350s.
I0121 15:09:12.607006 140042173412928 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 15:09:12.607629 140042173412928 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 15:09:12.650483 140042173412928 deleter.py:273] Deleted step 57150.
I0121 15:09:12.651043 140042173412928 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=58050] CheckpointManager Save Finalize is syncing with other hosts...
I0121 15:09:12.651784 140042173412928 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=58050] CheckpointManager Save Finalize is done on all hosts.
step: 58500,  loss data: 6.505e-04, loss res: 9.530e-04, time: 1.734e+02
Epoch 130, getting batches from DataLoader...
step: 58950,  loss data: 9.525e-04, loss res: 8.031e-04, time: 1.732e+02
I0121 15:14:57.494786 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 15:14:57.496872 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 58950
I0121 15:14:57.498391 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/58950.
I0121 15:14:57.524116 140039975573056 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/58950.orbax-checkpoint-tmp
I0121 15:14:57.633871 140040529229376 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/58950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 15:14:57.672344 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 15:14:57.672966 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 15:14:58.218884 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.549129s
I0121 15:14:58.247554 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 116.459 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 734 milliseconds) (per-host)
I0121 15:14:58.253314 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.740298s (batch_requests_ready=0.104296s, total_serialization_initiated=0.602997s, others=0.033004s)
I0121 15:14:58.314738 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.809150s (all_items=0.000037s, per_item={'default': '0.00003695'}, temp_paths=0.809113)
I0121 15:14:58.319016 140042139842112 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 15:14:58.319811 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.822422s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/58950.
I0121 15:14:58.321803 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=58950] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 15:14:58.323091 140042257290816 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 15:14:58.326611 140165176223552 standard_logger.py:34] {'step': Array(58950, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768979697.494664, 'wait_for_prev_duration_secs': 0.0006036758422851562, 'time_between_consecutive_saves_sec': 344.84234380722046, 'checkpointer_blocking_start_time': 1768979697.4973326, 'checkpointer_blocking_duration_secs': 0.8240542411804199, 'get_old_steps_start_time': 1768979698.3214543, 'get_old_steps_duration_secs': 0.0002014636993408203, 'checkpoint_manager_blocking_start_time': 1768979697.493591, 'checkpoint_manager_blocking_duration_secs': 0.8313753604888916}
I0121 15:15:00.319805 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/58950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 15:15:13.605132 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 15.373761s (commit=15.081588s, array_metadata_write=0.292172s)
I0121 15:15:13.609492 140042139842112 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 5.314 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 16 seconds) (per-host)
I0121 15:15:13.609997 140042139842112 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 15.289617s.
I0121 15:15:13.634697 140042139842112 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 15:15:15.159280 140042139842112 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 1.542219s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/58950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 15:15:15.161951 140042139842112 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/58950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/58950.orbax-checkpoint-tmp/default
I0121 15:15:15.169099 140042139842112 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/58950.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/58950
I0121 15:15:16.259677 140042139842112 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/58950`.
I0121 15:15:16.261740 140042139842112 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 18.764360s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/58950
I0121 15:15:16.262351 140042139842112 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 17.941962s.
I0121 15:15:16.263314 140042257290816 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 15:15:16.263790 140042257290816 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 15:15:16.327793 140042257290816 deleter.py:273] Deleted step 58050.
I0121 15:15:16.328337 140042257290816 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=58950] CheckpointManager Save Finalize is syncing with other hosts...
I0121 15:15:16.328924 140042257290816 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=58950] CheckpointManager Save Finalize is done on all hosts.
step: 59400,  loss data: 9.173e-04, loss res: 8.075e-04, time: 1.720e+02
step: 59850,  loss data: 6.065e-04, loss res: 5.066e-04, time: 1.729e+02
I0121 15:20:43.244622 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 15:20:43.246744 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 59850
I0121 15:20:43.248218 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/59850.
I0121 15:20:43.290132 140039992358464 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/59850.orbax-checkpoint-tmp
I0121 15:20:43.371593 140041871406656 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/59850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 15:20:43.412773 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 15:20:43.414488 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 15:20:44.125817 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.715543s
I0121 15:20:44.128165 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 98.535 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 868 milliseconds) (per-host)
I0121 15:20:44.129825 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.869797s (batch_requests_ready=0.096157s, total_serialization_initiated=0.770905s, others=0.002735s)
I0121 15:20:44.146384 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.894158s (all_items=0.000036s, per_item={'default': '0.00003624'}, temp_paths=0.894122)
I0121 15:20:44.230897 140041879799360 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 15:20:44.231849 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.984583s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/59850.
I0121 15:20:44.238077 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=59850] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 15:20:44.239119 140040546014784 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 15:20:44.241867 140165176223552 standard_logger.py:34] {'step': Array(59850, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768980043.2445157, 'wait_for_prev_duration_secs': 0.0006124973297119141, 'time_between_consecutive_saves_sec': 326.9150900840759, 'checkpointer_blocking_start_time': 1768980043.2472095, 'checkpointer_blocking_duration_secs': 0.9904675483703613, 'get_old_steps_start_time': 1768980044.2377436, 'get_old_steps_duration_secs': 0.00019407272338867188, 'checkpoint_manager_blocking_start_time': 1768980043.2435749, 'checkpoint_manager_blocking_duration_secs': 0.9970364570617676}
I0121 15:20:44.255620 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/59850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 15:20:45.857042 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.728458s (commit=1.527678s, array_metadata_write=0.200781s)
I0121 15:20:45.860107 140041879799360 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 32.896 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 15:20:45.860505 140041879799360 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.627556s.
I0121 15:20:45.874416 140041879799360 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 15:20:46.094676 140041879799360 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.230915s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/59850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 15:20:46.096886 140041879799360 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/59850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/59850.orbax-checkpoint-tmp/default
I0121 15:20:46.101506 140041879799360 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/59850.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/59850
I0121 15:20:46.163202 140045092648512 checkpoint.py:188] Wrote Metadata={'item_handlers': {'default': 'orbax.checkpoint._src.handlers.standard_checkpoint_handler.StandardCheckpointHandler'}, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1768980043339044564, 'commit_timestamp_nsecs': 1768980046103205980, 'custom_metadata': {}}, json={"item_handlers": {"default": "orbax.checkpoint._src.handlers.standard_checkpoint_handler.StandardCheckpointHandler"}, "metrics": {}, "performance_metrics": {}, "init_timestamp_nsecs": 1768980043339044564, "commit_timestamp_nsecs": 1768980046103205980, "custom_metadata": {}} to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/59850.orbax-checkpoint-tmp/_CHECKPOINT_METADATA
I0121 15:20:46.167394 140041879799360 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/59850`.
I0121 15:20:46.169248 140041879799360 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.921992s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/59850
I0121 15:20:46.169786 140041879799360 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.936829s.
I0121 15:20:46.170519 140040546014784 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 15:20:46.171227 140040546014784 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 15:20:46.206912 140040546014784 deleter.py:273] Deleted step 58950.
I0121 15:20:46.207269 140040546014784 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=59850] CheckpointManager Save Finalize is syncing with other hosts...
I0121 15:20:46.207591 140040546014784 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=59850] CheckpointManager Save Finalize is done on all hosts.
step: 60300,  loss data: 7.993e-04, loss res: 7.121e-04, time: 1.733e+02
step: 60750,  loss data: 7.279e-04, loss res: 1.374e-03, time: 1.730e+02
I0121 15:26:30.614984 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 15:26:30.617122 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 60750
I0121 15:26:30.618562 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/60750.
I0121 15:26:30.658822 140039036048960 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/60750.orbax-checkpoint-tmp
I0121 15:26:30.780047 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 15:26:30.780272 140042156627520 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/60750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 15:26:30.780874 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 15:26:31.399958 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.622747s
I0121 15:26:31.424640 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 107.401 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 796 milliseconds) (per-host)
I0121 15:26:31.447119 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.818948s (batch_requests_ready=0.097889s, total_serialization_initiated=0.681084s, others=0.039975s)
I0121 15:26:31.498203 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.876801s (all_items=0.000034s, per_item={'default': '0.00003433'}, temp_paths=0.876767)
I0121 15:26:31.508337 140042257290816 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 15:26:31.508633 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.891024s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/60750.
I0121 15:26:31.511538 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=60750] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 15:26:31.513881 140041871406656 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 15:26:31.516707 140165176223552 standard_logger.py:34] {'step': Array(60750, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768980390.6148658, 'wait_for_prev_duration_secs': 0.0005941390991210938, 'time_between_consecutive_saves_sec': 344.4070670604706, 'checkpointer_blocking_start_time': 1768980390.6175513, 'checkpointer_blocking_duration_secs': 0.893563985824585, 'get_old_steps_start_time': 1768980391.5111876, 'get_old_steps_duration_secs': 0.00019288063049316406, 'checkpoint_manager_blocking_start_time': 1768980390.6139708, 'checkpoint_manager_blocking_duration_secs': 0.9008626937866211}
I0121 15:26:31.530189 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/60750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 15:26:35.068179 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 3.637671s (commit=3.491025s, array_metadata_write=0.146647s)
I0121 15:26:35.072154 140042257290816 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 19.247 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 4 seconds) (per-host)
I0121 15:26:35.072655 140042257290816 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 3.563418s.
I0121 15:26:35.084172 140042257290816 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 15:26:35.135869 140042257290816 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.060598s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/60750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 15:26:35.137960 140042257290816 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/60750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/60750.orbax-checkpoint-tmp/default
I0121 15:26:35.141389 140042257290816 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/60750.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/60750
I0121 15:26:35.220789 140042257290816 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/60750`.
I0121 15:26:35.222378 140042257290816 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 4.604787s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/60750
I0121 15:26:35.222846 140042257290816 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 3.713603s.
I0121 15:26:35.223613 140041871406656 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 15:26:35.224049 140041871406656 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 15:26:35.263161 140041871406656 deleter.py:273] Deleted step 59850.
I0121 15:26:35.263760 140041871406656 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=60750] CheckpointManager Save Finalize is syncing with other hosts...
I0121 15:26:35.264418 140041871406656 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=60750] CheckpointManager Save Finalize is done on all hosts.
step: 61200,  loss data: 7.348e-04, loss res: 5.955e-04, time: 1.725e+02
step: 61650,  loss data: 7.849e-04, loss res: 1.722e-03, time: 1.719e+02
I0121 15:32:15.895800 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 15:32:15.898774 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 61650
I0121 15:32:15.900836 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/61650.
I0121 15:32:15.917227 140040009143872 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/61650.orbax-checkpoint-tmp
I0121 15:32:16.033586 140038532748864 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/61650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 15:32:16.071735 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 15:32:16.072562 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 15:32:16.661015 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.592973s
I0121 15:32:16.673258 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 112.664 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 759 milliseconds) (per-host)
I0121 15:32:16.684967 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.771076s (batch_requests_ready=0.099075s, total_serialization_initiated=0.653952s, others=0.018049s)
I0121 15:32:16.702316 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.797357s (all_items=0.000091s, per_item={'default': '0.00009131'}, temp_paths=0.797266)
I0121 15:32:16.760434 140042139842112 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 15:32:16.761569 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.862219s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/61650.
I0121 15:32:16.768527 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=61650] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 15:32:16.769673 140042131449408 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 15:32:16.772961 140165176223552 standard_logger.py:34] {'step': Array(61650, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768980735.895542, 'wait_for_prev_duration_secs': 0.001066446304321289, 'time_between_consecutive_saves_sec': 340.6306221485138, 'checkpointer_blocking_start_time': 1768980735.8992653, 'checkpointer_blocking_duration_secs': 0.8687608242034912, 'get_old_steps_start_time': 1768980736.7680964, 'get_old_steps_duration_secs': 0.00028061866760253906, 'checkpoint_manager_blocking_start_time': 1768980735.8938947, 'checkpoint_manager_blocking_duration_secs': 0.8775310516357422}
I0121 15:32:16.813645 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/61650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 15:32:19.804873 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 3.125803s (commit=2.987245s, array_metadata_write=0.138558s)
I0121 15:32:19.808207 140042139842112 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 21.963 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 3 seconds) (per-host)
I0121 15:32:19.808586 140042139842112 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 3.046823s.
I0121 15:32:19.822585 140042139842112 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 15:32:19.935051 140042139842112 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.123487s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/61650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 15:32:19.937184 140042139842112 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/61650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/61650.orbax-checkpoint-tmp/default
I0121 15:32:19.941941 140042139842112 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/61650.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/61650
I0121 15:32:19.966955 140042139842112 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/61650`.
I0121 15:32:19.968282 140042139842112 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 4.068961s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/61650
I0121 15:32:19.968574 140042139842112 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 3.206813s.
I0121 15:32:19.969067 140042131449408 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 15:32:19.969634 140042131449408 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 15:32:20.022295 140042131449408 deleter.py:273] Deleted step 60750.
I0121 15:32:20.022894 140042131449408 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=61650] CheckpointManager Save Finalize is syncing with other hosts...
I0121 15:32:20.023818 140042131449408 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=61650] CheckpointManager Save Finalize is done on all hosts.
step: 62100,  loss data: 6.166e-04, loss res: 1.406e-03, time: 1.737e+02
step: 62550,  loss data: 1.301e-03, loss res: 3.748e-03, time: 1.733e+02
I0121 15:38:03.843227 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 15:38:03.845301 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 62550
I0121 15:38:03.851740 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/62550.
I0121 15:38:03.878293 140040025929280 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/62550.orbax-checkpoint-tmp
I0121 15:38:03.981600 140042165020224 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/62550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 15:38:04.022222 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 15:38:04.023758 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 15:38:04.576774 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.557159s
I0121 15:38:04.594125 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 117.148 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 730 milliseconds) (per-host)
I0121 15:38:04.610637 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.746747s (batch_requests_ready=0.101891s, total_serialization_initiated=0.617069s, others=0.027787s)
I0121 15:38:04.652005 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.795966s (all_items=0.000035s, per_item={'default': '0.00003529'}, temp_paths=0.795930)
I0121 15:38:04.680014 140042139842112 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 15:38:04.680344 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.834524s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/62550.
I0121 15:38:04.683143 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=62550] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 15:38:04.687527 140042257290816 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 15:38:04.690266 140165176223552 standard_logger.py:34] {'step': Array(62550, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768981083.8431122, 'wait_for_prev_duration_secs': 0.0006172657012939453, 'time_between_consecutive_saves_sec': 343.81886982917786, 'checkpointer_blocking_start_time': 1768981083.8457546, 'checkpointer_blocking_duration_secs': 0.8369498252868652, 'get_old_steps_start_time': 1768981084.682786, 'get_old_steps_duration_secs': 0.00020122528076171875, 'checkpoint_manager_blocking_start_time': 1768981083.842055, 'checkpoint_manager_blocking_duration_secs': 0.8469407558441162}
I0121 15:38:05.297285 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/62550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 15:38:15.566865 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 10.972031s (commit=9.776865s, array_metadata_write=1.195166s)
I0121 15:38:15.570518 140042139842112 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 7.306 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 11 seconds) (per-host)
I0121 15:38:15.571148 140042139842112 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 10.889972s.
I0121 15:38:15.593179 140042139842112 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 15:38:18.475371 140042139842112 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 2.895444s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/62550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 15:38:18.478133 140042139842112 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/62550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/62550.orbax-checkpoint-tmp/default
I0121 15:38:18.485200 140042139842112 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/62550.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/62550
I0121 15:38:18.514348 140042139842112 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/62550`.
I0121 15:38:18.515958 140042139842112 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 14.670161s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/62550
I0121 15:38:18.516441 140042139842112 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 13.835274s.
I0121 15:38:18.517407 140042257290816 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 15:38:18.518078 140042257290816 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 15:38:18.574712 140042257290816 deleter.py:273] Deleted step 61650.
I0121 15:38:18.575335 140042257290816 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=62550] CheckpointManager Save Finalize is syncing with other hosts...
I0121 15:38:18.576097 140042257290816 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=62550] CheckpointManager Save Finalize is done on all hosts.
step: 63000,  loss data: 5.675e-04, loss res: 1.061e-03, time: 1.731e+02
Epoch 140, getting batches from DataLoader...
step: 63450,  loss data: 9.144e-04, loss res: 8.680e-04, time: 1.732e+02
I0121 15:43:51.089853 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 15:43:51.092476 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 63450
I0121 15:43:51.094349 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/63450.
I0121 15:43:51.120542 140040546014784 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/63450.orbax-checkpoint-tmp
I0121 15:43:51.222386 140040017536576 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/63450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 15:43:51.264598 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 15:43:51.265358 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 15:43:51.930167 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.668948s
I0121 15:43:51.953046 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 101.007 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 846 milliseconds) (per-host)
I0121 15:43:51.959474 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.853379s (batch_requests_ready=0.100686s, total_serialization_initiated=0.729963s, others=0.022730s)
I0121 15:43:51.966775 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.868855s (all_items=0.000080s, per_item={'default': '0.00007963'}, temp_paths=0.868775)
I0121 15:43:52.035258 140042257290816 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 15:43:52.035582 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.942586s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/63450.
I0121 15:43:52.038287 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=63450] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 15:43:52.041945 140042148234816 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 15:43:52.047257 140165176223552 standard_logger.py:34] {'step': Array(63450, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768981431.089621, 'wait_for_prev_duration_secs': 0.0009210109710693359, 'time_between_consecutive_saves_sec': 332.51296758651733, 'checkpointer_blocking_start_time': 1768981431.0929132, 'checkpointer_blocking_duration_secs': 0.9448895454406738, 'get_old_steps_start_time': 1768981432.0378752, 'get_old_steps_duration_secs': 0.0002570152282714844, 'checkpoint_manager_blocking_start_time': 1768981431.08824, 'checkpoint_manager_blocking_duration_secs': 0.9550333023071289}
I0121 15:43:52.459357 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/63450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 15:44:02.418044 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 10.464617s (commit=10.200673s, array_metadata_write=0.263944s)
I0121 15:44:02.424288 140042257290816 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 7.557 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 11 seconds) (per-host)
I0121 15:44:02.425077 140042257290816 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 10.388967s.
I0121 15:44:02.442236 140042257290816 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 15:44:02.553456 140042257290816 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.124025s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/63450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 15:44:02.555690 140042257290816 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/63450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/63450.orbax-checkpoint-tmp/default
I0121 15:44:02.560936 140042257290816 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/63450.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/63450
I0121 15:44:03.417807 140042257290816 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/63450`.
I0121 15:44:03.419534 140042257290816 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 12.326560s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/63450
I0121 15:44:03.420011 140042257290816 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 11.383895s.
I0121 15:44:03.420808 140042148234816 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 15:44:03.421397 140042148234816 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 15:44:03.476367 140042148234816 deleter.py:273] Deleted step 62550.
I0121 15:44:03.476941 140042148234816 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=63450] CheckpointManager Save Finalize is syncing with other hosts...
I0121 15:44:03.477669 140042148234816 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=63450] CheckpointManager Save Finalize is done on all hosts.
step: 63900,  loss data: 7.167e-04, loss res: 4.373e-04, time: 1.731e+02
step: 64350,  loss data: 1.209e-03, loss res: 5.884e-04, time: 1.733e+02
I0121 15:49:38.490037 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 15:49:38.492116 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 64350
I0121 15:49:38.493621 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/64350.
I0121 15:49:39.168232 140038524356160 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/64350.orbax-checkpoint-tmp
I0121 15:49:39.212887 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 15:49:39.213507 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 15:49:39.233759 140040554407488 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/64350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 15:49:39.765760 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.555478s
I0121 15:49:39.768739 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 133.805 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 639 milliseconds) (per-host)
I0121 15:49:39.792177 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.662733s (batch_requests_ready=0.047467s, total_serialization_initiated=0.590205s, others=0.025061s)
I0121 15:49:39.793922 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 1.296159s (all_items=0.000046s, per_item={'default': '0.00004649'}, temp_paths=1.296113)
I0121 15:49:39.877327 140042148234816 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 15:49:39.879763 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 1.387147s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/64350.
I0121 15:49:39.881033 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=64350] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 15:49:39.887901 140165176223552 standard_logger.py:34] {'step': Array(64350, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768981778.4899266, 'wait_for_prev_duration_secs': 0.0006461143493652344, 'time_between_consecutive_saves_sec': 335.0118889808655, 'checkpointer_blocking_start_time': 1768981778.4925559, 'checkpointer_blocking_duration_secs': 1.38804030418396, 'get_old_steps_start_time': 1768981779.8806708, 'get_old_steps_duration_secs': 0.00021386146545410156, 'checkpoint_manager_blocking_start_time': 1768981778.4889667, 'checkpoint_manager_blocking_duration_secs': 1.3976085186004639}
I0121 15:49:39.892395 140042139842112 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 15:49:39.937794 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/64350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 15:49:49.484933 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 9.715313s (commit=8.812098s, array_metadata_write=0.903215s)
I0121 15:49:49.489037 140042148234816 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 8.256 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 10 seconds) (per-host)
I0121 15:49:49.489478 140042148234816 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 9.610685s.
I0121 15:49:49.508609 140042148234816 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 15:49:49.597488 140042148234816 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.101888s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/64350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 15:49:49.599746 140042148234816 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/64350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/64350.orbax-checkpoint-tmp/default
I0121 15:49:49.605154 140042148234816 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/64350.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/64350
I0121 15:49:49.837354 140042148234816 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/64350`.
I0121 15:49:49.839382 140042148234816 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 11.346776s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/64350
I0121 15:49:49.839930 140042148234816 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 9.961128s.
I0121 15:49:49.840952 140042139842112 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 15:49:49.841461 140042139842112 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 15:49:49.893614 140042139842112 deleter.py:273] Deleted step 63450.
I0121 15:49:49.894183 140042139842112 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=64350] CheckpointManager Save Finalize is syncing with other hosts...
I0121 15:49:49.894848 140042139842112 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=64350] CheckpointManager Save Finalize is done on all hosts.
step: 64800,  loss data: 5.652e-04, loss res: 7.626e-04, time: 1.730e+02
step: 65250,  loss data: 8.228e-04, loss res: 7.238e-04, time: 1.730e+02
I0121 15:55:25.883504 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 15:55:25.886456 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 65250
I0121 15:55:25.888632 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/65250.
I0121 15:55:25.915233 140040537622080 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/65250.orbax-checkpoint-tmp
I0121 15:55:26.012545 140039061227072 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/65250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 15:55:26.053294 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 15:55:26.054767 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 15:55:26.628401 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.577769s
I0121 15:55:26.646571 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 114.815 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 744 milliseconds) (per-host)
I0121 15:55:26.673417 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.771988s (batch_requests_ready=0.095746s, total_serialization_initiated=0.637415s, others=0.038827s)
I0121 15:55:26.730436 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.837728s (all_items=0.000090s, per_item={'default': '0.00008965'}, temp_paths=0.837639)
I0121 15:55:26.736032 140042148234816 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 15:55:26.737192 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.850117s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/65250.
I0121 15:55:26.743257 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=65250] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 15:55:26.745282 140042173412928 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 15:55:26.748961 140165176223552 standard_logger.py:34] {'step': Array(65250, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768982125.8832524, 'wait_for_prev_duration_secs': 0.000988006591796875, 'time_between_consecutive_saves_sec': 335.9879035949707, 'checkpointer_blocking_start_time': 1768982125.8869863, 'checkpointer_blocking_duration_secs': 0.8557524681091309, 'get_old_steps_start_time': 1768982126.7428153, 'get_old_steps_duration_secs': 0.00027823448181152344, 'checkpoint_manager_blocking_start_time': 1768982125.8816464, 'checkpoint_manager_blocking_duration_secs': 0.8647127151489258}
I0121 15:55:26.812296 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/65250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 15:55:31.476826 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 4.777617s (commit=4.645770s, array_metadata_write=0.131847s)
I0121 15:55:31.480786 140042148234816 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 15.330 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 5 seconds) (per-host)
I0121 15:55:31.481209 140042148234816 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 4.744225s.
I0121 15:55:31.493018 140042148234816 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 15:55:32.135727 140042148234816 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.651337s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/65250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 15:55:32.138404 140042148234816 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/65250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/65250.orbax-checkpoint-tmp/default
I0121 15:55:32.142945 140042148234816 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/65250.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/65250
I0121 15:55:32.328728 140042148234816 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/65250`.
I0121 15:55:32.330653 140042148234816 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 6.443595s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/65250
I0121 15:55:32.331159 140042148234816 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 5.594167s.
I0121 15:55:32.331844 140042173412928 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 15:55:32.332472 140042173412928 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 15:55:32.387528 140042173412928 deleter.py:273] Deleted step 64350.
I0121 15:55:32.387902 140042173412928 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=65250] CheckpointManager Save Finalize is syncing with other hosts...
I0121 15:55:32.388241 140042173412928 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=65250] CheckpointManager Save Finalize is done on all hosts.
step: 65700,  loss data: 7.584e-04, loss res: 6.518e-04, time: 1.731e+02
step: 66150,  loss data: 1.069e-03, loss res: 4.526e-04, time: 1.720e+02
I0121 16:01:11.862973 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 16:01:11.865241 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 66150
I0121 16:01:11.866805 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/66150.
I0121 16:01:11.893274 140040529229376 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/66150.orbax-checkpoint-tmp
I0121 16:01:12.000465 140040025929280 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/66150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 16:01:12.039297 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 16:01:12.040780 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 16:01:12.661647 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.624857s
I0121 16:01:12.689465 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 105.510 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 810 milliseconds) (per-host)
I0121 16:01:12.701153 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.822440s (batch_requests_ready=0.100996s, total_serialization_initiated=0.687949s, others=0.033494s)
I0121 16:01:12.752460 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.881644s (all_items=0.000035s, per_item={'default': '0.00003457'}, temp_paths=0.881610)
I0121 16:01:12.763727 140042156627520 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 16:01:12.763974 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.898201s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/66150.
I0121 16:01:12.766079 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=66150] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 16:01:12.770885 140042265683520 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 16:01:12.772873 140165176223552 standard_logger.py:34] {'step': Array(66150, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768982471.862839, 'wait_for_prev_duration_secs': 0.0006597042083740234, 'time_between_consecutive_saves_sec': 339.47438168525696, 'checkpointer_blocking_start_time': 1768982471.8657062, 'checkpointer_blocking_duration_secs': 0.8999197483062744, 'get_old_steps_start_time': 1768982472.7657, 'get_old_steps_duration_secs': 0.00021266937255859375, 'checkpoint_manager_blocking_start_time': 1768982471.8618653, 'checkpoint_manager_blocking_duration_secs': 0.9100282192230225}
I0121 16:01:12.856929 140042274076224 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/66150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 16:01:15.087877 140042257290816 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 2.380976s (commit=2.238210s, array_metadata_write=0.142766s)
I0121 16:01:15.092061 140042156627520 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 26.619 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 3 seconds) (per-host)
I0121 16:01:15.093303 140042156627520 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 2.328850s.
I0121 16:01:15.119173 140042156627520 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 16:01:15.198866 140042156627520 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.098909s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/66150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 16:01:15.201182 140042156627520 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/66150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/66150.orbax-checkpoint-tmp/default
I0121 16:01:15.212065 140042156627520 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/66150.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/66150
I0121 16:01:15.275562 140042156627520 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/66150`.
I0121 16:01:15.277863 140042156627520 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 3.412109s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/66150
I0121 16:01:15.278421 140042156627520 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 2.513970s.
I0121 16:01:15.279347 140042265683520 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 16:01:15.280732 140042265683520 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 16:01:15.338145 140042265683520 deleter.py:273] Deleted step 65250.
I0121 16:01:15.338612 140042265683520 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=66150] CheckpointManager Save Finalize is syncing with other hosts...
I0121 16:01:15.339023 140042265683520 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=66150] CheckpointManager Save Finalize is done on all hosts.
step: 66600,  loss data: 7.539e-04, loss res: 5.969e-04, time: 1.732e+02
step: 67050,  loss data: 1.140e-03, loss res: 8.234e-04, time: 1.732e+02
I0121 16:06:59.209230 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 16:06:59.212179 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 67050
I0121 16:06:59.214280 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/67050.
I0121 16:06:59.235444 140039086405184 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/67050.orbax-checkpoint-tmp
I0121 16:06:59.341797 140039036048960 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/67050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 16:06:59.386089 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 16:06:59.387548 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 16:06:59.946447 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.563237s
I0121 16:06:59.949151 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 118.343 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 722 milliseconds) (per-host)
I0121 16:06:59.971983 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.745761s (batch_requests_ready=0.100168s, total_serialization_initiated=0.621465s, others=0.024129s)
I0121 16:06:59.977971 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.759812s (all_items=0.000098s, per_item={'default': '0.00009751'}, temp_paths=0.759714)
I0121 16:07:00.052096 140042257290816 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 16:07:00.052609 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.839822s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/67050.
I0121 16:07:00.056379 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=67050] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 16:07:00.061485 140042131449408 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 16:07:00.063580 140165176223552 standard_logger.py:34] {'step': Array(67050, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768982819.208975, 'wait_for_prev_duration_secs': 0.0010542869567871094, 'time_between_consecutive_saves_sec': 343.86969089508057, 'checkpointer_blocking_start_time': 1768982819.2126853, 'checkpointer_blocking_duration_secs': 0.8431491851806641, 'get_old_steps_start_time': 1768982820.055923, 'get_old_steps_duration_secs': 0.00030040740966796875, 'checkpoint_manager_blocking_start_time': 1768982819.2071567, 'checkpoint_manager_blocking_duration_secs': 0.8547806739807129}
I0121 16:07:00.108382 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/67050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 16:07:01.931169 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.965322s (commit=1.753685s, array_metadata_write=0.211637s)
I0121 16:07:01.934813 140042257290816 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 31.579 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 16:07:01.935413 140042257290816 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.881470s.
I0121 16:07:01.950337 140042257290816 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 16:07:02.069358 140042257290816 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.129976s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/67050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 16:07:02.071706 140042257290816 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/67050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/67050.orbax-checkpoint-tmp/default
I0121 16:07:02.077141 140042257290816 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/67050.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/67050
I0121 16:07:02.149606 140042257290816 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/67050`.
I0121 16:07:02.151262 140042257290816 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.938504s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/67050
I0121 16:07:02.151758 140042257290816 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 2.097817s.
I0121 16:07:02.152689 140042131449408 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 16:07:02.153182 140042131449408 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 16:07:02.181977 140042131449408 deleter.py:273] Deleted step 66150.
I0121 16:07:02.182343 140042131449408 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=67050] CheckpointManager Save Finalize is syncing with other hosts...
I0121 16:07:02.182667 140042131449408 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=67050] CheckpointManager Save Finalize is done on all hosts.
step: 67500,  loss data: 8.789e-04, loss res: 9.458e-04, time: 1.726e+02
Epoch 150, getting batches from DataLoader...
step: 67950,  loss data: 1.220e-03, loss res: 1.449e-03, time: 1.726e+02
I0121 16:12:45.250400 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 16:12:45.252960 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 67950
I0121 16:12:45.254549 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/67950.
I0121 16:12:45.291197 140043767756352 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/67950.orbax-checkpoint-tmp
I0121 16:12:45.383162 140039078012480 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/67950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 16:12:45.423998 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 16:12:45.425361 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 16:12:45.998109 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.576556s
I0121 16:12:46.032094 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 111.765 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 765 milliseconds) (per-host)
I0121 16:12:46.095750 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.829021s (batch_requests_ready=0.100895s, total_serialization_initiated=0.647164s, others=0.080962s)
I0121 16:12:46.096985 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.838481s (all_items=0.000036s, per_item={'default': '0.00003600'}, temp_paths=0.838445)
I0121 16:12:46.103440 140041871406656 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 16:12:46.108050 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.854555s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/67950.
I0121 16:12:46.110290 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=67950] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 16:12:46.112045 140042165020224 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 16:12:46.114736 140165176223552 standard_logger.py:34] {'step': Array(67950, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768983165.2502718, 'wait_for_prev_duration_secs': 0.0006592273712158203, 'time_between_consecutive_saves_sec': 343.0674023628235, 'checkpointer_blocking_start_time': 1768983165.253437, 'checkpointer_blocking_duration_secs': 0.8564169406890869, 'get_old_steps_start_time': 1768983166.1099212, 'get_old_steps_duration_secs': 0.00020360946655273438, 'checkpoint_manager_blocking_start_time': 1768983165.2491326, 'checkpoint_manager_blocking_duration_secs': 0.8645820617675781}
I0121 16:12:46.171711 140042274076224 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/67950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 16:12:51.189040 140042265683520 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 5.156530s (commit=4.730964s, array_metadata_write=0.425566s)
I0121 16:12:51.192361 140041871406656 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 14.434 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 5 seconds) (per-host)
I0121 16:12:51.192977 140041871406656 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 5.085150s.
I0121 16:12:51.210563 140041871406656 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 16:12:51.494498 140041871406656 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.295844s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/67950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 16:12:51.496740 140041871406656 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/67950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/67950.orbax-checkpoint-tmp/default
I0121 16:12:51.502106 140041871406656 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/67950.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/67950
I0121 16:12:51.517431 140041871406656 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/67950`.
I0121 16:12:51.518953 140041871406656 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 6.265472s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/67950
I0121 16:12:51.519421 140041871406656 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 5.411600s.
I0121 16:12:51.520071 140042165020224 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 16:12:51.520623 140042165020224 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 16:12:51.569203 140042165020224 deleter.py:273] Deleted step 67050.
I0121 16:12:51.569567 140042165020224 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=67950] CheckpointManager Save Finalize is syncing with other hosts...
I0121 16:12:51.570055 140042165020224 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=67950] CheckpointManager Save Finalize is done on all hosts.
step: 68400,  loss data: 5.466e-04, loss res: 8.697e-04, time: 1.728e+02
step: 68850,  loss data: 9.268e-04, loss res: 1.929e-03, time: 1.730e+02
I0121 16:18:31.948844 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 16:18:31.951781 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 68850
I0121 16:18:31.953849 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/68850.
I0121 16:18:31.996681 140040546014784 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/68850.orbax-checkpoint-tmp
I0121 16:18:32.082519 140039069619776 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/68850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 16:18:32.124204 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 16:18:32.125813 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 16:18:33.299185 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 1.177736s
I0121 16:18:33.327908 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 62.925 MiB/s (total gbytes: 85.5 MiB) (time elapsed: a second) (per-host)
I0121 16:18:33.339365 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 1.370814s (batch_requests_ready=0.098381s, total_serialization_initiated=1.244111s, others=0.028321s)
I0121 16:18:33.356255 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 1.398033s (all_items=0.000090s, per_item={'default': '0.00009012'}, temp_paths=1.397943)
I0121 16:18:33.414875 140042173412928 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 16:18:33.415705 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 1.463336s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/68850.
I0121 16:18:33.416977 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=68850] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 16:18:33.419336 140041871406656 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 16:18:33.421791 140165176223552 standard_logger.py:34] {'step': Array(68850, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768983511.9485903, 'wait_for_prev_duration_secs': 0.0010395050048828125, 'time_between_consecutive_saves_sec': 340.378301858902, 'checkpointer_blocking_start_time': 1768983511.9522693, 'checkpointer_blocking_duration_secs': 1.464264154434204, 'get_old_steps_start_time': 1768983513.416626, 'get_old_steps_duration_secs': 0.0001995563507080078, 'checkpoint_manager_blocking_start_time': 1768983511.9467661, 'checkpoint_manager_blocking_duration_secs': 1.473646640777588}
I0121 16:18:33.444433 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/68850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 16:18:40.352785 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 7.019088s (commit=6.893848s, array_metadata_write=0.125240s)
I0121 16:18:40.356241 140042173412928 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 10.197 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 8 seconds) (per-host)
I0121 16:18:40.356750 140042173412928 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 6.941181s.
I0121 16:18:40.374092 140042173412928 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 16:18:40.716587 140042173412928 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.356606s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/68850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 16:18:40.718991 140042173412928 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/68850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/68850.orbax-checkpoint-tmp/default
I0121 16:18:40.724526 140042173412928 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/68850.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/68850
I0121 16:18:40.786882 140042173412928 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/68850`.
I0121 16:18:40.788632 140042173412928 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 8.836293s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/68850
I0121 16:18:40.789121 140042173412928 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 7.373545s.
I0121 16:18:40.790055 140041871406656 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 16:18:40.790536 140041871406656 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 16:18:40.838200 140041871406656 deleter.py:273] Deleted step 67950.
I0121 16:18:40.838752 140041871406656 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=68850] CheckpointManager Save Finalize is syncing with other hosts...
I0121 16:18:40.839392 140041871406656 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=68850] CheckpointManager Save Finalize is done on all hosts.
step: 69300,  loss data: 8.693e-04, loss res: 3.383e-04, time: 1.725e+02
step: 69750,  loss data: 8.445e-04, loss res: 1.428e-03, time: 1.720e+02
I0121 16:24:17.919290 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 16:24:17.921228 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 69750
I0121 16:24:17.922716 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/69750.
I0121 16:24:17.955209 140040512443968 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/69750.orbax-checkpoint-tmp
I0121 16:24:18.063036 140040529229376 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/69750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 16:24:18.096153 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 16:24:18.096783 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 16:24:18.712595 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.619166s
I0121 16:24:18.785741 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 100.310 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 852 milliseconds) (per-host)
I0121 16:24:18.786445 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.853467s (batch_requests_ready=0.109505s, total_serialization_initiated=0.741508s, others=0.002454s)
I0121 16:24:18.787808 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.861773s (all_items=0.000034s, per_item={'default': '0.00003386'}, temp_paths=0.861739)
I0121 16:24:18.796433 140042148234816 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 16:24:18.797321 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.875578s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/69750.
I0121 16:24:18.799756 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=69750] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 16:24:18.800970 140042257290816 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 16:24:18.804228 140165176223552 standard_logger.py:34] {'step': Array(69750, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768983857.9191735, 'wait_for_prev_duration_secs': 0.0006067752838134766, 'time_between_consecutive_saves_sec': 337.0792853832245, 'checkpointer_blocking_start_time': 1768983857.921689, 'checkpointer_blocking_duration_secs': 0.8776421546936035, 'get_old_steps_start_time': 1768983858.7994053, 'get_old_steps_duration_secs': 0.00020432472229003906, 'checkpoint_manager_blocking_start_time': 1768983857.9182456, 'checkpoint_manager_blocking_duration_secs': 0.8842983245849609}
I0121 16:24:19.047996 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/69750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 16:24:26.860379 140042165020224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 8.073443s (commit=7.413396s, array_metadata_write=0.660046s)
I0121 16:24:26.864712 140042148234816 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 9.576 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 8 seconds) (per-host)
I0121 16:24:26.865241 140042148234816 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 8.067462s.
I0121 16:24:26.884073 140042148234816 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 16:24:27.319946 140042148234816 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.447364s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/69750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 16:24:27.322555 140042148234816 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/69750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/69750.orbax-checkpoint-tmp/default
I0121 16:24:27.327894 140042148234816 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/69750.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/69750
I0121 16:24:27.342985 140042148234816 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/69750`.
I0121 16:24:27.344515 140042148234816 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 9.422784s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/69750
I0121 16:24:27.344988 140042148234816 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 8.547206s.
I0121 16:24:27.345751 140042257290816 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 16:24:27.346398 140042257290816 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 16:24:27.394726 140042257290816 deleter.py:273] Deleted step 68850.
I0121 16:24:27.395463 140042257290816 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=69750] CheckpointManager Save Finalize is syncing with other hosts...
I0121 16:24:27.396352 140042257290816 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=69750] CheckpointManager Save Finalize is done on all hosts.
step: 70200,  loss data: 6.580e-04, loss res: 3.204e-03, time: 1.718e+02
step: 70650,  loss data: 9.050e-04, loss res: 7.207e-04, time: 1.709e+02
I0121 16:30:01.539442 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 16:30:01.542385 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 70650
I0121 16:30:01.544465 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/70650.
I0121 16:30:01.589206 140040025929280 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/70650.orbax-checkpoint-tmp
I0121 16:30:01.671507 140039061227072 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/70650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 16:30:01.715125 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 16:30:01.715858 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 16:30:02.351413 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.639159s
I0121 16:30:02.373978 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 105.063 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 814 milliseconds) (per-host)
I0121 16:30:02.390383 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.830695s (batch_requests_ready=0.095257s, total_serialization_initiated=0.707590s, others=0.027848s)
I0121 16:30:02.396275 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.845230s (all_items=0.000090s, per_item={'default': '0.00008988'}, temp_paths=0.845140)
I0121 16:30:02.452936 140040025929280 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 16:30:02.453397 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.910432s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/70650.
I0121 16:30:02.455165 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=70650] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 16:30:02.456685 140042131449408 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 16:30:02.461640 140165176223552 standard_logger.py:34] {'step': Array(70650, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768984201.5391812, 'wait_for_prev_duration_secs': 0.0010418891906738281, 'time_between_consecutive_saves_sec': 334.1423783302307, 'checkpointer_blocking_start_time': 1768984201.542873, 'checkpointer_blocking_duration_secs': 0.9117844104766846, 'get_old_steps_start_time': 1768984202.4547346, 'get_old_steps_duration_secs': 0.0002818107604980469, 'checkpoint_manager_blocking_start_time': 1768984201.5375574, 'checkpoint_manager_blocking_duration_secs': 0.9200031757354736}
I0121 16:30:02.486532 140043767756352 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/70650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 16:30:06.519692 140042265683520 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 4.140203s (commit=3.973346s, array_metadata_write=0.166857s)
I0121 16:30:06.523972 140040025929280 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 17.229 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 4 seconds) (per-host)
I0121 16:30:06.524445 140040025929280 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 4.070528s.
I0121 16:30:06.546794 140040025929280 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 16:30:07.059002 140040025929280 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.528240s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/70650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 16:30:07.061660 140040025929280 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/70650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/70650.orbax-checkpoint-tmp/default
I0121 16:30:07.073077 140040025929280 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/70650.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/70650
I0121 16:30:07.110002 140040025929280 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/70650`.
I0121 16:30:07.111625 140040025929280 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 5.568684s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/70650
I0121 16:30:07.112122 140040025929280 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 4.658198s.
I0121 16:30:07.113098 140042131449408 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 16:30:07.113607 140042131449408 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 16:30:07.290752 140042131449408 deleter.py:273] Deleted step 69750.
I0121 16:30:07.291454 140042131449408 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=70650] CheckpointManager Save Finalize is syncing with other hosts...
I0121 16:30:07.292175 140042131449408 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=70650] CheckpointManager Save Finalize is done on all hosts.
step: 71100,  loss data: 7.943e-04, loss res: 7.151e-04, time: 1.739e+02
step: 71550,  loss data: 7.121e-04, loss res: 4.589e-04, time: 1.736e+02
I0121 16:35:50.007744 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 16:35:50.009984 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 71550
I0121 16:35:50.011917 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/71550.
I0121 16:35:50.031816 140042156627520 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/71550.orbax-checkpoint-tmp
I0121 16:35:50.133918 140039975573056 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/71550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 16:35:50.189402 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 16:35:50.191186 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 16:35:50.777245 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.590482s
I0121 16:35:50.791096 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 112.582 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 759 milliseconds) (per-host)
I0121 16:35:50.803071 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.771903s (batch_requests_ready=0.103879s, total_serialization_initiated=0.649357s, others=0.018667s)
I0121 16:35:50.830183 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.813663s (all_items=0.000092s, per_item={'default': '0.00009227'}, temp_paths=0.813570)
I0121 16:35:50.888442 140041871406656 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 16:35:50.888899 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.878427s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/71550.
I0121 16:35:50.894833 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=71550] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 16:35:50.896656 140040546014784 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 16:35:50.900423 140165176223552 standard_logger.py:34] {'step': Array(71550, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768984550.0075343, 'wait_for_prev_duration_secs': 0.0008180141448974609, 'time_between_consecutive_saves_sec': 342.7148332595825, 'checkpointer_blocking_start_time': 1768984550.0103924, 'checkpointer_blocking_duration_secs': 0.8839414119720459, 'get_old_steps_start_time': 1768984550.894409, 'get_old_steps_duration_secs': 0.0002560615539550781, 'checkpoint_manager_blocking_start_time': 1768984550.0061336, 'checkpoint_manager_blocking_duration_secs': 0.8921606540679932}
I0121 16:35:50.970785 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/71550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 16:35:57.402459 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 6.605546s (commit=6.276945s, array_metadata_write=0.328601s)
I0121 16:35:57.407263 140041871406656 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 11.596 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 7 seconds) (per-host)
I0121 16:35:57.407771 140041871406656 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 6.517733s.
I0121 16:35:57.421649 140041871406656 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 16:35:57.519333 140041871406656 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.108083s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/71550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 16:35:57.521471 140041871406656 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/71550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/71550.orbax-checkpoint-tmp/default
I0121 16:35:57.526777 140041871406656 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/71550.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/71550
I0121 16:35:57.687902 140041871406656 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/71550`.
I0121 16:35:57.689534 140041871406656 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 7.679082s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/71550
I0121 16:35:57.690018 140041871406656 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 6.799976s.
I0121 16:35:57.690988 140040546014784 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 16:35:57.691476 140040546014784 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 16:35:57.742606 140040546014784 deleter.py:273] Deleted step 70650.
I0121 16:35:57.743146 140040546014784 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=71550] CheckpointManager Save Finalize is syncing with other hosts...
I0121 16:35:57.743739 140040546014784 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=71550] CheckpointManager Save Finalize is done on all hosts.
step: 72000,  loss data: 9.316e-04, loss res: 9.541e-04, time: 1.735e+02
Epoch 160, getting batches from DataLoader...
step: 72450,  loss data: 7.665e-04, loss res: 1.139e-03, time: 1.736e+02
I0121 16:41:38.050420 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 16:41:38.052747 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 72450
I0121 16:41:38.054289 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/72450.
I0121 16:41:38.081032 140040000751168 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/72450.orbax-checkpoint-tmp
I0121 16:41:38.197592 140039044441664 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/72450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 16:41:38.226570 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 16:41:38.229102 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 16:41:38.807710 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.583821s
I0121 16:41:38.826689 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 112.630 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 759 milliseconds) (per-host)
I0121 16:41:38.854142 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.786962s (batch_requests_ready=0.104729s, total_serialization_initiated=0.642950s, others=0.039282s)
I0121 16:41:38.860099 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.801567s (all_items=0.000044s, per_item={'default': '0.00004411'}, temp_paths=0.801523)
I0121 16:41:38.916401 140042156627520 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 16:41:38.916880 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.863622s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/72450.
I0121 16:41:38.919471 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=72450] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 16:41:38.920329 140042257290816 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 16:41:38.926912 140165176223552 standard_logger.py:34] {'step': Array(72450, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768984898.0503047, 'wait_for_prev_duration_secs': 0.0006461143493652344, 'time_between_consecutive_saves_sec': 340.30609250068665, 'checkpointer_blocking_start_time': 1768984898.0532014, 'checkpointer_blocking_duration_secs': 0.865821361541748, 'get_old_steps_start_time': 1768984898.919098, 'get_old_steps_duration_secs': 0.0002243518829345703, 'checkpoint_manager_blocking_start_time': 1768984898.0492318, 'checkpoint_manager_blocking_duration_secs': 0.8764963150024414}
I0121 16:41:38.943567 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/72450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 16:41:45.489429 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 6.663230s (commit=6.477697s, array_metadata_write=0.185533s)
I0121 16:41:45.492680 140042156627520 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 11.519 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 7 seconds) (per-host)
I0121 16:41:45.493097 140042156627520 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 6.575711s.
I0121 16:41:45.505256 140042156627520 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 16:41:45.641856 140042156627520 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.145767s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/72450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 16:41:45.644099 140042156627520 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/72450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/72450.orbax-checkpoint-tmp/default
I0121 16:41:45.648685 140042156627520 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/72450.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/72450
I0121 16:41:45.665639 140042156627520 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/72450`.
I0121 16:41:45.667196 140042156627520 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 7.613955s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/72450
I0121 16:41:45.667665 140042156627520 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 6.750272s.
I0121 16:41:45.668617 140042257290816 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 16:41:45.669112 140042257290816 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 16:41:45.728348 140042257290816 deleter.py:273] Deleted step 71550.
I0121 16:41:45.728705 140042257290816 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=72450] CheckpointManager Save Finalize is syncing with other hosts...
I0121 16:41:45.729031 140042257290816 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=72450] CheckpointManager Save Finalize is done on all hosts.
step: 72900,  loss data: 1.113e-03, loss res: 6.288e-04, time: 1.722e+02
step: 73350,  loss data: 6.341e-04, loss res: 1.940e-03, time: 1.726e+02
I0121 16:47:23.800249 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 16:47:23.803202 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 73350
I0121 16:47:23.805324 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/73350.
I0121 16:47:23.827115 140040554407488 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/73350.orbax-checkpoint-tmp
I0121 16:47:23.941931 140039975573056 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/73350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 16:47:23.971835 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 16:47:23.972975 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 16:47:24.526202 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.557177s
I0121 16:47:24.559428 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 115.616 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 739 milliseconds) (per-host)
I0121 16:47:24.570843 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.751404s (batch_requests_ready=0.096267s, total_serialization_initiated=0.632205s, others=0.022932s)
I0121 16:47:25.333441 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 1.524044s (all_items=0.000087s, per_item={'default': '0.00008750'}, temp_paths=1.523956)
I0121 16:47:25.386184 140032140621376 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 16:47:25.386459 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 1.582662s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/73350.
I0121 16:47:25.396369 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=73350] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 16:47:25.397407 140042173412928 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 16:47:25.410048 140165176223552 standard_logger.py:34] {'step': Array(73350, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768985243.7999852, 'wait_for_prev_duration_secs': 0.0010585784912109375, 'time_between_consecutive_saves_sec': 338.0707561969757, 'checkpointer_blocking_start_time': 1768985243.803718, 'checkpointer_blocking_duration_secs': 1.5923364162445068, 'get_old_steps_start_time': 1768985245.3961227, 'get_old_steps_duration_secs': 0.00014090538024902344, 'checkpoint_manager_blocking_start_time': 1768985243.798396, 'checkpoint_manager_blocking_duration_secs': 1.6084325313568115}
I0121 16:47:25.926853 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/73350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 16:47:27.082007 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 2.522175s (commit=2.401092s, array_metadata_write=0.121083s)
I0121 16:47:27.085191 140032140621376 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 26.191 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 3 seconds) (per-host)
I0121 16:47:27.085734 140032140621376 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.694788s.
I0121 16:47:27.098407 140032140621376 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 16:47:27.214059 140032140621376 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.125084s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/73350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 16:47:27.217397 140032140621376 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/73350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/73350.orbax-checkpoint-tmp/default
I0121 16:47:27.223508 140032140621376 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/73350.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/73350
I0121 16:47:27.241472 140032140621376 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/73350`.
I0121 16:47:27.242867 140032140621376 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 3.439092s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/73350
I0121 16:47:27.243170 140032140621376 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.852230s.
I0121 16:47:27.243741 140042173412928 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 16:47:27.244405 140042173412928 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 16:47:27.294588 140042173412928 deleter.py:273] Deleted step 72450.
I0121 16:47:27.294947 140042173412928 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=73350] CheckpointManager Save Finalize is syncing with other hosts...
I0121 16:47:27.295278 140042173412928 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=73350] CheckpointManager Save Finalize is done on all hosts.
step: 73800,  loss data: 7.123e-04, loss res: 1.311e-03, time: 1.734e+02
step: 74250,  loss data: 9.968e-04, loss res: 1.030e-03, time: 1.735e+02
I0121 16:53:12.302839 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 16:53:12.304879 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 74250
I0121 16:53:12.306324 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/74250.
I0121 16:53:12.342611 140034279712320 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/74250.orbax-checkpoint-tmp
I0121 16:53:12.448837 140035361846848 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/74250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 16:53:12.503349 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 16:53:12.504192 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 16:53:13.096750 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.596157s
I0121 16:53:13.124963 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 106.000 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 806 milliseconds) (per-host)
I0121 16:53:13.185008 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.867036s (batch_requests_ready=0.115417s, total_serialization_initiated=0.674779s, others=0.076840s)
I0121 16:53:13.192626 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.882528s (all_items=0.000036s, per_item={'default': '0.00003600'}, temp_paths=0.882492)
I0121 16:53:13.197495 140042139842112 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 16:53:13.200507 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.895131s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/74250.
I0121 16:53:13.206738 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=74250] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 16:53:13.208306 140042257290816 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 16:53:13.210560 140165176223552 standard_logger.py:34] {'step': Array(74250, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768985592.302714, 'wait_for_prev_duration_secs': 0.0006208419799804688, 'time_between_consecutive_saves_sec': 345.0072293281555, 'checkpointer_blocking_start_time': 1768985592.305319, 'checkpointer_blocking_duration_secs': 0.9010064601898193, 'get_old_steps_start_time': 1768985593.2063973, 'get_old_steps_duration_secs': 0.0001990795135498047, 'checkpoint_manager_blocking_start_time': 1768985592.3017642, 'checkpoint_manager_blocking_duration_secs': 0.9074618816375732}
I0121 16:53:13.223569 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/74250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 16:53:19.874205 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 6.749650s (commit=6.569208s, array_metadata_write=0.180442s)
I0121 16:53:19.877463 140042139842112 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 11.314 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 7 seconds) (per-host)
I0121 16:53:19.877933 140042139842112 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 6.673493s.
I0121 16:53:19.891319 140042139842112 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 16:53:20.250678 140042139842112 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.369678s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/74250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 16:53:20.253524 140042139842112 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/74250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/74250.orbax-checkpoint-tmp/default
I0121 16:53:20.259227 140042139842112 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/74250.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/74250
I0121 16:53:20.276607 140042139842112 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/74250`.
I0121 16:53:20.278337 140042139842112 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 7.972969s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/74250
I0121 16:53:20.278836 140042139842112 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 7.074392s.
I0121 16:53:20.279488 140042257290816 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 16:53:20.280222 140042257290816 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 16:53:20.335099 140042257290816 deleter.py:273] Deleted step 73350.
I0121 16:53:20.335650 140042257290816 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=74250] CheckpointManager Save Finalize is syncing with other hosts...
I0121 16:53:20.336328 140042257290816 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=74250] CheckpointManager Save Finalize is done on all hosts.
step: 74700,  loss data: 6.641e-04, loss res: 1.085e-03, time: 1.724e+02
step: 75150,  loss data: 7.695e-04, loss res: 5.009e-04, time: 1.734e+02
I0121 16:58:59.001922 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 16:58:59.004679 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 75150
I0121 16:58:59.006727 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/75150.
I0121 16:58:59.022817 140040009143872 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/75150.orbax-checkpoint-tmp
I0121 16:58:59.139209 140039078012480 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/75150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 16:58:59.175633 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 16:58:59.177376 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 16:58:59.765644 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.593741s
I0121 16:58:59.773248 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 113.387 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 754 milliseconds) (per-host)
I0121 16:58:59.774739 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.756014s (batch_requests_ready=0.099813s, total_serialization_initiated=0.648504s, others=0.007697s)
I0121 16:58:59.797451 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.786999s (all_items=0.000079s, per_item={'default': '0.00007915'}, temp_paths=0.786920)
I0121 16:58:59.873839 140042139842112 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 16:58:59.874251 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.869004s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/75150.
I0121 16:58:59.880012 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=75150] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 16:58:59.882381 140042173412928 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 16:58:59.885462 140165176223552 standard_logger.py:34] {'step': Array(75150, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768985939.0016963, 'wait_for_prev_duration_secs': 0.0009479522705078125, 'time_between_consecutive_saves_sec': 338.6648499965668, 'checkpointer_blocking_start_time': 1768985939.0051703, 'checkpointer_blocking_duration_secs': 0.8743438720703125, 'get_old_steps_start_time': 1768985939.8795953, 'get_old_steps_duration_secs': 0.0002636909484863281, 'checkpoint_manager_blocking_start_time': 1768985939.0003433, 'checkpoint_manager_blocking_duration_secs': 0.8836450576782227}
I0121 16:58:59.895280 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/75150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 16:59:04.924634 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 5.150850s (commit=4.911164s, array_metadata_write=0.239686s)
I0121 16:59:04.929342 140042139842112 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 14.471 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 5 seconds) (per-host)
I0121 16:59:04.929752 140042139842112 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 5.054993s.
I0121 16:59:04.942332 140042139842112 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 16:59:05.751018 140042139842112 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.817721s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/75150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 16:59:05.753675 140042139842112 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/75150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/75150.orbax-checkpoint-tmp/default
I0121 16:59:05.760457 140042139842112 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/75150.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/75150
I0121 16:59:06.287589 140042139842112 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/75150`.
I0121 16:59:06.290020 140042139842112 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 7.284779s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/75150
I0121 16:59:06.290588 140042139842112 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 6.415822s.
I0121 16:59:06.291594 140042173412928 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 16:59:06.292255 140042173412928 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 16:59:06.365920 140042173412928 deleter.py:273] Deleted step 74250.
I0121 16:59:06.367081 140042173412928 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=75150] CheckpointManager Save Finalize is syncing with other hosts...
I0121 16:59:06.368448 140042173412928 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=75150] CheckpointManager Save Finalize is done on all hosts.
step: 75600,  loss data: 8.839e-04, loss res: 1.340e-03, time: 1.738e+02
step: 76050,  loss data: 5.479e-04, loss res: 4.168e-04, time: 1.741e+02
I0121 17:04:47.776568 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 17:04:47.778764 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 76050
I0121 17:04:47.780243 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/76050.
I0121 17:04:47.816020 140040512443968 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/76050.orbax-checkpoint-tmp
I0121 17:04:47.940967 140038549534272 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/76050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 17:04:47.949554 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 17:04:47.950728 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 17:04:48.517401 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.570613s
I0121 17:04:48.540110 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 114.230 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 748 milliseconds) (per-host)
I0121 17:04:48.561565 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.770324s (batch_requests_ready=0.104697s, total_serialization_initiated=0.627304s, others=0.038323s)
I0121 17:04:48.609046 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.825357s (all_items=0.000035s, per_item={'default': '0.00003505'}, temp_paths=0.825322)
I0121 17:04:48.618888 140041879799360 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 17:04:48.619884 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.840603s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/76050.
I0121 17:04:48.622628 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=76050] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 17:04:48.625417 140042257290816 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 17:04:48.628376 140165176223552 standard_logger.py:34] {'step': Array(76050, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768986287.7764423, 'wait_for_prev_duration_secs': 0.0006427764892578125, 'time_between_consecutive_saves_sec': 341.4064962863922, 'checkpointer_blocking_start_time': 1768986287.779221, 'checkpointer_blocking_duration_secs': 0.8429009914398193, 'get_old_steps_start_time': 1768986288.622207, 'get_old_steps_duration_secs': 0.00023889541625976562, 'checkpoint_manager_blocking_start_time': 1768986287.7754402, 'checkpoint_manager_blocking_duration_secs': 0.8516511917114258}
I0121 17:04:48.634325 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/76050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 17:04:50.115523 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.569670s (commit=1.442373s, array_metadata_write=0.127297s)
I0121 17:04:50.119415 140041879799360 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 36.738 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 17:04:50.119837 140041879799360 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.499161s.
I0121 17:04:50.133550 140041879799360 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 17:04:50.245573 140041879799360 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.122375s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/76050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 17:04:50.247757 140041879799360 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/76050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/76050.orbax-checkpoint-tmp/default
I0121 17:04:50.252636 140041879799360 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/76050.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/76050
I0121 17:04:50.266163 140041879799360 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/76050`.
I0121 17:04:50.267698 140041879799360 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.488433s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/76050
I0121 17:04:50.268209 140041879799360 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.647526s.
I0121 17:04:50.269177 140042257290816 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 17:04:50.269686 140042257290816 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 17:04:50.327206 140042257290816 deleter.py:273] Deleted step 75150.
I0121 17:04:50.327580 140042257290816 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=76050] CheckpointManager Save Finalize is syncing with other hosts...
I0121 17:04:50.328035 140042257290816 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=76050] CheckpointManager Save Finalize is done on all hosts.
step: 76500,  loss data: 9.537e-04, loss res: 2.070e-03, time: 1.723e+02
Epoch 170, getting batches from DataLoader...
step: 76950,  loss data: 8.318e-04, loss res: 2.453e-03, time: 1.721e+02
I0121 17:10:33.077504 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 17:10:33.079922 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 76950
I0121 17:10:33.081548 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/76950.
I0121 17:10:33.107208 140040520836672 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/76950.orbax-checkpoint-tmp
I0121 17:10:33.192780 140039036048960 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/76950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 17:10:33.243010 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 17:10:33.244396 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 17:10:33.800416 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.560124s
I0121 17:10:33.807279 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 119.544 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 715 milliseconds) (per-host)
I0121 17:10:33.813510 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.721811s (batch_requests_ready=0.095844s, total_serialization_initiated=0.613801s, others=0.012166s)
I0121 17:10:33.819471 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.734518s (all_items=0.000037s, per_item={'default': '0.00003695'}, temp_paths=0.734481)
I0121 17:10:33.905829 140042156627520 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 17:10:33.906275 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.825775s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/76950.
I0121 17:10:33.908479 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=76950] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 17:10:33.909937 140042139842112 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 17:10:33.914553 140165176223552 standard_logger.py:34] {'step': Array(76950, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768986633.0773876, 'wait_for_prev_duration_secs': 0.0006999969482421875, 'time_between_consecutive_saves_sec': 342.74915075302124, 'checkpointer_blocking_start_time': 1768986633.0804393, 'checkpointer_blocking_duration_secs': 0.8276288509368896, 'get_old_steps_start_time': 1768986633.908141, 'get_old_steps_duration_secs': 0.00018787384033203125, 'checkpoint_manager_blocking_start_time': 1768986633.0763426, 'checkpoint_manager_blocking_duration_secs': 0.837134599685669}
I0121 17:10:33.934865 140042274076224 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/76950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 17:10:35.301635 140042265683520 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.488496s (commit=1.356467s, array_metadata_write=0.132029s)
I0121 17:10:35.305559 140042156627520 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 38.636 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 17:10:35.305991 140042156627520 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.398959s.
I0121 17:10:35.318281 140042156627520 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 17:10:35.470295 140042156627520 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.161506s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/76950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 17:10:35.472512 140042156627520 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/76950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/76950.orbax-checkpoint-tmp/default
I0121 17:10:35.479068 140042156627520 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/76950.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/76950
I0121 17:10:35.499987 140042156627520 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/76950`.
I0121 17:10:35.501447 140042156627520 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.420966s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/76950
I0121 17:10:35.501922 140042156627520 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.594883s.
I0121 17:10:35.502827 140042139842112 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 17:10:35.503458 140042139842112 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 17:10:35.537215 140042139842112 deleter.py:273] Deleted step 76050.
I0121 17:10:35.537783 140042139842112 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=76950] CheckpointManager Save Finalize is syncing with other hosts...
I0121 17:10:35.538501 140042139842112 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=76950] CheckpointManager Save Finalize is done on all hosts.
step: 77400,  loss data: 6.177e-04, loss res: 6.646e-04, time: 1.732e+02
step: 77850,  loss data: 6.031e-04, loss res: 7.241e-04, time: 1.731e+02
I0121 17:16:20.304822 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 17:16:20.307813 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 77850
I0121 17:16:20.309772 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/77850.
I0121 17:16:20.325373 140043767756352 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/77850.orbax-checkpoint-tmp
I0121 17:16:20.422574 140039975573056 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/77850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 17:16:20.480986 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 17:16:20.482874 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 17:16:20.932989 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.454635s
I0121 17:16:20.962863 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 133.882 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 638 milliseconds) (per-host)
I0121 17:16:21.031345 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.707539s (batch_requests_ready=0.099555s, total_serialization_initiated=0.521177s, others=0.086808s)
I0121 17:16:21.033946 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.720523s (all_items=0.000084s, per_item={'default': '0.00008392'}, temp_paths=0.720439)
I0121 17:16:21.042352 140041871406656 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 17:16:21.042704 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.734314s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/77850.
I0121 17:16:21.044562 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=77850] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 17:16:21.045862 140040554407488 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 17:16:21.047938 140165176223552 standard_logger.py:34] {'step': Array(77850, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768986980.3046432, 'wait_for_prev_duration_secs': 0.0007996559143066406, 'time_between_consecutive_saves_sec': 344.7658038139343, 'checkpointer_blocking_start_time': 1768986980.30831, 'checkpointer_blocking_duration_secs': 0.735769510269165, 'get_old_steps_start_time': 1768986981.044162, 'get_old_steps_duration_secs': 0.0002589225769042969, 'checkpoint_manager_blocking_start_time': 1768986980.3032498, 'checkpoint_manager_blocking_duration_secs': 0.7433931827545166}
I0121 17:16:21.062363 140042265683520 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/77850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 17:16:23.090712 140042257290816 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 2.139344s (commit=1.992133s, array_metadata_write=0.147211s)
I0121 17:16:23.094436 140041871406656 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 30.871 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 17:16:23.094938 140041871406656 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 2.051581s.
I0121 17:16:23.106730 140041871406656 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 17:16:23.202141 140041871406656 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.104265s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/77850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 17:16:23.205504 140041871406656 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/77850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/77850.orbax-checkpoint-tmp/default
I0121 17:16:23.211272 140041871406656 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/77850.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/77850
I0121 17:16:23.224020 140041871406656 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/77850`.
I0121 17:16:23.225598 140041871406656 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.917221s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/77850
I0121 17:16:23.226086 140041871406656 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 2.182722s.
I0121 17:16:23.226849 140040554407488 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 17:16:23.227301 140040554407488 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 17:16:23.277369 140040554407488 deleter.py:273] Deleted step 76950.
I0121 17:16:23.277919 140040554407488 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=77850] CheckpointManager Save Finalize is syncing with other hosts...
I0121 17:16:23.278573 140040554407488 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=77850] CheckpointManager Save Finalize is done on all hosts.
step: 78300,  loss data: 6.092e-04, loss res: 9.296e-04, time: 1.745e+02
step: 78750,  loss data: 8.458e-04, loss res: 6.972e-04, time: 1.728e+02
I0121 17:22:08.367174 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 17:22:08.369349 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 78750
I0121 17:22:08.370958 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/78750.
I0121 17:22:08.396936 140042274076224 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/78750.orbax-checkpoint-tmp
I0121 17:22:08.504298 140039069619776 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/78750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 17:22:08.541528 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 17:22:08.542437 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 17:22:09.166461 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.628377s
I0121 17:22:09.190581 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 105.851 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 808 milliseconds) (per-host)
I0121 17:22:09.196762 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.814317s (batch_requests_ready=0.101348s, total_serialization_initiated=0.694274s, others=0.018695s)
I0121 17:22:09.205657 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.830590s (all_items=0.000036s, per_item={'default': '0.00003624'}, temp_paths=0.830553)
I0121 17:22:09.279494 140042131449408 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 17:22:09.280094 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.910216s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/78750.
I0121 17:22:09.287455 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=78750] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 17:22:09.289574 140042156627520 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 17:22:09.292299 140165176223552 standard_logger.py:34] {'step': Array(78750, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768987328.3670404, 'wait_for_prev_duration_secs': 0.0006797313690185547, 'time_between_consecutive_saves_sec': 345.08806824684143, 'checkpointer_blocking_start_time': 1768987328.3698356, 'checkpointer_blocking_duration_secs': 0.9171874523162842, 'get_old_steps_start_time': 1768987329.2871046, 'get_old_steps_duration_secs': 0.00019502639770507812, 'checkpoint_manager_blocking_start_time': 1768987328.3660257, 'checkpoint_manager_blocking_duration_secs': 0.9246666431427002}
I0121 17:22:09.304198 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/78750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 17:22:10.928847 140042265683520 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.738704s (commit=1.613993s, array_metadata_write=0.124711s)
I0121 17:22:10.932361 140042131449408 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 33.544 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 17:22:10.932883 140042131449408 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.652624s.
I0121 17:22:10.947911 140042131449408 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 17:22:11.010984 140042131449408 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.074723s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/78750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 17:22:11.013221 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/78750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/78750.orbax-checkpoint-tmp/default
I0121 17:22:11.017938 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/78750.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/78750
I0121 17:22:11.031671 140042131449408 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/78750`.
I0121 17:22:11.033276 140042131449408 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.663399s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/78750
I0121 17:22:11.033757 140042131449408 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.753494s.
I0121 17:22:11.034516 140042156627520 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 17:22:11.035292 140042156627520 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 17:22:11.091721 140042156627520 deleter.py:273] Deleted step 77850.
I0121 17:22:11.092302 140042156627520 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=78750] CheckpointManager Save Finalize is syncing with other hosts...
I0121 17:22:11.092969 140042156627520 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=78750] CheckpointManager Save Finalize is done on all hosts.
step: 79200,  loss data: 9.658e-04, loss res: 1.221e-03, time: 1.716e+02
step: 79650,  loss data: 1.377e-03, loss res: 1.656e-03, time: 1.721e+02
I0121 17:27:52.963489 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 17:27:52.966193 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 79650
I0121 17:27:52.968285 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/79650.
I0121 17:27:53.008496 140039078012480 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/79650.orbax-checkpoint-tmp
I0121 17:27:53.100739 140042148234816 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/79650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 17:27:53.139149 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 17:27:53.140477 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 17:27:53.750219 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.613752s
I0121 17:27:53.795282 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 105.483 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 810 milliseconds) (per-host)
I0121 17:27:53.849333 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.865102s (batch_requests_ready=0.095968s, total_serialization_initiated=0.692494s, others=0.076639s)
I0121 17:27:53.850851 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.875554s (all_items=0.000095s, per_item={'default': '0.00009513'}, temp_paths=0.875459)
I0121 17:27:53.855463 140042131449408 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 17:27:53.856190 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.889403s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/79650.
I0121 17:27:53.861214 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=79650] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 17:27:53.863211 140042173412928 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 17:27:53.866777 140165176223552 standard_logger.py:34] {'step': Array(79650, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768987672.9632547, 'wait_for_prev_duration_secs': 0.0009407997131347656, 'time_between_consecutive_saves_sec': 341.8697679042816, 'checkpointer_blocking_start_time': 1768987672.9667034, 'checkpointer_blocking_duration_secs': 0.894010066986084, 'get_old_steps_start_time': 1768987673.8607948, 'get_old_steps_duration_secs': 0.0002765655517578125, 'checkpoint_manager_blocking_start_time': 1768987672.9617581, 'checkpoint_manager_blocking_duration_secs': 0.9035553932189941}
I0121 17:27:53.885261 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/79650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 17:27:55.529556 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.739947s (commit=1.612787s, array_metadata_write=0.127160s)
I0121 17:27:55.533454 140042131449408 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 33.553 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 17:27:55.533948 140042131449408 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.677409s.
I0121 17:27:55.546565 140042131449408 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 17:27:55.638996 140042131449408 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.101657s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/79650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 17:27:55.641251 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/79650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/79650.orbax-checkpoint-tmp/default
I0121 17:27:55.646590 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/79650.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/79650
I0121 17:27:55.694412 140042131449408 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/79650`.
I0121 17:27:55.695938 140042131449408 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.729166s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/79650
I0121 17:27:55.696412 140042131449408 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.839868s.
I0121 17:27:55.697052 140042173412928 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 17:27:55.697771 140042173412928 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 17:27:55.753836 140042173412928 deleter.py:273] Deleted step 78750.
I0121 17:27:55.756989 140042173412928 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=79650] CheckpointManager Save Finalize is syncing with other hosts...
I0121 17:27:55.758989 140042173412928 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=79650] CheckpointManager Save Finalize is done on all hosts.
step: 80100,  loss data: 7.389e-04, loss res: 1.233e-03, time: 1.714e+02
step: 80550,  loss data: 4.155e-04, loss res: 3.333e-04, time: 1.719e+02
I0121 17:33:37.204624 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 17:33:37.206923 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 80550
I0121 17:33:37.208534 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/80550.
I0121 17:33:37.245108 140038524356160 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/80550.orbax-checkpoint-tmp
I0121 17:33:37.336199 140040520836672 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/80550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 17:33:37.382674 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 17:33:37.383569 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 17:33:37.965384 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.585401s
I0121 17:33:37.988243 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 111.740 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 765 milliseconds) (per-host)
I0121 17:33:38.004594 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.781904s (batch_requests_ready=0.103086s, total_serialization_initiated=0.651222s, others=0.027596s)
I0121 17:33:38.040898 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.828918s (all_items=0.000040s, per_item={'default': '0.00004005'}, temp_paths=0.828878)
I0121 17:33:38.070816 140042131449408 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 17:33:38.072172 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.864692s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/80550.
I0121 17:33:38.073339 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=80550] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 17:33:38.077477 140042257290816 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 17:33:38.081558 140165176223552 standard_logger.py:34] {'step': Array(80550, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768988017.204503, 'wait_for_prev_duration_secs': 0.0006411075592041016, 'time_between_consecutive_saves_sec': 341.4427525997162, 'checkpointer_blocking_start_time': 1768988017.2074218, 'checkpointer_blocking_duration_secs': 0.8654909133911133, 'get_old_steps_start_time': 1768988018.0729873, 'get_old_steps_duration_secs': 0.0002067089080810547, 'checkpoint_manager_blocking_start_time': 1768988017.203527, 'checkpoint_manager_blocking_duration_secs': 0.8766295909881592}
I0121 17:33:38.126373 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/80550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 17:33:39.680563 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.681731s (commit=1.554231s, array_metadata_write=0.127500s)
I0121 17:33:39.683657 140042131449408 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 34.756 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 17:33:39.684161 140042131449408 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.612752s.
I0121 17:33:39.696870 140042131449408 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 17:33:39.796110 140042131449408 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.108589s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/80550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 17:33:39.799429 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/80550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/80550.orbax-checkpoint-tmp/default
I0121 17:33:39.804172 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/80550.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/80550
I0121 17:33:39.816916 140042131449408 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/80550`.
I0121 17:33:39.818383 140042131449408 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.610919s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/80550
I0121 17:33:39.818846 140042131449408 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.747429s.
I0121 17:33:39.819642 140042257290816 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 17:33:39.820433 140042257290816 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 17:33:39.855319 140042257290816 deleter.py:273] Deleted step 79650.
I0121 17:33:39.855887 140042257290816 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=80550] CheckpointManager Save Finalize is syncing with other hosts...
I0121 17:33:39.856473 140042257290816 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=80550] CheckpointManager Save Finalize is done on all hosts.
step: 81000,  loss data: 1.403e-03, loss res: 1.985e-03, time: 1.733e+02
Epoch 180, getting batches from DataLoader...
step: 81450,  loss data: 6.984e-04, loss res: 9.916e-04, time: 1.732e+02
I0121 17:39:24.613493 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 17:39:24.616432 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 81450
I0121 17:39:24.618498 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/81450.
I0121 17:39:24.645647 140045084255808 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/81450.orbax-checkpoint-tmp
I0121 17:39:24.748578 140040554407488 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/81450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 17:39:24.786390 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 17:39:24.787219 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 17:39:25.381004 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.597513s
I0121 17:39:25.388090 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 113.150 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 755 milliseconds) (per-host)
I0121 17:39:25.985414 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 1.353404s (batch_requests_ready=0.096097s, total_serialization_initiated=0.653939s, others=0.603368s)
I0121 17:39:25.991822 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 1.368944s (all_items=0.000096s, per_item={'default': '0.00009561'}, temp_paths=1.368848)
I0121 17:39:26.048002 140042156627520 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 17:39:26.048254 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 1.431275s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/81450.
I0121 17:39:26.049568 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=81450] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 17:39:26.050465 140042148234816 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 17:39:26.052041 140165176223552 standard_logger.py:34] {'step': Array(81450, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768988364.6132123, 'wait_for_prev_duration_secs': 0.0010819435119628906, 'time_between_consecutive_saves_sec': 344.7562494277954, 'checkpointer_blocking_start_time': 1768988364.6169147, 'checkpointer_blocking_duration_secs': 1.4323749542236328, 'get_old_steps_start_time': 1768988366.049348, 'get_old_steps_duration_secs': 0.0001385211944580078, 'checkpoint_manager_blocking_start_time': 1768988364.611558, 'checkpoint_manager_blocking_duration_secs': 1.43971586227417}
I0121 17:39:26.163366 140042265683520 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/81450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 17:39:31.297821 140042257290816 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 5.318128s (commit=5.106328s, array_metadata_write=0.211799s)
I0121 17:39:31.302626 140042156627520 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 12.822 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 6 seconds) (per-host)
I0121 17:39:31.303244 140042156627520 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 5.254470s.
I0121 17:39:31.318827 140042156627520 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 17:39:31.671203 140042156627520 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.363666s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/81450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 17:39:31.673531 140042156627520 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/81450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/81450.orbax-checkpoint-tmp/default
I0121 17:39:31.682032 140042156627520 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/81450.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/81450
I0121 17:39:32.402404 140042156627520 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/81450`.
I0121 17:39:32.404622 140042156627520 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 7.787634s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/81450
I0121 17:39:32.405177 140042156627520 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 6.356406s.
I0121 17:39:32.406195 140042148234816 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 17:39:32.406719 140042148234816 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 17:39:32.454616 140042148234816 deleter.py:273] Deleted step 80550.
I0121 17:39:32.455221 140042148234816 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=81450] CheckpointManager Save Finalize is syncing with other hosts...
I0121 17:39:32.455863 140042148234816 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=81450] CheckpointManager Save Finalize is done on all hosts.
step: 81900,  loss data: 6.586e-04, loss res: 5.650e-04, time: 1.735e+02
step: 82350,  loss data: 1.184e-03, loss res: 3.484e-03, time: 1.735e+02
I0121 17:45:13.029504 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 17:45:13.031685 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 82350
I0121 17:45:13.033131 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/82350.
I0121 17:45:13.069444 140040546014784 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/82350.orbax-checkpoint-tmp
I0121 17:45:13.176254 140039069619776 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/82350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 17:45:13.208614 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 17:45:13.209723 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 17:45:13.778927 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.573575s
I0121 17:45:13.812801 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 111.229 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 768 milliseconds) (per-host)
I0121 17:45:13.818892 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.775159s (batch_requests_ready=0.100921s, total_serialization_initiated=0.656808s, others=0.017430s)
I0121 17:45:13.861552 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.825024s (all_items=0.000036s, per_item={'default': '0.00003624'}, temp_paths=0.824988)
I0121 17:45:13.887673 140043767756352 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 17:45:13.888577 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.856394s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/82350.
I0121 17:45:13.892251 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=82350] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 17:45:13.897256 140042131449408 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 17:45:13.900150 140165176223552 standard_logger.py:34] {'step': Array(82350, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768988713.0293825, 'wait_for_prev_duration_secs': 0.0005974769592285156, 'time_between_consecutive_saves_sec': 340.5731189250946, 'checkpointer_blocking_start_time': 1768988713.0321155, 'checkpointer_blocking_duration_secs': 0.8596858978271484, 'get_old_steps_start_time': 1768988713.89188, 'get_old_steps_duration_secs': 0.0002205371856689453, 'checkpoint_manager_blocking_start_time': 1768988713.028358, 'checkpoint_manager_blocking_duration_secs': 0.8704719543457031}
I0121 17:45:13.916838 140042274076224 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/82350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 17:45:16.280748 140042265683520 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 2.420828s (commit=1.776508s, array_metadata_write=0.644320s)
I0121 17:45:16.283917 140043767756352 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 26.398 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 3 seconds) (per-host)
I0121 17:45:16.284438 140043767756352 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 2.395606s.
I0121 17:45:16.302064 140043767756352 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 17:45:16.470177 140043767756352 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.180078s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/82350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 17:45:16.472261 140043767756352 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/82350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/82350.orbax-checkpoint-tmp/default
I0121 17:45:16.479685 140043767756352 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/82350.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/82350
I0121 17:45:16.503413 140043767756352 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/82350`.
I0121 17:45:16.504558 140043767756352 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 3.472418s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/82350
I0121 17:45:16.504786 140043767756352 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 2.615961s.
I0121 17:45:16.505151 140042131449408 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 17:45:16.505607 140042131449408 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 17:45:16.584995 140042131449408 deleter.py:273] Deleted step 81450.
I0121 17:45:16.585365 140042131449408 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=82350] CheckpointManager Save Finalize is syncing with other hosts...
I0121 17:45:16.585843 140042131449408 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=82350] CheckpointManager Save Finalize is done on all hosts.
step: 82800,  loss data: 5.974e-04, loss res: 1.087e-03, time: 1.714e+02
step: 83250,  loss data: 8.147e-04, loss res: 9.234e-04, time: 1.715e+02
I0121 17:50:56.773920 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 17:50:56.776438 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 83250
I0121 17:50:56.778189 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/83250.
I0121 17:50:56.815218 140040546014784 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/83250.orbax-checkpoint-tmp
I0121 17:50:56.902891 140040025929280 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/83250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 17:50:56.947736 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 17:50:56.948616 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 17:50:57.541703 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.596671s
I0121 17:50:57.580126 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 108.349 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 789 milliseconds) (per-host)
I0121 17:50:57.591188 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.800578s (batch_requests_ready=0.096878s, total_serialization_initiated=0.665741s, others=0.037959s)
I0121 17:50:57.639216 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.856850s (all_items=0.000048s, per_item={'default': '0.00004768'}, temp_paths=0.856802)
I0121 17:50:57.644037 140042131449408 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 17:50:57.645025 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.867987s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/83250.
I0121 17:50:57.649028 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=83250] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 17:50:57.650530 140042257290816 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 17:50:57.653093 140165176223552 standard_logger.py:34] {'step': Array(83250, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768989056.773732, 'wait_for_prev_duration_secs': 0.0008609294891357422, 'time_between_consecutive_saves_sec': 340.18766021728516, 'checkpointer_blocking_start_time': 1768989056.776977, 'checkpointer_blocking_duration_secs': 0.8716292381286621, 'get_old_steps_start_time': 1768989057.6486819, 'get_old_steps_duration_secs': 0.00020051002502441406, 'checkpoint_manager_blocking_start_time': 1768989056.7725356, 'checkpoint_manager_blocking_duration_secs': 0.8789191246032715}
I0121 17:50:57.723618 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/83250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 17:50:59.389183 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.809411s (commit=1.662827s, array_metadata_write=0.146584s)
I0121 17:50:59.393314 140042131449408 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 32.864 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 17:50:59.393808 140042131449408 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.748880s.
I0121 17:50:59.406592 140042131449408 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 17:50:59.571506 140042131449408 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.174600s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/83250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 17:50:59.573835 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/83250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/83250.orbax-checkpoint-tmp/default
I0121 17:50:59.579045 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/83250.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/83250
I0121 17:50:59.664100 140042131449408 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/83250`.
I0121 17:50:59.665810 140042131449408 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.888786s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/83250
I0121 17:50:59.666282 140042131449408 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 2.021350s.
I0121 17:50:59.667084 140042257290816 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 17:50:59.667664 140042257290816 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 17:50:59.718858 140042257290816 deleter.py:273] Deleted step 82350.
I0121 17:50:59.719221 140042257290816 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=83250] CheckpointManager Save Finalize is syncing with other hosts...
I0121 17:50:59.719687 140042257290816 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=83250] CheckpointManager Save Finalize is done on all hosts.
step: 83700,  loss data: 7.161e-04, loss res: 1.098e-03, time: 1.716e+02
step: 84150,  loss data: 9.077e-04, loss res: 3.103e-03, time: 1.712e+02
I0121 17:56:40.418952 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 17:56:40.421064 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 84150
I0121 17:56:40.422316 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/84150.
I0121 17:56:40.458647 140040537622080 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/84150.orbax-checkpoint-tmp
I0121 17:56:40.544497 140040529229376 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/84150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 17:56:40.586210 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 17:56:40.586915 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 17:56:41.185843 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.602858s
I0121 17:56:41.193705 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 112.782 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 758 milliseconds) (per-host)
I0121 17:56:41.205047 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.769825s (batch_requests_ready=0.093844s, total_serialization_initiated=0.658159s, others=0.017823s)
I0121 17:56:41.206442 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.780136s (all_items=0.000036s, per_item={'default': '0.00003600'}, temp_paths=0.780100)
I0121 17:56:41.287898 140042165020224 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 17:56:41.289993 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.868450s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/84150.
I0121 17:56:41.291977 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=84150] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 17:56:41.294341 140041879799360 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 17:56:41.299176 140165176223552 standard_logger.py:34] {'step': Array(84150, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768989400.4188569, 'wait_for_prev_duration_secs': 0.0005650520324707031, 'time_between_consecutive_saves_sec': 340.69895577430725, 'checkpointer_blocking_start_time': 1768989400.42148, 'checkpointer_blocking_duration_secs': 0.87005615234375, 'get_old_steps_start_time': 1768989401.2916126, 'get_old_steps_duration_secs': 0.0002110004425048828, 'checkpoint_manager_blocking_start_time': 1768989400.4179828, 'checkpoint_manager_blocking_duration_secs': 0.8769862651824951}
I0121 17:56:41.314936 140042274076224 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/84150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 17:56:42.970990 140042265683520 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.771569s (commit=1.617343s, array_metadata_write=0.154227s)
I0121 17:56:42.974987 140042165020224 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 33.678 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 17:56:42.975555 140042165020224 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.685664s.
I0121 17:56:42.990573 140042165020224 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 17:56:43.060531 140042165020224 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.080941s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/84150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 17:56:43.062769 140042165020224 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/84150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/84150.orbax-checkpoint-tmp/default
I0121 17:56:43.082127 140042165020224 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/84150.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/84150
I0121 17:56:43.098086 140042165020224 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/84150`.
I0121 17:56:43.099590 140042165020224 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.678067s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/84150
I0121 17:56:43.100054 140042165020224 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.810168s.
I0121 17:56:43.100975 140041879799360 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 17:56:43.101469 140041879799360 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 17:56:43.158337 140041879799360 deleter.py:273] Deleted step 83250.
I0121 17:56:43.158926 140041879799360 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=84150] CheckpointManager Save Finalize is syncing with other hosts...
I0121 17:56:43.159682 140041879799360 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=84150] CheckpointManager Save Finalize is done on all hosts.
step: 84600,  loss data: 6.275e-04, loss res: 9.433e-04, time: 1.735e+02
step: 85050,  loss data: 7.165e-04, loss res: 6.834e-04, time: 1.736e+02
I0121 18:02:28.365442 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 18:02:28.367626 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 85050
I0121 18:02:28.369218 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/85050.
I0121 18:02:28.395485 140040537622080 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/85050.orbax-checkpoint-tmp
I0121 18:02:28.480512 140042139842112 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/85050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 18:02:28.537047 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 18:02:28.537653 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 18:02:29.113512 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.578862s
I0121 18:02:29.125521 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 114.845 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 744 milliseconds) (per-host)
I0121 18:02:29.132700 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.752038s (batch_requests_ready=0.100830s, total_serialization_initiated=0.632885s, others=0.018324s)
I0121 18:02:29.139154 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.766251s (all_items=0.000035s, per_item={'default': '0.00003481'}, temp_paths=0.766216)
I0121 18:02:29.217739 140042257290816 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 18:02:29.218720 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.850538s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/85050.
I0121 18:02:29.220663 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=85050] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 18:02:29.225387 140041871406656 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 18:02:29.228194 140165176223552 standard_logger.py:34] {'step': Array(85050, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768989748.3653176, 'wait_for_prev_duration_secs': 0.0006840229034423828, 'time_between_consecutive_saves_sec': 345.20521903038025, 'checkpointer_blocking_start_time': 1768989748.3681204, 'checkpointer_blocking_duration_secs': 0.8521237373352051, 'get_old_steps_start_time': 1768989749.2203221, 'get_old_steps_duration_secs': 0.00019669532775878906, 'checkpoint_manager_blocking_start_time': 1768989748.364148, 'checkpoint_manager_blocking_duration_secs': 0.8623816967010498}
I0121 18:02:29.242905 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/85050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 18:02:30.778466 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.647282s (commit=1.516098s, array_metadata_write=0.131183s)
I0121 18:02:30.782236 140042257290816 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 35.616 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 18:02:30.782737 140042257290816 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.564155s.
I0121 18:02:30.794775 140042257290816 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 18:02:30.908262 140042257290816 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.122458s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/85050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 18:02:30.910553 140042257290816 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/85050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/85050.orbax-checkpoint-tmp/default
I0121 18:02:30.915162 140042257290816 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/85050.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/85050
I0121 18:02:30.926428 140042257290816 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/85050`.
I0121 18:02:30.927969 140042257290816 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.559808s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/85050
I0121 18:02:30.928439 140042257290816 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.709851s.
I0121 18:02:30.929111 140041871406656 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 18:02:30.929639 140041871406656 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 18:02:30.992775 140041871406656 deleter.py:273] Deleted step 84150.
I0121 18:02:30.993132 140041871406656 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=85050] CheckpointManager Save Finalize is syncing with other hosts...
I0121 18:02:30.993451 140041871406656 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=85050] CheckpointManager Save Finalize is done on all hosts.
step: 85500,  loss data: 7.068e-04, loss res: 7.687e-04, time: 1.717e+02
Epoch 190, getting batches from DataLoader...
step: 85950,  loss data: 8.515e-04, loss res: 1.693e-03, time: 1.721e+02
I0121 18:08:12.954178 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 18:08:12.956935 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 85950
I0121 18:08:12.959056 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/85950.
I0121 18:08:12.991261 140038507570752 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/85950.orbax-checkpoint-tmp
I0121 18:08:13.088119 140039086405184 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/85950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 18:08:13.123118 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 18:08:13.124755 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 18:08:13.664176 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.543896s
I0121 18:08:13.676458 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 121.341 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 704 milliseconds) (per-host)
I0121 18:08:13.688228 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.716830s (batch_requests_ready=0.096255s, total_serialization_initiated=0.602860s, others=0.017715s)
I0121 18:08:13.694469 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.731029s (all_items=0.000083s, per_item={'default': '0.00008273'}, temp_paths=0.730946)
I0121 18:08:13.763758 140042257290816 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 18:08:13.764055 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.806556s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/85950.
I0121 18:08:13.767327 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=85950] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 18:08:13.769195 140041879799360 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 18:08:13.775418 140165176223552 standard_logger.py:34] {'step': Array(85950, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768990092.953925, 'wait_for_prev_duration_secs': 0.0010042190551757812, 'time_between_consecutive_saves_sec': 341.96027517318726, 'checkpointer_blocking_start_time': 1768990092.9574208, 'checkpointer_blocking_duration_secs': 0.8094542026519775, 'get_old_steps_start_time': 1768990093.7669494, 'get_old_steps_duration_secs': 0.0002319812774658203, 'checkpoint_manager_blocking_start_time': 1768990092.9525127, 'checkpoint_manager_blocking_duration_secs': 0.8214359283447266}
I0121 18:08:13.791577 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/85950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 18:08:15.797302 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 2.120289s (commit=1.999312s, array_metadata_write=0.120976s)
I0121 18:08:15.800383 140042257290816 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 30.235 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 18:08:15.800847 140042257290816 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 2.035749s.
I0121 18:08:15.814160 140042257290816 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 18:08:15.920536 140042257290816 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.116406s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/85950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 18:08:15.922784 140042257290816 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/85950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/85950.orbax-checkpoint-tmp/default
I0121 18:08:15.934278 140042257290816 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/85950.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/85950
I0121 18:08:15.953506 140042257290816 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/85950`.
I0121 18:08:15.955033 140042257290816 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.997548s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/85950
I0121 18:08:15.955503 140042257290816 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 2.190399s.
I0121 18:08:15.956431 140041879799360 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 18:08:15.956909 140041879799360 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 18:08:16.011118 140041879799360 deleter.py:273] Deleted step 85050.
I0121 18:08:16.011470 140041879799360 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=85950] CheckpointManager Save Finalize is syncing with other hosts...
I0121 18:08:16.011940 140041879799360 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=85950] CheckpointManager Save Finalize is done on all hosts.
step: 86400,  loss data: 7.480e-04, loss res: 9.108e-04, time: 1.734e+02
step: 86850,  loss data: 3.309e-04, loss res: 6.839e-04, time: 1.735e+02
I0121 18:14:00.679969 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 18:14:00.682527 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 86850
I0121 18:14:00.684167 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/86850.
I0121 18:14:00.715350 140038507570752 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/86850.orbax-checkpoint-tmp
I0121 18:14:00.815409 140041871406656 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/86850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 18:14:00.848822 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 18:14:00.849609 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 18:14:01.481233 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.634995s
I0121 18:14:01.498632 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 106.615 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 802 milliseconds) (per-host)
I0121 18:14:01.504578 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.808327s (batch_requests_ready=0.098623s, total_serialization_initiated=0.692480s, others=0.017224s)
I0121 18:14:01.511244 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.823196s (all_items=0.000047s, per_item={'default': '0.00004745'}, temp_paths=0.823149)
I0121 18:14:01.573485 140042131449408 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 18:14:01.575444 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.892343s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/86850.
I0121 18:14:01.577821 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=86850] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 18:14:01.583494 140041879799360 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 18:14:01.585582 140165176223552 standard_logger.py:34] {'step': Array(86850, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768990440.679849, 'wait_for_prev_duration_secs': 0.0006895065307617188, 'time_between_consecutive_saves_sec': 344.66769790649414, 'checkpointer_blocking_start_time': 1768990440.6830385, 'checkpointer_blocking_duration_secs': 0.8943378925323486, 'get_old_steps_start_time': 1768990441.5774534, 'get_old_steps_duration_secs': 0.00022220611572265625, 'checkpoint_manager_blocking_start_time': 1768990440.6778233, 'checkpoint_manager_blocking_duration_secs': 0.9065256118774414}
I0121 18:14:01.660835 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/86850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 18:14:03.114302 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.604266s (commit=1.478427s, array_metadata_write=0.125839s)
I0121 18:14:03.117573 140042131449408 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 35.325 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 18:14:03.118075 140042131449408 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.542221s.
I0121 18:14:03.129257 140042131449408 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 18:14:03.196300 140042131449408 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.075419s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/86850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 18:14:03.198537 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/86850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/86850.orbax-checkpoint-tmp/default
I0121 18:14:03.204014 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/86850.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/86850
I0121 18:14:03.218698 140042131449408 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/86850`.
I0121 18:14:03.220161 140042131449408 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.537078s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/86850
I0121 18:14:03.220616 140042131449408 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.644757s.
I0121 18:14:03.221426 140041879799360 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 18:14:03.221920 140041879799360 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 18:14:03.265278 140041879799360 deleter.py:273] Deleted step 85950.
I0121 18:14:03.265645 140041879799360 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=86850] CheckpointManager Save Finalize is syncing with other hosts...
I0121 18:14:03.266102 140041879799360 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=86850] CheckpointManager Save Finalize is done on all hosts.
step: 87300,  loss data: 1.250e-03, loss res: 8.213e-04, time: 1.718e+02
step: 87750,  loss data: 8.341e-04, loss res: 7.177e-04, time: 1.720e+02
I0121 18:19:45.381214 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 18:19:45.383599 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 87750
I0121 18:19:45.385031 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/87750.
I0121 18:19:45.417232 140040025929280 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/87750.orbax-checkpoint-tmp
I0121 18:19:45.514079 140042139842112 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/87750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 18:19:45.553200 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 18:19:45.554694 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 18:19:46.135487 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.585079s
I0121 18:19:46.143306 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 114.604 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 746 milliseconds) (per-host)
I0121 18:19:46.150332 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.753439s (batch_requests_ready=0.096718s, total_serialization_initiated=0.643354s, others=0.013366s)
I0121 18:19:46.156616 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.766916s (all_items=0.000036s, per_item={'default': '0.00003576'}, temp_paths=0.766880)
I0121 18:19:46.243122 140042131449408 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 18:19:46.243628 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.859542s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/87750.
I0121 18:19:46.246922 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=87750] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 18:19:46.248648 140041879799360 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 18:19:46.254626 140165176223552 standard_logger.py:34] {'step': Array(87750, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768990785.3810894, 'wait_for_prev_duration_secs': 0.0006034374237060547, 'time_between_consecutive_saves_sec': 342.11475253105164, 'checkpointer_blocking_start_time': 1768990785.3840277, 'checkpointer_blocking_duration_secs': 0.8624913692474365, 'get_old_steps_start_time': 1768990786.24659, 'get_old_steps_duration_secs': 0.0001881122589111328, 'checkpoint_manager_blocking_start_time': 1768990785.3800285, 'checkpoint_manager_blocking_duration_secs': 0.8704664707183838}
I0121 18:19:46.271645 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/87750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 18:19:47.818995 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.669323s (commit=1.530719s, array_metadata_write=0.138604s)
I0121 18:19:47.822785 140042131449408 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 35.259 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 18:19:47.823497 140042131449408 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.579311s.
I0121 18:19:47.845587 140042131449408 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 18:19:47.917581 140042131449408 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.088908s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/87750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 18:19:47.919864 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/87750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/87750.orbax-checkpoint-tmp/default
I0121 18:19:47.925418 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/87750.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/87750
I0121 18:19:47.940576 140042131449408 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/87750`.
I0121 18:19:47.942166 140042131449408 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.558082s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/87750
I0121 18:19:47.942659 140042131449408 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.698478s.
I0121 18:19:47.943608 140041879799360 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 18:19:47.944106 140041879799360 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 18:19:48.004984 140041879799360 deleter.py:273] Deleted step 86850.
I0121 18:19:48.005607 140041879799360 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=87750] CheckpointManager Save Finalize is syncing with other hosts...
I0121 18:19:48.006260 140041879799360 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=87750] CheckpointManager Save Finalize is done on all hosts.
step: 88200,  loss data: 1.429e-03, loss res: 2.295e-03, time: 1.703e+02
step: 88650,  loss data: 3.586e-04, loss res: 4.638e-04, time: 1.711e+02
I0121 18:25:27.745148 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 18:25:27.747481 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 88650
I0121 18:25:27.749063 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/88650.
I0121 18:25:27.785986 140039044441664 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/88650.orbax-checkpoint-tmp
I0121 18:25:27.886692 140039036048960 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/88650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 18:25:27.921782 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 18:25:27.923348 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 18:25:28.478826 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.559849s
I0121 18:25:28.496065 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 116.519 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 734 milliseconds) (per-host)
I0121 18:25:28.513229 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.751321s (batch_requests_ready=0.097946s, total_serialization_initiated=0.630020s, others=0.023354s)
I0121 18:25:28.519611 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.766252s (all_items=0.000049s, per_item={'default': '0.00004911'}, temp_paths=0.766203)
I0121 18:25:28.583422 140042139842112 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 18:25:28.583696 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.835669s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/88650.
I0121 18:25:28.588581 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=88650] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 18:25:28.590498 140042173412928 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 18:25:28.594047 140165176223552 standard_logger.py:34] {'step': Array(88650, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768991127.7450328, 'wait_for_prev_duration_secs': 0.0007023811340332031, 'time_between_consecutive_saves_sec': 339.7383532524109, 'checkpointer_blocking_start_time': 1768991127.7479718, 'checkpointer_blocking_duration_secs': 0.8401980400085449, 'get_old_steps_start_time': 1768991128.5882475, 'get_old_steps_duration_secs': 0.0001914501190185547, 'checkpoint_manager_blocking_start_time': 1768991127.743834, 'checkpoint_manager_blocking_duration_secs': 0.8481888771057129}
I0121 18:25:28.604785 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/88650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 18:25:30.376695 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.869072s (commit=1.739323s, array_metadata_write=0.129749s)
I0121 18:25:30.381410 140042139842112 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 32.652 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 18:25:30.381819 140042139842112 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.797771s.
I0121 18:25:30.394265 140042139842112 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 18:25:30.467202 140042139842112 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.082066s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/88650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 18:25:30.469421 140042139842112 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/88650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/88650.orbax-checkpoint-tmp/default
I0121 18:25:30.474663 140042139842112 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/88650.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/88650
I0121 18:25:30.489567 140042139842112 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/88650`.
I0121 18:25:30.491106 140042139842112 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.743092s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/88650
I0121 18:25:30.491585 140042139842112 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.907531s.
I0121 18:25:30.492537 140042173412928 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 18:25:30.493028 140042173412928 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 18:25:30.552348 140042173412928 deleter.py:273] Deleted step 87750.
I0121 18:25:30.553398 140042173412928 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=88650] CheckpointManager Save Finalize is syncing with other hosts...
I0121 18:25:30.554265 140042173412928 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=88650] CheckpointManager Save Finalize is done on all hosts.
step: 89100,  loss data: 5.258e-04, loss res: 4.823e-04, time: 1.724e+02
step: 89550,  loss data: 4.907e-04, loss res: 5.798e-04, time: 1.710e+02
I0121 18:31:11.976336 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 18:31:11.978518 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 89550
I0121 18:31:11.979839 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/89550.
I0121 18:31:12.006388 140038549534272 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/89550.orbax-checkpoint-tmp
I0121 18:31:12.107574 140042156627520 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/89550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 18:31:12.151280 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 18:31:12.152060 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 18:31:12.690373 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.542257s
I0121 18:31:13.252879 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 67.779 MiB/s (total gbytes: 85.5 MiB) (time elapsed: a second) (per-host)
I0121 18:31:13.304220 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 1.313380s (batch_requests_ready=0.101078s, total_serialization_initiated=0.615352s, others=0.596951s)
I0121 18:31:13.305988 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 1.322119s (all_items=0.000034s, per_item={'default': '0.00003409'}, temp_paths=1.322085)
I0121 18:31:13.311957 140042257290816 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 18:31:13.312556 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 1.333543s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/89550.
I0121 18:31:13.318926 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=89550] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 18:31:13.321186 140041879799360 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 18:31:13.324988 140165176223552 standard_logger.py:34] {'step': Array(89550, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768991471.9762125, 'wait_for_prev_duration_secs': 0.0006122589111328125, 'time_between_consecutive_saves_sec': 341.42160177230835, 'checkpointer_blocking_start_time': 1768991471.9789524, 'checkpointer_blocking_duration_secs': 1.3395335674285889, 'get_old_steps_start_time': 1768991473.3185701, 'get_old_steps_duration_secs': 0.00021004676818847656, 'checkpoint_manager_blocking_start_time': 1768991471.9753542, 'checkpoint_manager_blocking_duration_secs': 1.3477938175201416}
I0121 18:31:13.335894 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/89550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 18:31:14.873979 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.622402s (commit=1.488523s, array_metadata_write=0.133879s)
I0121 18:31:14.877385 140042257290816 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 29.631 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 18:31:14.877884 140042257290816 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.564352s.
I0121 18:31:14.889732 140042257290816 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 18:31:14.958427 140042257290816 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.077434s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/89550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 18:31:14.964155 140042257290816 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/89550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/89550.orbax-checkpoint-tmp/default
I0121 18:31:14.969415 140042257290816 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/89550.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/89550
I0121 18:31:15.057112 140042257290816 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/89550`.
I0121 18:31:15.059236 140042257290816 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 3.080238s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/89550
I0121 18:31:15.059786 140042257290816 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.746244s.
I0121 18:31:15.060640 140041879799360 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 18:31:15.061245 140041879799360 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 18:31:15.116756 140041879799360 deleter.py:273] Deleted step 88650.
I0121 18:31:15.117232 140041879799360 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=89550] CheckpointManager Save Finalize is syncing with other hosts...
I0121 18:31:15.117579 140041879799360 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=89550] CheckpointManager Save Finalize is done on all hosts.
step: 90000,  loss data: 6.158e-04, loss res: 2.003e-03, time: 1.733e+02
Epoch 200, getting batches from DataLoader...
step: 90450,  loss data: 4.272e-04, loss res: 3.130e-04, time: 1.733e+02
I0121 18:37:00.041034 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 18:37:00.043404 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 90450
I0121 18:37:00.045545 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/90450.
I0121 18:37:00.067616 140039044441664 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/90450.orbax-checkpoint-tmp
I0121 18:37:00.172114 140040520836672 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/90450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 18:37:00.172474 140045092648512 checkpoint.py:188] Wrote Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1768991820132634905, 'commit_timestamp_nsecs': None, 'custom_metadata': {}}, json={"item_handlers": null, "metrics": {}, "performance_metrics": {}, "init_timestamp_nsecs": 1768991820132634905, "commit_timestamp_nsecs": null, "custom_metadata": {}} to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/90450.orbax-checkpoint-tmp/_CHECKPOINT_METADATA
I0121 18:37:00.189356 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 18:37:00.190807 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 18:37:00.749274 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.562839s
I0121 18:37:00.767119 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 120.919 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 707 milliseconds) (per-host)
I0121 18:37:00.781236 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.721569s (batch_requests_ready=0.080225s, total_serialization_initiated=0.615319s, others=0.026025s)
I0121 18:37:00.788490 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.738971s (all_items=0.000093s, per_item={'default': '0.00009322'}, temp_paths=0.738877)
I0121 18:37:00.856970 140042165020224 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 18:37:00.857371 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.813383s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/90450.
I0121 18:37:00.860626 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=90450] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 18:37:00.865535 140042131449408 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 18:37:00.869192 140165176223552 standard_logger.py:34] {'step': Array(90450, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768991820.0408676, 'wait_for_prev_duration_secs': 0.0010411739349365234, 'time_between_consecutive_saves_sec': 344.9230890274048, 'checkpointer_blocking_start_time': 1768991820.043902, 'checkpointer_blocking_duration_secs': 0.8162257671356201, 'get_old_steps_start_time': 1768991820.8602104, 'get_old_steps_duration_secs': 0.0002665519714355469, 'checkpoint_manager_blocking_start_time': 1768991820.0393703, 'checkpoint_manager_blocking_duration_secs': 0.8285427093505859}
I0121 18:37:00.882567 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/90450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 18:37:03.073100 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 2.311870s (commit=1.582383s, array_metadata_write=0.729488s)
I0121 18:37:03.076478 140042165020224 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 28.352 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 3 seconds) (per-host)
I0121 18:37:03.076934 140042165020224 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 2.218972s.
I0121 18:37:03.091575 140042165020224 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 18:37:03.100029 140045092648512 checkpoint.py:247] Updated Metadata={'item_handlers': {'default': 'orbax.checkpoint._src.handlers.standard_checkpoint_handler.StandardCheckpointHandler'}, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1768991820132634905, 'commit_timestamp_nsecs': None, 'custom_metadata': {}} to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/90450.orbax-checkpoint-tmp/_CHECKPOINT_METADATA
I0121 18:37:03.164487 140042165020224 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.084120s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/90450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 18:37:03.166742 140042165020224 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/90450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/90450.orbax-checkpoint-tmp/default
I0121 18:37:03.171703 140042165020224 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/90450.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/90450
I0121 18:37:03.187176 140042165020224 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/90450`.
I0121 18:37:03.188567 140042165020224 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 3.144598s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/90450
I0121 18:37:03.189036 140042165020224 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 2.331069s.
I0121 18:37:03.189851 140042131449408 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 18:37:03.190429 140042131449408 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 18:37:03.240610 140042131449408 deleter.py:273] Deleted step 89550.
I0121 18:37:03.241221 140042131449408 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=90450] CheckpointManager Save Finalize is syncing with other hosts...
I0121 18:37:03.241910 140042131449408 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=90450] CheckpointManager Save Finalize is done on all hosts.
step: 90900,  loss data: 4.700e-04, loss res: 6.223e-04, time: 1.739e+02
step: 91350,  loss data: 1.307e-03, loss res: 5.641e-04, time: 1.730e+02
I0121 18:42:47.715539 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 18:42:47.717732 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 91350
I0121 18:42:47.719304 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/91350.
I0121 18:42:47.745843 140040000751168 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/91350.orbax-checkpoint-tmp
I0121 18:42:47.849642 140038532748864 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/91350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 18:42:47.887198 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 18:42:47.888021 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 18:42:48.434439 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.549893s
I0121 18:42:48.457636 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 117.666 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 726 milliseconds) (per-host)
I0121 18:42:48.528781 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.798133s (batch_requests_ready=0.099246s, total_serialization_initiated=0.616017s, others=0.082870s)
I0121 18:42:48.531130 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.807797s (all_items=0.000035s, per_item={'default': '0.00003529'}, temp_paths=0.807762)
I0121 18:42:48.538634 140042139842112 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 18:42:48.538919 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.820642s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/91350.
I0121 18:42:48.541328 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=91350] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 18:42:48.543623 140042131449408 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 18:42:48.546815 140165176223552 standard_logger.py:34] {'step': Array(91350, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768992167.7154083, 'wait_for_prev_duration_secs': 0.0006506443023681641, 'time_between_consecutive_saves_sec': 344.47291684150696, 'checkpointer_blocking_start_time': 1768992167.7182224, 'checkpointer_blocking_duration_secs': 0.8226954936981201, 'get_old_steps_start_time': 1768992168.5409827, 'get_old_steps_duration_secs': 0.00019431114196777344, 'checkpoint_manager_blocking_start_time': 1768992167.714494, 'checkpoint_manager_blocking_duration_secs': 0.830714225769043}
I0121 18:42:48.552179 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/91350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 18:42:50.106231 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.643024s (commit=1.487730s, array_metadata_write=0.155295s)
I0121 18:42:50.110031 140042139842112 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 35.948 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 18:42:50.110492 140042139842112 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.570682s.
I0121 18:42:50.122908 140042139842112 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 18:42:50.221447 140042139842112 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.107709s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/91350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 18:42:50.223850 140042139842112 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/91350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/91350.orbax-checkpoint-tmp/default
I0121 18:42:50.229359 140042139842112 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/91350.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/91350
I0121 18:42:50.247416 140042139842112 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/91350`.
I0121 18:42:50.249871 140042139842112 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.531604s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/91350
I0121 18:42:50.250383 140042139842112 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.710566s.
I0121 18:42:50.251073 140042131449408 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 18:42:50.251601 140042131449408 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 18:42:50.325025 140042131449408 deleter.py:273] Deleted step 90450.
I0121 18:42:50.325383 140042131449408 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=91350] CheckpointManager Save Finalize is syncing with other hosts...
I0121 18:42:50.325717 140042131449408 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=91350] CheckpointManager Save Finalize is done on all hosts.
step: 91800,  loss data: 6.516e-04, loss res: 1.375e-03, time: 1.729e+02
step: 92250,  loss data: 7.099e-04, loss res: 7.028e-04, time: 1.720e+02
I0121 18:48:33.493053 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 18:48:33.495773 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 92250
I0121 18:48:33.497841 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/92250.
I0121 18:48:33.524227 140040546014784 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/92250.orbax-checkpoint-tmp
I0121 18:48:33.626353 140042257290816 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/92250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 18:48:33.665548 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 18:48:33.666209 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 18:48:34.246660 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.583780s
I0121 18:48:34.270653 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 112.496 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 760 milliseconds) (per-host)
I0121 18:48:34.281414 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.771252s (batch_requests_ready=0.095550s, total_serialization_initiated=0.647500s, others=0.028202s)
I0121 18:48:34.283303 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.781608s (all_items=0.000097s, per_item={'default': '0.00009704'}, temp_paths=0.781511)
I0121 18:48:34.345561 140042165020224 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 18:48:34.346335 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.850021s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/92250.
I0121 18:48:34.348326 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=92250] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 18:48:34.354122 140042173412928 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 18:48:34.356447 140165176223552 standard_logger.py:34] {'step': Array(92250, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768992513.4928231, 'wait_for_prev_duration_secs': 0.0009253025054931641, 'time_between_consecutive_saves_sec': 343.1668953895569, 'checkpointer_blocking_start_time': 1768992513.496226, 'checkpointer_blocking_duration_secs': 0.8516213893890381, 'get_old_steps_start_time': 1768992514.34792, 'get_old_steps_duration_secs': 0.00024509429931640625, 'checkpoint_manager_blocking_start_time': 1768992513.4912388, 'checkpoint_manager_blocking_duration_secs': 0.8638584613800049}
I0121 18:48:34.372424 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/92250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 18:48:35.989299 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.734989s (commit=1.612220s, array_metadata_write=0.122769s)
I0121 18:48:35.992438 140042165020224 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 34.458 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 18:48:35.992933 140042165020224 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.646080s.
I0121 18:48:36.007317 140042165020224 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 18:48:36.127593 140042165020224 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.131258s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/92250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 18:48:36.129799 140042165020224 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/92250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/92250.orbax-checkpoint-tmp/default
I0121 18:48:36.135299 140042165020224 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/92250.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/92250
I0121 18:48:36.150080 140042165020224 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/92250`.
I0121 18:48:36.151879 140042165020224 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.655509s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/92250
I0121 18:48:36.152788 140042165020224 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.805918s.
I0121 18:48:36.153995 140042173412928 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 18:48:36.155825 140042173412928 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 18:48:36.211567 140042173412928 deleter.py:273] Deleted step 91350.
I0121 18:48:36.212120 140042173412928 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=92250] CheckpointManager Save Finalize is syncing with other hosts...
I0121 18:48:36.212792 140042173412928 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=92250] CheckpointManager Save Finalize is done on all hosts.
step: 92700,  loss data: 3.395e-04, loss res: 5.384e-04, time: 1.708e+02
step: 93150,  loss data: 4.832e-04, loss res: 5.824e-04, time: 1.718e+02
I0121 18:54:16.997745 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 18:54:16.999910 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 93150
I0121 18:54:17.001338 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/93150.
I0121 18:54:17.032843 140040017536576 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/93150.orbax-checkpoint-tmp
I0121 18:54:17.134208 140039052834368 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/93150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 18:54:17.173302 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 18:54:17.174468 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 18:54:17.752918 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.582023s
I0121 18:54:17.770285 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 113.185 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 755 milliseconds) (per-host)
I0121 18:54:17.792430 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.777934s (batch_requests_ready=0.104208s, total_serialization_initiated=0.640238s, others=0.033489s)
I0121 18:54:17.849759 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.844280s (all_items=0.000037s, per_item={'default': '0.00003672'}, temp_paths=0.844244)
I0121 18:54:17.854363 140042148234816 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 18:54:17.854558 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.854156s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/93150.
I0121 18:54:17.858852 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=93150] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 18:54:17.859916 140042156627520 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 18:54:17.862238 140165176223552 standard_logger.py:34] {'step': Array(93150, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768992856.9976423, 'wait_for_prev_duration_secs': 0.0008087158203125, 'time_between_consecutive_saves_sec': 340.7845187187195, 'checkpointer_blocking_start_time': 1768992857.0003376, 'checkpointer_blocking_duration_secs': 0.8581104278564453, 'get_old_steps_start_time': 1768992857.8585198, 'get_old_steps_duration_secs': 0.00019025802612304688, 'checkpoint_manager_blocking_start_time': 1768992856.996756, 'checkpoint_manager_blocking_duration_secs': 0.8644707202911377}
I0121 18:54:17.871744 140042274076224 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/93150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 18:54:19.513271 140042265683520 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.737286s (commit=1.594044s, array_metadata_write=0.143242s)
I0121 18:54:19.517391 140042148234816 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 34.174 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 18:54:19.517854 140042148234816 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.660030s.
I0121 18:54:19.535173 140042148234816 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 18:54:19.607678 140042148234816 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.086494s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/93150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 18:54:19.609874 140042148234816 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/93150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/93150.orbax-checkpoint-tmp/default
I0121 18:54:19.615239 140042148234816 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/93150.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/93150
I0121 18:54:19.643318 140042148234816 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/93150`.
I0121 18:54:19.644814 140042148234816 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.644434s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/93150
I0121 18:54:19.645289 140042148234816 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.787460s.
I0121 18:54:19.646240 140042156627520 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 18:54:19.646822 140042156627520 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 18:54:19.709274 140042156627520 deleter.py:273] Deleted step 92250.
I0121 18:54:19.709722 140042156627520 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=93150] CheckpointManager Save Finalize is syncing with other hosts...
I0121 18:54:19.710234 140042156627520 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=93150] CheckpointManager Save Finalize is done on all hosts.
step: 93600,  loss data: 7.660e-04, loss res: 1.227e-03, time: 1.733e+02
step: 94050,  loss data: 7.689e-04, loss res: 1.070e-03, time: 1.733e+02
I0121 19:00:04.487874 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 19:00:04.490177 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 94050
I0121 19:00:04.491736 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/94050.
I0121 19:00:04.520868 140039975573056 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/94050.orbax-checkpoint-tmp
I0121 19:00:04.612635 140043725809216 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/94050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 19:00:04.660681 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 19:00:04.662319 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 19:00:05.204566 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.546747s
I0121 19:00:05.230123 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 118.166 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 723 milliseconds) (per-host)
I0121 19:00:05.245162 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.739648s (batch_requests_ready=0.096182s, total_serialization_initiated=0.608943s, others=0.034523s)
I0121 19:00:05.270851 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.773473s (all_items=0.000048s, per_item={'default': '0.00004768'}, temp_paths=0.773425)
I0121 19:00:05.314870 140041879799360 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 19:00:05.315118 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.824447s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/94050.
I0121 19:00:05.320760 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=94050] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 19:00:05.323236 140045084255808 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 19:00:05.326602 140165176223552 standard_logger.py:34] {'step': Array(94050, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768993204.4877188, 'wait_for_prev_duration_secs': 0.0007276535034179688, 'time_between_consecutive_saves_sec': 344.77721786499023, 'checkpointer_blocking_start_time': 1768993204.490608, 'checkpointer_blocking_duration_secs': 0.8296918869018555, 'get_old_steps_start_time': 1768993205.3203921, 'get_old_steps_duration_secs': 0.00020503997802734375, 'checkpoint_manager_blocking_start_time': 1768993204.4866285, 'checkpoint_manager_blocking_duration_secs': 0.8378446102142334}
I0121 19:00:05.374821 140042265683520 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/94050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 19:00:07.570614 140042257290816 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 2.347949s (commit=2.203565s, array_metadata_write=0.144385s)
I0121 19:00:07.576156 140041879799360 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 27.856 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 3 seconds) (per-host)
I0121 19:00:07.576968 140041879799360 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 2.261472s.
I0121 19:00:07.609701 140041879799360 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 19:00:07.799649 140041879799360 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.212639s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/94050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 19:00:07.802280 140041879799360 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/94050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/94050.orbax-checkpoint-tmp/default
I0121 19:00:07.811007 140041879799360 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/94050.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/94050
I0121 19:00:07.855750 140041879799360 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/94050`.
I0121 19:00:07.857544 140041879799360 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 3.366888s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/94050
I0121 19:00:07.858100 140041879799360 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 2.542614s.
I0121 19:00:07.859104 140045084255808 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 19:00:07.859796 140045084255808 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 19:00:07.993549 140045084255808 deleter.py:273] Deleted step 93150.
I0121 19:00:07.994359 140045084255808 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=94050] CheckpointManager Save Finalize is syncing with other hosts...
I0121 19:00:07.995144 140045084255808 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=94050] CheckpointManager Save Finalize is done on all hosts.
step: 94500,  loss data: 5.154e-04, loss res: 4.762e-04, time: 1.739e+02
Epoch 210, getting batches from DataLoader...
step: 94950,  loss data: 9.839e-04, loss res: 4.545e-04, time: 1.734e+02
I0121 19:05:52.633545 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 19:05:52.635690 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 94950
I0121 19:05:52.637228 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/94950.
I0121 19:05:52.664173 140039036048960 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/94950.orbax-checkpoint-tmp
I0121 19:05:52.770279 140039044441664 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/94950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 19:05:52.810773 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 19:05:52.811519 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 19:05:53.393672 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.585927s
I0121 19:05:53.432692 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 109.382 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 781 milliseconds) (per-host)
I0121 19:05:53.438302 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.787676s (batch_requests_ready=0.104108s, total_serialization_initiated=0.645873s, others=0.037695s)
I0121 19:05:53.491339 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.850050s (all_items=0.000071s, per_item={'default': '0.00007057'}, temp_paths=0.849980)
I0121 19:05:53.501542 140042131449408 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 19:05:53.501884 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.865710s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/94950.
I0121 19:05:53.503116 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=94950] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 19:05:53.504220 140041879799360 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 19:05:53.507061 140165176223552 standard_logger.py:34] {'step': Array(94950, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768993552.6334105, 'wait_for_prev_duration_secs': 0.0006277561187744141, 'time_between_consecutive_saves_sec': 344.6378092765808, 'checkpointer_blocking_start_time': 1768993552.6361225, 'checkpointer_blocking_duration_secs': 0.8666796684265137, 'get_old_steps_start_time': 1768993553.5028534, 'get_old_steps_duration_secs': 0.00016498565673828125, 'checkpoint_manager_blocking_start_time': 1768993552.6323185, 'checkpoint_manager_blocking_duration_secs': 0.8737266063690186}
I0121 19:05:53.562834 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/94950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 19:05:55.019424 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.580731s (commit=1.445495s, array_metadata_write=0.135235s)
I0121 19:05:55.024198 140042131449408 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 36.036 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 19:05:55.024705 140042131449408 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.522604s.
I0121 19:05:55.038959 140042131449408 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 19:05:55.114737 140042131449408 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.086709s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/94950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 19:05:55.117249 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/94950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/94950.orbax-checkpoint-tmp/default
I0121 19:05:55.122033 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/94950.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/94950
I0121 19:05:55.190312 140042131449408 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/94950`.
I0121 19:05:55.192101 140042131449408 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.555926s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/94950
I0121 19:05:55.192601 140042131449408 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.690495s.
I0121 19:05:55.193570 140041879799360 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 19:05:55.194081 140041879799360 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 19:05:55.245191 140041879799360 deleter.py:273] Deleted step 94050.
I0121 19:05:55.245565 140041879799360 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=94950] CheckpointManager Save Finalize is syncing with other hosts...
I0121 19:05:55.245912 140041879799360 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=94950] CheckpointManager Save Finalize is done on all hosts.
step: 95400,  loss data: 6.093e-04, loss res: 4.607e-04, time: 1.720e+02
step: 95850,  loss data: 6.901e-04, loss res: 4.996e-04, time: 1.708e+02
I0121 19:11:36.320899 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 19:11:36.324552 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 95850
I0121 19:11:36.326133 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/95850.
I0121 19:11:36.362248 140039975573056 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/95850.orbax-checkpoint-tmp
I0121 19:11:36.448222 140038515963456 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/95850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 19:11:36.489841 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 19:11:36.491385 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 19:11:37.074436 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.587254s
I0121 19:11:37.082454 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 114.752 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 745 milliseconds) (per-host)
I0121 19:11:37.105500 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.768497s (batch_requests_ready=0.095639s, total_serialization_initiated=0.643576s, others=0.029283s)
I0121 19:11:37.111342 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.781543s (all_items=0.000034s, per_item={'default': '0.00003409'}, temp_paths=0.781509)
I0121 19:11:37.179524 140042131449408 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 19:11:37.180359 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.855221s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/95850.
I0121 19:11:37.185794 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=95850] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 19:11:37.187822 140041879799360 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 19:11:37.194627 140165176223552 standard_logger.py:34] {'step': Array(95850, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768993896.320787, 'wait_for_prev_duration_secs': 0.0007219314575195312, 'time_between_consecutive_saves_sec': 341.0746715068817, 'checkpointer_blocking_start_time': 1768993896.3250816, 'checkpointer_blocking_duration_secs': 0.8598639965057373, 'get_old_steps_start_time': 1768993897.185054, 'get_old_steps_duration_secs': 0.0004031658172607422, 'checkpoint_manager_blocking_start_time': 1768993896.3194537, 'checkpoint_manager_blocking_duration_secs': 0.8738663196563721}
I0121 19:11:37.215149 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/95850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 19:11:38.584195 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.495884s (commit=1.362788s, array_metadata_write=0.133096s)
I0121 19:11:38.587801 140042131449408 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 38.002 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 19:11:38.588314 140042131449408 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.406935s.
I0121 19:11:38.600211 140042131449408 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 19:11:38.753205 140042131449408 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.161987s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/95850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 19:11:38.755449 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/95850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/95850.orbax-checkpoint-tmp/default
I0121 19:11:38.760051 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/95850.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/95850
I0121 19:11:38.772841 140042131449408 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/95850`.
I0121 19:11:38.774001 140042131449408 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.448891s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/95850
I0121 19:11:38.774294 140042131449408 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.592920s.
I0121 19:11:38.775002 140041879799360 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 19:11:38.775441 140041879799360 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 19:11:38.818460 140041879799360 deleter.py:273] Deleted step 94950.
I0121 19:11:38.819006 140041879799360 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=95850] CheckpointManager Save Finalize is syncing with other hosts...
I0121 19:11:38.819812 140041879799360 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=95850] CheckpointManager Save Finalize is done on all hosts.
step: 96300,  loss data: 5.935e-04, loss res: 1.175e-03, time: 1.701e+02
step: 96750,  loss data: 1.550e-03, loss res: 1.101e-03, time: 1.710e+02
I0121 19:17:18.259031 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 19:17:18.261346 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 96750
I0121 19:17:18.262988 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/96750.
I0121 19:17:18.294257 140038004270656 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/96750.orbax-checkpoint-tmp
I0121 19:17:18.371019 140039975573056 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/96750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 19:17:18.428226 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 19:17:18.429629 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 19:17:19.043796 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.617986s
I0121 19:17:19.109512 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 102.544 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 834 milliseconds) (per-host)
I0121 19:17:19.111339 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.836076s (batch_requests_ready=0.097663s, total_serialization_initiated=0.677326s, others=0.061087s)
I0121 19:17:19.112856 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.845917s (all_items=0.000036s, per_item={'default': '0.00003600'}, temp_paths=0.845881)
I0121 19:17:19.121259 140042131449408 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 19:17:19.121554 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.859644s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/96750.
I0121 19:17:19.124969 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=96750] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 19:17:19.126652 140042173412928 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 19:17:19.130189 140165176223552 standard_logger.py:34] {'step': Array(96750, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768994238.2589083, 'wait_for_prev_duration_secs': 0.000701904296875, 'time_between_consecutive_saves_sec': 339.43860363960266, 'checkpointer_blocking_start_time': 1768994238.2618482, 'checkpointer_blocking_duration_secs': 0.862715482711792, 'get_old_steps_start_time': 1768994239.124634, 'get_old_steps_duration_secs': 0.0001895427703857422, 'checkpoint_manager_blocking_start_time': 1768994238.257853, 'checkpoint_manager_blocking_duration_secs': 0.8702962398529053}
I0121 19:17:19.141018 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/96750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 19:17:20.712457 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.602065s (commit=1.427771s, array_metadata_write=0.174294s)
I0121 19:17:20.716341 140042131449408 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 35.039 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 19:17:20.716721 140042131449408 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.594215s.
I0121 19:17:20.730360 140042131449408 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 19:17:20.805259 140042131449408 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.085346s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/96750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 19:17:20.807397 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/96750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/96750.orbax-checkpoint-tmp/default
I0121 19:17:20.813082 140042131449408 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/96750.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/96750
I0121 19:17:20.828555 140042131449408 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/96750`.
I0121 19:17:20.830086 140042131449408 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.568195s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/96750
I0121 19:17:20.830596 140042131449408 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.708080s.
I0121 19:17:20.831540 140042173412928 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 19:17:20.832020 140042173412928 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 19:17:20.887565 140042173412928 deleter.py:273] Deleted step 95850.
I0121 19:17:20.887924 140042173412928 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=96750] CheckpointManager Save Finalize is syncing with other hosts...
I0121 19:17:20.888242 140042173412928 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=96750] CheckpointManager Save Finalize is done on all hosts.
step: 97200,  loss data: 8.580e-04, loss res: 4.593e-04, time: 1.736e+02
step: 97650,  loss data: 9.989e-04, loss res: 8.140e-04, time: 1.733e+02
I0121 19:23:06.120077 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 19:23:06.122317 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 97650
I0121 19:23:06.123769 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/97650.
I0121 19:23:06.155176 140040000751168 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/97650.orbax-checkpoint-tmp
I0121 19:23:06.263590 140041879799360 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/97650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 19:23:06.294287 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 19:23:06.294909 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 19:23:06.873976 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.582344s
I0121 19:23:07.427516 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 66.205 MiB/s (total gbytes: 85.5 MiB) (time elapsed: a second) (per-host)
I0121 19:23:07.450411 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 1.314852s (batch_requests_ready=0.102402s, total_serialization_initiated=0.637463s, others=0.574987s)
I0121 19:23:07.451433 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 1.323762s (all_items=0.000036s, per_item={'default': '0.00003624'}, temp_paths=1.323726)
I0121 19:23:07.485031 140042148234816 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 19:23:07.487092 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 1.364262s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/97650.
I0121 19:23:07.492869 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=97650] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 19:23:07.494537 140040554407488 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 19:23:07.497751 140165176223552 standard_logger.py:34] {'step': Array(97650, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768994586.1199536, 'wait_for_prev_duration_secs': 0.0006265640258789062, 'time_between_consecutive_saves_sec': 345.23150157928467, 'checkpointer_blocking_start_time': 1768994586.1227744, 'checkpointer_blocking_duration_secs': 1.3696599006652832, 'get_old_steps_start_time': 1768994587.492521, 'get_old_steps_duration_secs': 0.00019860267639160156, 'checkpoint_manager_blocking_start_time': 1768994586.118942, 'checkpoint_manager_blocking_duration_secs': 1.3771350383758545}
I0121 19:23:07.508635 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/97650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 19:23:08.888873 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.467844s (commit=1.328927s, array_metadata_write=0.138917s)
I0121 19:23:08.892339 140042148234816 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 31.025 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 19:23:08.892736 140042148234816 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.406058s.
I0121 19:23:08.905471 140042148234816 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 19:23:08.976080 140042148234816 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.080191s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/97650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 19:23:08.978234 140042148234816 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/97650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/97650.orbax-checkpoint-tmp/default
I0121 19:23:08.983464 140042148234816 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/97650.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/97650
I0121 19:23:09.015618 140042148234816 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/97650`.
I0121 19:23:09.017132 140042148234816 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.894318s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/97650
I0121 19:23:09.017595 140042148234816 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.530912s.
I0121 19:23:09.018517 140040554407488 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 19:23:09.018996 140040554407488 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 19:23:09.067786 140040554407488 deleter.py:273] Deleted step 96750.
I0121 19:23:09.068361 140040554407488 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=97650] CheckpointManager Save Finalize is syncing with other hosts...
I0121 19:23:09.069065 140040554407488 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=97650] CheckpointManager Save Finalize is done on all hosts.
step: 98100,  loss data: 5.126e-04, loss res: 3.566e-04, time: 1.729e+02
step: 98550,  loss data: 7.867e-04, loss res: 4.484e-04, time: 1.725e+02
I0121 19:28:52.913745 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 19:28:52.916476 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 98550
I0121 19:28:52.918412 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/98550.
I0121 19:28:52.950157 140039052834368 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/98550.orbax-checkpoint-tmp
I0121 19:28:53.055473 140042265683520 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/98550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 19:28:53.091863 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 19:28:53.092633 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 19:28:53.687153 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.598132s
I0121 19:28:53.735767 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 106.507 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 803 milliseconds) (per-host)
I0121 19:28:53.780961 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.848460s (batch_requests_ready=0.102340s, total_serialization_initiated=0.679070s, others=0.067050s)
I0121 19:28:53.785447 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.862766s (all_items=0.000093s, per_item={'default': '0.00009346'}, temp_paths=0.862672)
I0121 19:28:53.793540 140041879799360 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 19:28:53.794382 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.877406s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/98550.
I0121 19:28:53.797905 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=98550] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 19:28:53.800695 140042165020224 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 19:28:53.804023 140165176223552 standard_logger.py:34] {'step': Array(98550, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768994932.9135098, 'wait_for_prev_duration_secs': 0.0009608268737792969, 'time_between_consecutive_saves_sec': 343.84388613700867, 'checkpointer_blocking_start_time': 1768994932.916894, 'checkpointer_blocking_duration_secs': 0.880507230758667, 'get_old_steps_start_time': 1768994933.7974775, 'get_old_steps_duration_secs': 0.000274658203125, 'checkpoint_manager_blocking_start_time': 1768994932.912033, 'checkpoint_manager_blocking_duration_secs': 0.8906033039093018}
I0121 19:28:53.805835 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/98550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 19:28:55.246801 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.511482s (commit=1.423031s, array_metadata_write=0.088452s)
I0121 19:28:55.250010 140041879799360 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 36.908 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 19:28:55.250522 140041879799360 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.454932s.
I0121 19:28:55.262291 140041879799360 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 19:28:55.326472 140041879799360 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.072772s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/98550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 19:28:55.328526 140041879799360 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/98550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/98550.orbax-checkpoint-tmp/default
I0121 19:28:55.335520 140041879799360 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/98550.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/98550
I0121 19:28:55.355567 140041879799360 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/98550`.
I0121 19:28:55.357359 140041879799360 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.440396s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/98550
I0121 19:28:55.357852 140041879799360 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.562255s.
I0121 19:28:55.358875 140042165020224 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 19:28:55.359377 140042165020224 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 19:28:55.412909 140042165020224 deleter.py:273] Deleted step 97650.
I0121 19:28:55.413262 140042165020224 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=98550] CheckpointManager Save Finalize is syncing with other hosts...
I0121 19:28:55.413586 140042165020224 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=98550] CheckpointManager Save Finalize is done on all hosts.
step: 99000,  loss data: 9.417e-04, loss res: 8.538e-04, time: 1.718e+02
Epoch 220, getting batches from DataLoader...
step: 99450,  loss data: 7.655e-04, loss res: 8.386e-04, time: 1.715e+02
I0121 19:34:37.087694 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 19:34:37.090012 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 99450
I0121 19:34:37.091590 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/99450.
I0121 19:34:37.113198 140045084255808 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/99450.orbax-checkpoint-tmp
I0121 19:34:37.238970 140040554407488 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/99450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 19:34:37.288302 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 19:34:37.289184 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 19:34:37.896929 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.611456s
I0121 19:34:37.914386 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 105.896 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 807 milliseconds) (per-host)
I0121 19:34:37.916090 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.809494s (batch_requests_ready=0.116772s, total_serialization_initiated=0.674663s, others=0.018058s)
I0121 19:34:37.927785 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.832452s (all_items=0.000036s, per_item={'default': '0.00003624'}, temp_paths=0.832415)
I0121 19:34:38.001672 140041879799360 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 19:34:38.002071 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.911507s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/99450.
I0121 19:34:38.004395 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=99450] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 19:34:38.005715 140041871406656 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 19:34:38.011235 140165176223552 standard_logger.py:34] {'step': Array(99450, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768995277.0875685, 'wait_for_prev_duration_secs': 0.0006647109985351562, 'time_between_consecutive_saves_sec': 341.67378520965576, 'checkpointer_blocking_start_time': 1768995277.0905113, 'checkpointer_blocking_duration_secs': 0.9134631156921387, 'get_old_steps_start_time': 1768995278.004049, 'get_old_steps_duration_secs': 0.00020051002502441406, 'checkpoint_manager_blocking_start_time': 1768995277.0864675, 'checkpoint_manager_blocking_duration_secs': 0.9201540946960449}
I0121 19:34:38.027323 140042274076224 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/99450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 19:34:39.472035 140042265683520 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.556777s (commit=1.426004s, array_metadata_write=0.130773s)
I0121 19:34:39.475332 140041879799360 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 36.110 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 19:34:39.475839 140041879799360 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.473288s.
I0121 19:34:39.488902 140041879799360 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 19:34:39.563969 140041879799360 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.084848s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/99450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 19:34:39.566373 140041879799360 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/99450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/99450.orbax-checkpoint-tmp/default
I0121 19:34:39.571677 140041879799360 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/99450.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/99450
I0121 19:34:39.588101 140041879799360 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/99450`.
I0121 19:34:39.589663 140041879799360 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.499111s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/99450
I0121 19:34:39.590128 140041879799360 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.587573s.
I0121 19:34:39.590903 140041871406656 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 19:34:39.591874 140041871406656 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 19:34:39.663692 140041871406656 deleter.py:273] Deleted step 98550.
I0121 19:34:39.664132 140041871406656 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=99450] CheckpointManager Save Finalize is syncing with other hosts...
I0121 19:34:39.664630 140041871406656 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=99450] CheckpointManager Save Finalize is done on all hosts.
step: 99900,  loss data: 6.292e-04, loss res: 9.177e-04, time: 1.714e+02
step: 100350,  loss data: 1.212e-03, loss res: 5.509e-04, time: 1.713e+02
I0121 19:40:20.746189 140165176223552 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 19:40:20.749027 140165176223552 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 100350
I0121 19:40:20.751137 140165176223552 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/100350.
I0121 19:40:20.782012 140039983965760 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/100350.orbax-checkpoint-tmp
I0121 19:40:20.884189 140040009143872 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/100350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 19:40:20.914680 140165176223552 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 19:40:20.915344 140165176223552 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 19:40:21.519680 140165176223552 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.607671s
I0121 19:40:21.538341 140165176223552 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 110.381 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 774 milliseconds) (per-host)
I0121 19:40:21.539881 140165176223552 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.776638s (batch_requests_ready=0.095391s, total_serialization_initiated=0.662357s, others=0.018891s)
I0121 19:40:21.545880 140165176223552 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.790888s (all_items=0.000083s, per_item={'default': '0.00008297'}, temp_paths=0.790805)
I0121 19:40:21.626066 140042156627520 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 19:40:21.626948 140165176223552 async_checkpointer.py:561] Finished blocking save. Time taken: 0.877294s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/100350.
I0121 19:40:21.633533 140165176223552 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=100350] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 19:40:21.635310 140042148234816 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 19:40:21.639879 140165176223552 standard_logger.py:34] {'step': Array(100350, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768995620.7459333, 'wait_for_prev_duration_secs': 0.0009481906890869141, 'time_between_consecutive_saves_sec': 341.08104515075684, 'checkpointer_blocking_start_time': 1768995620.7495475, 'checkpointer_blocking_duration_secs': 0.8833451271057129, 'get_old_steps_start_time': 1768995621.633016, 'get_old_steps_duration_secs': 0.00030612945556640625, 'checkpoint_manager_blocking_start_time': 1768995620.744579, 'checkpoint_manager_blocking_duration_secs': 0.8936493396759033}
Training finished, saving final checkpoint...
I0121 19:40:21.646103 140165176223552 checkpoint_manager.py:2024] [process=0][thread=MainThread][step=100350][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete.
I0121 19:40:22.584366 140043725809216 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/100350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 19:40:25.767241 140042274076224 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 4.234614s (commit=4.110132s, array_metadata_write=0.124482s)
I0121 19:40:25.770503 140042156627520 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 17.081 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 5 seconds) (per-host)
I0121 19:40:25.770994 140042156627520 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 4.142742s.
I0121 19:40:25.784002 140042156627520 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 19:40:26.047223 140042156627520 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.272997s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/100350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 19:40:26.049431 140042156627520 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/100350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/100350.orbax-checkpoint-tmp/default
I0121 19:40:26.055118 140042156627520 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/100350.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/100350
I0121 19:40:26.261616 140042156627520 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/100350`.
I0121 19:40:26.263496 140042156627520 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 5.513880s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/100350
I0121 19:40:26.264009 140042156627520 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 4.635747s.
I0121 19:40:26.264630 140042148234816 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 19:40:26.343047 140042148234816 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 19:40:26.396692 140042148234816 deleter.py:273] Deleted step 99450.
I0121 19:40:26.396945 140042148234816 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=100350] CheckpointManager Save Finalize is syncing with other hosts...
I0121 19:40:26.397195 140042148234816 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=100350] CheckpointManager Save Finalize is done on all hosts.
I0121 19:40:26.397578 140165176223552 checkpoint_manager.py:2036] [process=0][thread=MainThread][step=100350][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=100350.
