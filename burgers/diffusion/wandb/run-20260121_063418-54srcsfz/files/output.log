Creating checkpoint manager...
I0121 06:34:20.517297 139627771470912 checkpoint_manager.py:709] [process=0][thread=MainThread] CheckpointManager init: checkpointers=None, item_names=None, item_handlers=None, handler_registry=None
I0121 06:34:20.517696 139627771470912 composite_checkpoint_handler.py:505] Initialized registry DefaultCheckpointHandlerRegistry({('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonSaveArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x7efa0479e770>, ('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonRestoreArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x7efa0479e770>}).
I0121 06:34:20.518146 139627771470912 abstract_checkpointer.py:35] orbax-checkpoint version: 0.11.32
I0121 06:34:20.518511 139627771470912 async_checkpointer.py:177] [process=0][thread=MainThread] Using barrier_sync_fn: <function get_barrier_sync_fn.<locals>.<lambda> at 0x7efa047a0af0> timeout: 600 secs and primary_host=0 for async checkpoint writes
I0121 06:34:20.520522 139627771470912 checkpoint_manager.py:1818] Found 0 checkpoint steps in /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt
I0121 06:34:20.520845 139627771470912 checkpoint_manager.py:929] [process=0][thread=MainThread] CheckpointManager created,  primary_host=0, CheckpointManagerOptions=CheckpointManagerOptions(save_interval_steps=1, max_to_keep=1, keep_time_interval=None, keep_period=None, should_keep_fn=None, best_fn=None, best_mode='max', keep_checkpoints_without_metrics=True, step_prefix=None, step_format_fixed_length=None, step_name_format=None, create=True, cleanup_tmp_directories=False, save_on_steps=frozenset(), single_host_load_and_broadcast=False, todelete_subdir=None, todelete_full_path=None, enable_background_delete=False, read_only=False, enable_async_checkpointing=True, async_options=None, multiprocessing_options=MultiprocessingOptions(primary_host=0, active_processes=None, barrier_sync_key_prefix=None), should_save_fn=None, file_options=FileOptions(path_permission_mode=None), save_root_metadata=True, temporary_path_class=None, save_decision_policy=None, preservation_policy=None, prevent_write_metrics=False, enable_should_save_is_saving_in_progress_check=True, enable_per_process_directory_creation=False, lightweight_initialize=False), root_directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt: <orbax.checkpoint.checkpoint_manager.CheckpointManager object at 0x7efa24761780>
Checkpoint manager created successfully
Pre-computing constants...
Constants pre-computed
Starting training loop...
Training configuration: use_pde=True, random_resolution=True
Epoch 0, getting batches from DataLoader...
First batch received, converting to JAX array...
First batch processed, converting to global array...
Calling train_step (JIT compilation will happen on first call)...
First train_step completed in 159.40s (includes JIT compilation)
step: 450,  loss data: 7.672e-03, loss res: 3.048e-02, time: 5.986e+02
I0121 06:44:19.604531 139627771470912 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 06:44:19.605279 139627771470912 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 450
I0121 06:44:19.606166 139627771470912 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/450.
I0121 06:44:19.610158 139627771470912 signaling_client.py:373] Using ThreadSafeKeyValueSignalingClient
I0121 06:44:19.611653 139627771470912 composite_checkpoint_handler.py:552] No entry found in handler registry for item: default and args with type: <class 'orbax.checkpoint._src.handlers.standard_checkpoint_handler.StandardSaveArgs'>. Falling back to global handler registry.
I0121 06:44:19.612750 139627771470912 pytree_checkpoint_handler.py:584] save_device_host_concurrent_bytes=None
I0121 06:44:19.613316 139627771470912 base_pytree_checkpoint_handler.py:409] Created BasePyTreeCheckpointHandler: use_ocdbt=True, use_zarr3=False, pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=<orbax.checkpoint._src.metadata.array_metadata_store.Store object at 0x7efd4adbea10>, enable_pinned_host_transfer=True, save_concurrent_bytes: 96000000000 (89.4 GiB), restore_concurrent_bytes: 96000000000 (89.4 GiB)
I0121 06:44:19.613904 139627771470912 composite_checkpoint_handler.py:237] Deferred registration for item: "default". Adding handler `<orbax.checkpoint._src.handlers.standard_checkpoint_handler.StandardCheckpointHandler object at 0x7ef8687efa00>` for item "default" and save args `<class 'orbax.checkpoint._src.handlers.standard_checkpoint_handler.StandardSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.standard_checkpoint_handler.StandardRestoreArgs'>` to `_handler_registry`.
I0121 06:44:19.635258 139546415056448 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/450.orbax-checkpoint-tmp
I0121 06:44:19.680113 139546423449152 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 06:44:19.680364 139551037175360 checkpoint.py:188] Wrote Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1768949059671503689, 'commit_timestamp_nsecs': None, 'custom_metadata': {}}, json={"item_handlers": null, "metrics": {}, "performance_metrics": {}, "init_timestamp_nsecs": 1768949059671503689, "commit_timestamp_nsecs": null, "custom_metadata": {}} to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/450.orbax-checkpoint-tmp/_CHECKPOINT_METADATA
I0121 06:44:19.720440 139627771470912 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 06:44:19.722098 139627771470912 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 06:44:20.074078 139627771470912 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.356143s
I0121 06:44:20.086122 139627771470912 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 183.121 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 467 milliseconds) (per-host)
I0121 06:44:20.098039 139627771470912 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.479064s (batch_requests_ready=0.055767s, total_serialization_initiated=0.400017s, others=0.023280s)
I0121 06:44:20.120040 139627771470912 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.509011s (all_items=0.002585s, per_item={'default': '0.00258470'}, temp_paths=0.506427)
I0121 06:44:20.187135 139550500304448 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 06:44:20.187405 139627771470912 async_checkpointer.py:561] Finished blocking save. Time taken: 0.581845s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/450.
I0121 06:44:20.190134 139627771470912 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=450] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 06:44:20.190644 139550483519040 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 06:44:20.212196 139627771470912 standard_logger.py:34] {'step': Array(450, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768949059.604488, 'wait_for_prev_duration_secs': 0.00030350685119628906, 'time_between_consecutive_saves_sec': None, 'checkpointer_blocking_start_time': 1768949059.605501, 'checkpointer_blocking_duration_secs': 0.5844066143035889, 'get_old_steps_start_time': 1768949060.189955, 'get_old_steps_duration_secs': 0.0001010894775390625, 'checkpoint_manager_blocking_start_time': 1768949059.6043015, 'checkpoint_manager_blocking_duration_secs': 0.5871131420135498}
I0121 06:44:20.217912 139551020389952 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 06:44:21.513669 139550533875264 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.422066s (commit=1.323420s, array_metadata_write=0.098647s)
I0121 06:44:21.516712 139550500304448 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 45.071 MiB/s (total gbytes: 85.5 MiB) (time elapsed: a second) (per-host)
I0121 06:44:21.517226 139550500304448 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.328605s.
I0121 06:44:21.519719 139550500304448 checkpoint.py:228] Read Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1768949059671503689, 'commit_timestamp_nsecs': None, 'custom_metadata': {}} from /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/450.orbax-checkpoint-tmp/_CHECKPOINT_METADATA
I0121 06:44:21.531224 139550500304448 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 06:44:21.570059 139551037175360 checkpoint.py:247] Updated Metadata={'item_handlers': {'default': 'orbax.checkpoint._src.handlers.standard_checkpoint_handler.StandardCheckpointHandler'}, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1768949059671503689, 'commit_timestamp_nsecs': None, 'custom_metadata': {}} to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/450.orbax-checkpoint-tmp/_CHECKPOINT_METADATA
I0121 06:44:21.597258 139550500304448 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.076372s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 06:44:21.598607 139550500304448 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/450.orbax-checkpoint-tmp/default
I0121 06:44:21.603007 139550500304448 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/450.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/450
I0121 06:44:21.616053 139550500304448 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/450`.
I0121 06:44:21.617050 139550500304448 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.011521s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/450
I0121 06:44:21.617300 139550500304448 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.428683s.
I0121 06:44:21.617833 139550483519040 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 06:44:21.618327 139550483519040 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 06:44:21.618674 139550483519040 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=450] CheckpointManager Save Finalize is syncing with other hosts...
I0121 06:44:21.619029 139550483519040 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=450] CheckpointManager Save Finalize is done on all hosts.
step: 900,  loss data: 9.765e-03, loss res: 3.436e-02, time: 1.290e+02
step: 1350,  loss data: 1.642e-02, loss res: 2.611e-02, time: 1.289e+02
I0121 06:48:38.268177 139627771470912 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 06:48:38.337149 139627771470912 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 1350
I0121 06:48:38.338123 139627771470912 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/1350.
I0121 06:48:38.353235 139550508697152 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/1350.orbax-checkpoint-tmp
I0121 06:48:38.444585 139545727182400 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/1350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 06:48:38.459860 139627771470912 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 06:48:38.460635 139627771470912 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 06:48:38.770586 139627771470912 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.313087s
I0121 06:48:38.772244 139627771470912 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 201.281 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 424 milliseconds) (per-host)
I0121 06:48:38.777674 139627771470912 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.430412s (batch_requests_ready=0.066495s, total_serialization_initiated=0.357555s, others=0.006361s)
I0121 06:48:39.387079 139627771470912 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 1.045421s (all_items=0.000035s, per_item={'default': '0.00003457'}, temp_paths=1.045387)
I0121 06:48:39.466930 139549175428672 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 06:48:39.467370 139627771470912 async_checkpointer.py:561] Finished blocking save. Time taken: 1.129784s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/1350.
I0121 06:48:39.469277 139627771470912 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=1350] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 06:48:39.470620 139549167035968 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 06:48:39.476788 139627771470912 standard_logger.py:34] {'step': Array(1350, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768949318.2681098, 'wait_for_prev_duration_secs': 0.0004324913024902344, 'time_between_consecutive_saves_sec': 256.64887499809265, 'checkpointer_blocking_start_time': 1768949318.3375535, 'checkpointer_blocking_duration_secs': 1.1314518451690674, 'get_old_steps_start_time': 1768949319.46906, 'get_old_steps_duration_secs': 0.00013756752014160156, 'checkpoint_manager_blocking_start_time': 1768949318.1995354, 'checkpoint_manager_blocking_duration_secs': 1.2725377082824707}
I0121 06:48:39.490912 139550533875264 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/1350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 06:48:40.866423 139550525482560 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.485682s (commit=1.388399s, array_metadata_write=0.097283s)
I0121 06:48:40.869475 139549175428672 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 33.911 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 06:48:40.869856 139549175428672 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.402244s.
I0121 06:48:40.880762 139549175428672 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 06:48:40.945319 139549175428672 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.072670s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/1350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 06:48:40.946679 139549175428672 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/1350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/1350.orbax-checkpoint-tmp/default
I0121 06:48:40.950731 139549175428672 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/1350.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/1350
I0121 06:48:40.969952 139549175428672 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/1350`.
I0121 06:48:40.970887 139549175428672 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.633316s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/1350
I0121 06:48:40.971103 139549175428672 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.503494s.
I0121 06:48:40.971627 139549167035968 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 06:48:40.972092 139549167035968 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 06:48:41.027129 139549167035968 deleter.py:273] Deleted step 450.
I0121 06:48:41.027394 139549167035968 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=1350] CheckpointManager Save Finalize is syncing with other hosts...
I0121 06:48:41.027673 139549167035968 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=1350] CheckpointManager Save Finalize is done on all hosts.
step: 1800,  loss data: 8.207e-03, loss res: 2.029e-02, time: 1.292e+02
step: 2250,  loss data: 7.971e-03, loss res: 1.338e-02, time: 1.289e+02
I0121 06:52:57.550508 139627771470912 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 06:52:57.551894 139627771470912 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 2250
I0121 06:52:57.552850 139627771470912 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/2250.
I0121 06:52:57.583502 139546826102336 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/2250.orbax-checkpoint-tmp
I0121 06:52:57.652409 139547438474816 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/2250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 06:52:57.673755 139627771470912 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 06:52:57.674450 139627771470912 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 06:52:58.043009 139627771470912 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.371803s
I0121 06:52:58.044835 139627771470912 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 176.634 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 484 milliseconds) (per-host)
I0121 06:52:58.051128 139627771470912 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.490573s (batch_requests_ready=0.064231s, total_serialization_initiated=0.419019s, others=0.007323s)
I0121 06:52:58.062196 139627771470912 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.506174s (all_items=0.000019s, per_item={'default': '0.00001931'}, temp_paths=0.506155)
I0121 06:52:58.140310 139550466733632 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 06:52:58.141506 139627771470912 async_checkpointer.py:561] Finished blocking save. Time taken: 0.589341s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/2250.
I0121 06:52:58.143765 139627771470912 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=2250] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 06:52:58.144235 139549175428672 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 06:52:58.145730 139627771470912 standard_logger.py:34] {'step': Array(2250, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768949577.5504375, 'wait_for_prev_duration_secs': 0.00036406517028808594, 'time_between_consecutive_saves_sec': 256.5223934650421, 'checkpointer_blocking_start_time': 1768949577.5521283, 'checkpointer_blocking_duration_secs': 0.5914008617401123, 'get_old_steps_start_time': 1768949578.143569, 'get_old_steps_duration_secs': 0.00010919570922851562, 'checkpoint_manager_blocking_start_time': 1768949577.5498183, 'checkpoint_manager_blocking_duration_secs': 0.5952460765838623}
I0121 06:52:58.169994 139550533875264 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/2250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 06:53:00.181595 139550525482560 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 2.137030s (commit=1.353667s, array_metadata_write=0.783364s)
I0121 06:53:00.184697 139550466733632 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 32.595 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 06:53:00.185174 139550466733632 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 2.043506s.
I0121 06:53:00.196870 139550466733632 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 06:53:00.261136 139550466733632 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.072950s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/2250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 06:53:00.262363 139550466733632 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/2250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/2250.orbax-checkpoint-tmp/default
I0121 06:53:00.267022 139550466733632 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/2250.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/2250
I0121 06:53:00.280445 139550466733632 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/2250`.
I0121 06:53:00.281571 139550466733632 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.729415s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/2250
I0121 06:53:00.281843 139550466733632 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 2.140178s.
I0121 06:53:00.282292 139549175428672 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 06:53:00.282796 139549175428672 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 06:53:00.338152 139549175428672 deleter.py:273] Deleted step 1350.
I0121 06:53:00.338414 139549175428672 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=2250] CheckpointManager Save Finalize is syncing with other hosts...
I0121 06:53:00.338854 139549175428672 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=2250] CheckpointManager Save Finalize is done on all hosts.
step: 2700,  loss data: 1.209e-02, loss res: 1.445e-02, time: 1.283e+02
step: 3150,  loss data: 1.048e-02, loss res: 1.688e-02, time: 1.284e+02
I0121 06:57:14.880292 139627771470912 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 06:57:14.881623 139627771470912 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 3150
I0121 06:57:14.882390 139627771470912 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/3150.
I0121 06:57:14.901441 139547421689408 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/3150.orbax-checkpoint-tmp
I0121 06:57:14.959208 139545752360512 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/3150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 06:57:14.992707 139627771470912 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 06:57:14.993379 139627771470912 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 06:57:15.355286 139627771470912 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.364854s
I0121 06:57:15.383561 139627771470912 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 173.068 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 494 milliseconds) (per-host)
I0121 06:57:15.394870 139627771470912 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.505581s (batch_requests_ready=0.059438s, total_serialization_initiated=0.423712s, others=0.022431s)
I0121 06:57:15.395725 139627771470912 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.511104s (all_items=0.000019s, per_item={'default': '0.00001860'}, temp_paths=0.511085)
I0121 06:57:15.460383 139550508697152 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 06:57:15.460785 139627771470912 async_checkpointer.py:561] Finished blocking save. Time taken: 0.578893s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/3150.
I0121 06:57:15.464333 139627771470912 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=3150] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 06:57:15.465214 139549167035968 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 06:57:15.467318 139627771470912 standard_logger.py:34] {'step': Array(3150, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768949834.8802328, 'wait_for_prev_duration_secs': 0.0003650188446044922, 'time_between_consecutive_saves_sec': 254.54100823402405, 'checkpointer_blocking_start_time': 1768949834.8818452, 'checkpointer_blocking_duration_secs': 0.582202672958374, 'get_old_steps_start_time': 1768949835.4641116, 'get_old_steps_duration_secs': 0.00011849403381347656, 'checkpoint_manager_blocking_start_time': 1768949834.8796637, 'checkpoint_manager_blocking_duration_secs': 0.5864698886871338}
I0121 06:57:15.487174 139550533875264 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/3150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 06:57:16.920104 139550525482560 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.530867s (commit=1.383007s, array_metadata_write=0.147860s)
I0121 06:57:16.923371 139550508697152 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 42.050 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 06:57:16.923787 139550508697152 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.460795s.
I0121 06:57:16.947679 139550508697152 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 06:57:17.004523 139550508697152 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.077516s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/3150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 06:57:17.005953 139550508697152 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/3150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/3150.orbax-checkpoint-tmp/default
I0121 06:57:17.010251 139550508697152 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/3150.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/3150
I0121 06:57:17.024295 139550508697152 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/3150`.
I0121 06:57:17.026401 139550508697152 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.144535s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/3150
I0121 06:57:17.027199 139550508697152 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.564209s.
I0121 06:57:17.027789 139549167035968 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 06:57:17.028405 139549167035968 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 06:57:17.077940 139549167035968 deleter.py:273] Deleted step 2250.
I0121 06:57:17.078229 139549167035968 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=3150] CheckpointManager Save Finalize is syncing with other hosts...
I0121 06:57:17.078510 139549167035968 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=3150] CheckpointManager Save Finalize is done on all hosts.
step: 3600,  loss data: 1.981e-03, loss res: 2.662e-02, time: 1.290e+02
step: 4050,  loss data: 1.304e-03, loss res: 6.513e-03, time: 1.293e+02
I0121 07:01:33.759912 139627771470912 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 07:01:33.761188 139627771470912 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 4050
I0121 07:01:33.762010 139627771470912 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4050.
I0121 07:01:33.786075 139551020389952 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4050.orbax-checkpoint-tmp
I0121 07:01:33.828763 139546389878336 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 07:01:33.883275 139627771470912 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 07:01:33.884043 139627771470912 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 07:01:34.168277 139627771470912 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.287990s
I0121 07:01:34.200432 139627771470912 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 198.073 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 431 milliseconds) (per-host)
I0121 07:01:34.200717 139627771470912 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.432158s (batch_requests_ready=0.060462s, total_serialization_initiated=0.360528s, others=0.011168s)
I0121 07:01:34.211912 139627771470912 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.447842s (all_items=0.000018s, per_item={'default': '0.00001764'}, temp_paths=0.447824)
I0121 07:01:34.273941 139549158643264 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 07:01:34.276430 139627771470912 async_checkpointer.py:561] Finished blocking save. Time taken: 0.514991s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4050.
I0121 07:01:34.278637 139627771470912 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=4050] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 07:01:34.280463 139549133465152 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 07:01:34.288648 139627771470912 standard_logger.py:34] {'step': Array(4050, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768950093.7598505, 'wait_for_prev_duration_secs': 0.00031876564025878906, 'time_between_consecutive_saves_sec': 256.6811590194702, 'checkpointer_blocking_start_time': 1768950093.761399, 'checkpointer_blocking_duration_secs': 0.5170187950134277, 'get_old_steps_start_time': 1768950094.2784557, 'get_old_steps_duration_secs': 0.00010085105895996094, 'checkpoint_manager_blocking_start_time': 1768950093.7592375, 'checkpoint_manager_blocking_duration_secs': 0.5241718292236328}
I0121 07:01:34.347585 139550525482560 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 07:01:35.590712 139550517089856 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.378400s (commit=1.290045s, array_metadata_write=0.088355s)
I0121 07:01:35.593658 139549158643264 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 46.866 MiB/s (total gbytes: 85.5 MiB) (time elapsed: a second) (per-host)
I0121 07:01:35.594117 139549158643264 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.317558s.
I0121 07:01:35.603128 139549158643264 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 07:01:35.644366 139549158643264 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.048216s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 07:01:35.645748 139549158643264 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4050.orbax-checkpoint-tmp/default
I0121 07:01:35.648148 139549158643264 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4050.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4050
I0121 07:01:35.657147 139549158643264 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4050`.
I0121 07:01:35.658085 139549158643264 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 1.896665s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4050
I0121 07:01:35.658328 139549158643264 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.381773s.
I0121 07:01:35.658898 139549133465152 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 07:01:35.659456 139549133465152 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 07:01:35.696641 139549133465152 deleter.py:273] Deleted step 3150.
I0121 07:01:35.696915 139549133465152 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=4050] CheckpointManager Save Finalize is syncing with other hosts...
I0121 07:01:35.697318 139549133465152 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=4050] CheckpointManager Save Finalize is done on all hosts.
step: 4500,  loss data: 3.116e-03, loss res: 8.601e-03, time: 1.292e+02
Epoch 10, getting batches from DataLoader...
step: 4950,  loss data: 4.241e-03, loss res: 2.798e-02, time: 1.289e+02
I0121 07:05:52.450280 139627771470912 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 07:05:52.451412 139627771470912 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 4950
I0121 07:05:52.452176 139627771470912 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4950.
I0121 07:05:53.046405 139546406663744 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4950.orbax-checkpoint-tmp
I0121 07:05:53.113167 139547430082112 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 07:05:53.133087 139627771470912 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 07:05:53.133693 139627771470912 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 07:05:53.503058 139627771470912 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.372371s
I0121 07:05:53.546642 139627771470912 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 165.589 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 516 milliseconds) (per-host)
I0121 07:05:53.597359 139627771470912 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.567324s (batch_requests_ready=0.057397s, total_serialization_initiated=0.432302s, others=0.077625s)
I0121 07:05:53.598866 139627771470912 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 1.143728s (all_items=0.000017s, per_item={'default': '0.00001693'}, temp_paths=1.143711)
I0121 07:05:53.601808 139550475126336 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 07:05:53.602695 139627771470912 async_checkpointer.py:561] Finished blocking save. Time taken: 1.151029s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4950.
I0121 07:05:53.604331 139627771470912 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=4950] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 07:05:53.605289 139550483519040 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 07:05:53.611184 139627771470912 standard_logger.py:34] {'step': Array(4950, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768950352.4502175, 'wait_for_prev_duration_secs': 0.0003306865692138672, 'time_between_consecutive_saves_sec': 256.752644777298, 'checkpointer_blocking_start_time': 1768950352.451634, 'checkpointer_blocking_duration_secs': 1.1524577140808105, 'get_old_steps_start_time': 1768950353.604141, 'get_old_steps_duration_secs': 0.00010991096496582031, 'checkpoint_manager_blocking_start_time': 1768950352.449608, 'checkpoint_manager_blocking_duration_secs': 1.1570358276367188}
I0121 07:05:53.625029 139550533875264 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 07:05:55.064596 139550525482560 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.488269s (commit=1.361593s, array_metadata_write=0.126675s)
I0121 07:05:55.067882 139550475126336 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 41.972 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 07:05:55.068156 139550475126336 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.465145s.
I0121 07:05:55.079041 139550475126336 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 07:05:55.129164 139550475126336 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.057986s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 07:05:55.131265 139550475126336 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4950.orbax-checkpoint-tmp/default
I0121 07:05:55.135481 139550475126336 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4950.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4950
I0121 07:05:55.146709 139550475126336 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4950`.
I0121 07:05:55.147728 139550475126336 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.696072s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/4950
I0121 07:05:55.147982 139550475126336 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.544972s.
I0121 07:05:55.148496 139550483519040 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 07:05:55.149231 139550483519040 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 07:05:55.200489 139550483519040 deleter.py:273] Deleted step 4050.
I0121 07:05:55.200808 139550483519040 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=4950] CheckpointManager Save Finalize is syncing with other hosts...
I0121 07:05:55.201234 139550483519040 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=4950] CheckpointManager Save Finalize is done on all hosts.
step: 5400,  loss data: 3.476e-03, loss res: 1.493e-02, time: 1.288e+02
step: 5850,  loss data: 2.761e-03, loss res: 3.269e-02, time: 1.288e+02
I0121 07:10:11.202546 139627771470912 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 07:10:11.203952 139627771470912 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 5850
I0121 07:10:11.204689 139627771470912 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/5850.
I0121 07:10:11.235036 139549158643264 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/5850.orbax-checkpoint-tmp
I0121 07:10:11.319723 139627771470912 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 07:10:11.320721 139627771470912 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 07:10:11.341921 139546826102336 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/5850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 07:10:11.604907 139627771470912 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.287749s
I0121 07:10:11.611675 139627771470912 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 217.441 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 393 milliseconds) (per-host)
I0121 07:10:11.611924 139627771470912 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.393657s (batch_requests_ready=0.054654s, total_serialization_initiated=0.337738s, others=0.001265s)
I0121 07:10:11.612533 139627771470912 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.399323s (all_items=0.000018s, per_item={'default': '0.00001812'}, temp_paths=0.399305)
I0121 07:10:11.705568 139550508697152 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 07:10:11.706061 139627771470912 async_checkpointer.py:561] Finished blocking save. Time taken: 0.501862s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/5850.
I0121 07:10:11.707401 139627771470912 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=5850] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 07:10:11.710351 139549167035968 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 07:10:11.712235 139627771470912 standard_logger.py:34] {'step': Array(5850, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768950611.2024918, 'wait_for_prev_duration_secs': 0.0003132820129394531, 'time_between_consecutive_saves_sec': 256.00087547302246, 'checkpointer_blocking_start_time': 1768950611.2041585, 'checkpointer_blocking_duration_secs': 0.5029816627502441, 'get_old_steps_start_time': 1768950611.70719, 'get_old_steps_duration_secs': 0.00011348724365234375, 'checkpoint_manager_blocking_start_time': 1768950611.2019765, 'checkpoint_manager_blocking_duration_secs': 0.5095226764678955}
I0121 07:10:11.736153 139550533875264 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/5850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 07:10:13.613688 139550525482560 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.989008s (commit=1.892852s, array_metadata_write=0.096156s)
I0121 07:10:13.616915 139550508697152 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 35.659 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 07:10:13.617419 139550508697152 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.911186s.
I0121 07:10:13.638179 139550508697152 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 07:10:13.721013 139550508697152 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.099102s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/5850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 07:10:13.722548 139550508697152 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/5850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/5850.orbax-checkpoint-tmp/default
I0121 07:10:13.729168 139550508697152 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/5850.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/5850
I0121 07:10:13.751373 139550508697152 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/5850`.
I0121 07:10:13.752420 139550508697152 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.548241s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/5850
I0121 07:10:13.752707 139550508697152 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 2.046477s.
I0121 07:10:13.753159 139549167035968 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 07:10:13.753681 139549167035968 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 07:10:13.864013 139549167035968 deleter.py:273] Deleted step 4950.
I0121 07:10:13.864295 139549167035968 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=5850] CheckpointManager Save Finalize is syncing with other hosts...
I0121 07:10:13.864728 139549167035968 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=5850] CheckpointManager Save Finalize is done on all hosts.
step: 6300,  loss data: 1.606e-02, loss res: 1.477e-01, time: 1.297e+02
step: 6750,  loss data: 3.789e-03, loss res: 1.662e-02, time: 1.290e+02
I0121 07:14:30.405482 139627771470912 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 07:14:30.406692 139627771470912 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 6750
I0121 07:14:30.407597 139627771470912 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/6750.
I0121 07:14:30.432813 139549175428672 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/6750.orbax-checkpoint-tmp
I0121 07:14:30.515685 139627771470912 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 07:14:30.516573 139627771470912 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 07:14:30.540892 139546800924224 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/6750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 07:14:30.823471 139627771470912 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.310152s
I0121 07:14:30.840929 139627771470912 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 201.079 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 425 milliseconds) (per-host)
I0121 07:14:30.858473 139627771470912 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.442965s (batch_requests_ready=0.053534s, total_serialization_initiated=0.360830s, others=0.028601s)
I0121 07:14:30.864439 139627771470912 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.453855s (all_items=0.000017s, per_item={'default': '0.00001740'}, temp_paths=0.453837)
I0121 07:14:30.928316 139550466733632 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 07:14:30.929487 139627771470912 async_checkpointer.py:561] Finished blocking save. Time taken: 0.522526s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/6750.
I0121 07:14:30.931099 139627771470912 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=6750] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 07:14:30.932173 139549167035968 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 07:14:30.937671 139627771470912 standard_logger.py:34] {'step': Array(6750, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768950870.4054224, 'wait_for_prev_duration_secs': 0.0003180503845214844, 'time_between_consecutive_saves_sec': 256.5403378009796, 'checkpointer_blocking_start_time': 1768950870.4069107, 'checkpointer_blocking_duration_secs': 0.5239481925964355, 'get_old_steps_start_time': 1768950870.9309072, 'get_old_steps_duration_secs': 0.00011277198791503906, 'checkpoint_manager_blocking_start_time': 1768950870.4048123, 'checkpoint_manager_blocking_duration_secs': 0.5321304798126221}
I0121 07:14:31.129008 139550533875264 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/6750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 07:14:32.350618 139550525482560 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.492512s (commit=1.401019s, array_metadata_write=0.091493s)
I0121 07:14:32.353843 139550466733632 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 44.127 MiB/s (total gbytes: 85.5 MiB) (time elapsed: a second) (per-host)
I0121 07:14:32.354263 139550466733632 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.424534s.
I0121 07:14:32.365787 139550466733632 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 07:14:32.453790 139550466733632 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.096472s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/6750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 07:14:32.455027 139550466733632 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/6750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/6750.orbax-checkpoint-tmp/default
I0121 07:14:32.459303 139550466733632 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/6750.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/6750
I0121 07:14:32.481620 139550466733632 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/6750`.
I0121 07:14:32.482967 139550466733632 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.076020s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/6750
I0121 07:14:32.483267 139550466733632 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.553541s.
I0121 07:14:32.483684 139549167035968 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 07:14:32.484266 139549167035968 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 07:14:32.536218 139549167035968 deleter.py:273] Deleted step 5850.
I0121 07:14:32.536558 139549167035968 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=6750] CheckpointManager Save Finalize is syncing with other hosts...
I0121 07:14:32.536854 139549167035968 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=6750] CheckpointManager Save Finalize is done on all hosts.
step: 7200,  loss data: 1.771e-03, loss res: 2.332e-03, time: 1.287e+02
step: 7650,  loss data: 3.315e-03, loss res: 1.402e-02, time: 1.282e+02
I0121 07:18:47.800088 139627771470912 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 07:18:47.801243 139627771470912 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 7650
I0121 07:18:47.802007 139627771470912 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/7650.
I0121 07:18:47.822407 139549158643264 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/7650.orbax-checkpoint-tmp
I0121 07:18:47.906878 139627771470912 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 07:18:47.907567 139627771470912 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 07:18:47.927126 139550483519040 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/7650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 07:18:48.221050 139627771470912 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.317514s
I0121 07:18:48.232827 139627771470912 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 202.368 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 422 milliseconds) (per-host)
I0121 07:18:48.249690 139627771470912 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.439730s (batch_requests_ready=0.051749s, total_serialization_initiated=0.359990s, others=0.027990s)
I0121 07:18:48.250591 139627771470912 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.445538s (all_items=0.000018s, per_item={'default': '0.00001836'}, temp_paths=0.445519)
I0121 07:18:48.325075 139549167035968 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 07:18:48.325926 139627771470912 async_checkpointer.py:561] Finished blocking save. Time taken: 0.524409s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/7650.
I0121 07:18:48.327398 139627771470912 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=7650] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 07:18:48.328459 139549150250560 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 07:18:48.332462 139627771470912 standard_logger.py:34] {'step': Array(7650, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768951127.80003, 'wait_for_prev_duration_secs': 0.0003170967102050781, 'time_between_consecutive_saves_sec': 255.2629895210266, 'checkpointer_blocking_start_time': 1768951127.8014743, 'checkpointer_blocking_duration_secs': 0.5256896018981934, 'get_old_steps_start_time': 1768951128.3272166, 'get_old_steps_duration_secs': 9.655952453613281e-05, 'checkpoint_manager_blocking_start_time': 1768951127.7994149, 'checkpoint_manager_blocking_duration_secs': 0.5324723720550537}
I0121 07:18:48.478811 139551020389952 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/7650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 07:18:49.743854 139550533875264 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.494843s (commit=1.364971s, array_metadata_write=0.129872s)
I0121 07:18:49.747190 139549167035968 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 44.152 MiB/s (total gbytes: 85.5 MiB) (time elapsed: a second) (per-host)
I0121 07:18:49.747653 139549167035968 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.422108s.
I0121 07:18:49.759482 139549167035968 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 07:18:49.816939 139549167035968 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.066095s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/7650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 07:18:49.818105 139549167035968 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/7650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/7650.orbax-checkpoint-tmp/default
I0121 07:18:49.822654 139549167035968 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/7650.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/7650
I0121 07:18:49.836185 139549167035968 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/7650`.
I0121 07:18:49.837188 139549167035968 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.035694s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/7650
I0121 07:18:49.837429 139549167035968 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.511887s.
I0121 07:18:49.838006 139549150250560 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 07:18:49.838430 139549150250560 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 07:18:49.895429 139549150250560 deleter.py:273] Deleted step 6750.
I0121 07:18:49.895668 139549150250560 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=7650] CheckpointManager Save Finalize is syncing with other hosts...
I0121 07:18:49.895941 139549150250560 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=7650] CheckpointManager Save Finalize is done on all hosts.
step: 8100,  loss data: 4.957e-03, loss res: 1.478e-02, time: 1.291e+02
step: 8550,  loss data: 3.605e-03, loss res: 8.086e-03, time: 1.294e+02
I0121 07:23:06.908325 139627771470912 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 07:23:06.909490 139627771470912 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 8550
I0121 07:23:06.910179 139627771470912 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/8550.
I0121 07:23:06.929247 139546792531520 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/8550.orbax-checkpoint-tmp
I0121 07:23:06.991031 139546809316928 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/8550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 07:23:07.011826 139627771470912 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 07:23:07.013014 139627771470912 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 07:23:07.392425 139627771470912 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.383013s
I0121 07:23:07.484011 139627771470912 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 150.989 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 566 milliseconds) (per-host)
I0121 07:23:07.488241 139627771470912 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.570777s (batch_requests_ready=0.052903s, total_serialization_initiated=0.454033s, others=0.063840s)
I0121 07:23:07.489153 139627771470912 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.576705s (all_items=0.000017s, per_item={'default': '0.00001717'}, temp_paths=0.576688)
I0121 07:23:07.502617 139550500304448 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 07:23:07.503063 139627771470912 async_checkpointer.py:561] Finished blocking save. Time taken: 0.593334s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/8550.
I0121 07:23:07.505257 139627771470912 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=8550] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 07:23:07.506621 139549167035968 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 07:23:07.508393 139627771470912 standard_logger.py:34] {'step': Array(8550, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768951386.9082565, 'wait_for_prev_duration_secs': 0.0003304481506347656, 'time_between_consecutive_saves_sec': 257.0121371746063, 'checkpointer_blocking_start_time': 1768951386.9096987, 'checkpointer_blocking_duration_secs': 0.5952978134155273, 'get_old_steps_start_time': 1768951387.5050452, 'get_old_steps_duration_secs': 0.00012087821960449219, 'checkpoint_manager_blocking_start_time': 1768951386.907736, 'checkpoint_manager_blocking_duration_secs': 0.5999464988708496}
I0121 07:23:07.514801 139550533875264 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/8550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 07:23:08.946285 139550525482560 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.516081s (commit=1.423059s, array_metadata_write=0.093022s)
I0121 07:23:08.948963 139550500304448 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 42.104 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 07:23:08.949379 139550500304448 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.445855s.
I0121 07:23:08.960670 139550500304448 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 07:23:09.015387 139550500304448 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.063267s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/8550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 07:23:09.016778 139550500304448 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/8550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/8550.orbax-checkpoint-tmp/default
I0121 07:23:09.020588 139550500304448 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/8550.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/8550
I0121 07:23:09.101370 139550500304448 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/8550`.
I0121 07:23:09.102518 139550500304448 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.192799s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/8550
I0121 07:23:09.102778 139550500304448 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.599257s.
I0121 07:23:09.103249 139549167035968 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 07:23:09.103931 139549167035968 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 07:23:09.181780 139549167035968 deleter.py:273] Deleted step 7650.
I0121 07:23:09.182035 139549167035968 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=8550] CheckpointManager Save Finalize is syncing with other hosts...
I0121 07:23:09.182308 139549167035968 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=8550] CheckpointManager Save Finalize is done on all hosts.
step: 9000,  loss data: 1.853e-03, loss res: 3.639e-03, time: 1.291e+02
Epoch 20, getting batches from DataLoader...
step: 9450,  loss data: 3.042e-03, loss res: 9.219e-03, time: 1.290e+02
I0121 07:27:25.620740 139627771470912 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 07:27:25.622047 139627771470912 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 9450
I0121 07:27:25.622811 139627771470912 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/9450.
I0121 07:27:25.642555 139546792531520 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/9450.orbax-checkpoint-tmp
I0121 07:27:25.703833 139546423449152 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/9450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 07:27:25.732251 139627771470912 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 07:27:25.732811 139627771470912 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 07:27:26.024077 139627771470912 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.294171s
I0121 07:27:26.041498 139627771470912 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 207.879 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 411 milliseconds) (per-host)
I0121 07:27:26.057519 139627771470912 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.427521s (batch_requests_ready=0.058264s, total_serialization_initiated=0.336526s, others=0.032730s)
I0121 07:27:26.132165 139627771470912 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.506623s (all_items=0.000017s, per_item={'default': '0.00001717'}, temp_paths=0.506605)
I0121 07:27:26.138055 139549175428672 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 07:27:26.138356 139627771470912 async_checkpointer.py:561] Finished blocking save. Time taken: 0.516047s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/9450.
I0121 07:27:26.141991 139627771470912 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=9450] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 07:27:26.145869 139549158643264 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 07:27:26.152738 139627771470912 standard_logger.py:34] {'step': Array(9450, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768951645.620675, 'wait_for_prev_duration_secs': 0.0003476142883300781, 'time_between_consecutive_saves_sec': 256.43818044662476, 'checkpointer_blocking_start_time': 1768951645.622279, 'checkpointer_blocking_duration_secs': 0.5194966793060303, 'get_old_steps_start_time': 1768951646.1418138, 'get_old_steps_duration_secs': 0.00010013580322265625, 'checkpoint_manager_blocking_start_time': 1768951645.620021, 'checkpoint_manager_blocking_duration_secs': 0.5321953296661377}
I0121 07:27:26.924966 139550533875264 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/9450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 07:27:27.891309 139550525482560 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.849319s (commit=1.753865s, array_metadata_write=0.095454s)
I0121 07:27:27.894373 139549175428672 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 37.773 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 07:27:27.894799 139549175428672 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.755485s.
I0121 07:27:27.906283 139549175428672 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 07:27:27.965241 139549175428672 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.067245s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/9450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 07:27:27.966697 139549175428672 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/9450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/9450.orbax-checkpoint-tmp/default
I0121 07:27:27.971042 139549175428672 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/9450.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/9450
I0121 07:27:28.015923 139549175428672 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/9450`.
I0121 07:27:28.017011 139549175428672 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.394710s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/9450
I0121 07:27:28.017296 139549175428672 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.877986s.
I0121 07:27:28.017787 139549158643264 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 07:27:28.018471 139549158643264 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 07:27:28.075995 139549158643264 deleter.py:273] Deleted step 8550.
I0121 07:27:28.076405 139549158643264 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=9450] CheckpointManager Save Finalize is syncing with other hosts...
I0121 07:27:28.077258 139549158643264 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=9450] CheckpointManager Save Finalize is done on all hosts.
step: 9900,  loss data: 4.198e-03, loss res: 3.451e-02, time: 1.298e+02
step: 10350,  loss data: 1.438e-03, loss res: 2.026e-02, time: 1.290e+02
I0121 07:31:44.959634 139627771470912 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 07:31:44.960882 139627771470912 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 10350
I0121 07:31:44.961659 139627771470912 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/10350.
I0121 07:31:44.981961 139549133465152 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/10350.orbax-checkpoint-tmp
I0121 07:31:45.060163 139546406663744 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/10350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 07:31:45.087099 139627771470912 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 07:31:45.087664 139627771470912 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 07:31:45.420231 139627771470912 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.335893s
I0121 07:31:45.431835 139627771470912 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 185.403 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 461 milliseconds) (per-host)
I0121 07:31:45.437183 139627771470912 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.466719s (batch_requests_ready=0.071978s, total_serialization_initiated=0.388718s, others=0.006023s)
I0121 07:31:45.437772 139627771470912 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.472965s (all_items=0.000018s, per_item={'default': '0.00001836'}, temp_paths=0.472947)
I0121 07:31:45.460712 139550500304448 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 07:31:45.466105 139627771470912 async_checkpointer.py:561] Finished blocking save. Time taken: 0.504966s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/10350.
I0121 07:31:45.518293 139627771470912 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=10350] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 07:31:45.519552 139549175428672 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 07:31:45.521338 139627771470912 standard_logger.py:34] {'step': Array(10350, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768951904.959571, 'wait_for_prev_duration_secs': 0.00033020973205566406, 'time_between_consecutive_saves_sec': 256.88174319267273, 'checkpointer_blocking_start_time': 1768951904.9611053, 'checkpointer_blocking_duration_secs': 0.5569591522216797, 'get_old_steps_start_time': 1768951905.5181105, 'get_old_steps_duration_secs': 0.0001010894775390625, 'checkpoint_manager_blocking_start_time': 1768951904.9589963, 'checkpoint_manager_blocking_duration_secs': 0.5614676475524902}
I0121 07:31:45.569790 139550533875264 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/10350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 07:31:47.145982 139550525482560 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.690904s (commit=1.600009s, array_metadata_write=0.090895s)
I0121 07:31:47.148961 139550500304448 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 39.263 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 07:31:47.149401 139550500304448 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.651383s.
I0121 07:31:47.161012 139550500304448 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 07:31:47.228053 139550500304448 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.075489s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/10350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 07:31:47.229760 139550500304448 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/10350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/10350.orbax-checkpoint-tmp/default
I0121 07:31:47.234863 139550500304448 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/10350.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/10350
I0121 07:31:47.249900 139550500304448 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/10350`.
I0121 07:31:47.250963 139550500304448 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.289836s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/10350
I0121 07:31:47.251218 139550500304448 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.753206s.
I0121 07:31:47.251827 139549175428672 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 07:31:47.252355 139549175428672 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 07:31:47.310538 139549175428672 deleter.py:273] Deleted step 9450.
I0121 07:31:47.310784 139549175428672 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=10350] CheckpointManager Save Finalize is syncing with other hosts...
I0121 07:31:47.311250 139549175428672 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=10350] CheckpointManager Save Finalize is done on all hosts.
step: 10800,  loss data: 2.168e-03, loss res: 2.772e-03, time: 1.295e+02
step: 11250,  loss data: 7.631e-03, loss res: 5.915e-02, time: 1.289e+02
I0121 07:36:04.004016 139627771470912 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 07:36:04.005306 139627771470912 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 11250
I0121 07:36:04.006103 139627771470912 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/11250.
I0121 07:36:04.025178 139546792531520 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/11250.orbax-checkpoint-tmp
I0121 07:36:04.081702 139546800924224 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/11250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 07:36:04.113444 139627771470912 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 07:36:04.115066 139627771470912 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 07:36:04.523027 139627771470912 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.411983s
I0121 07:36:04.530166 139627771470912 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 165.656 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 516 milliseconds) (per-host)
I0121 07:36:04.546827 139627771470912 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.533021s (batch_requests_ready=0.057458s, total_serialization_initiated=0.452848s, others=0.022715s)
I0121 07:36:04.548297 139627771470912 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.540122s (all_items=0.000020s, per_item={'default': '0.00001955'}, temp_paths=0.540102)
I0121 07:36:04.636010 139550500304448 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 07:36:04.636366 139627771470912 async_checkpointer.py:561] Finished blocking save. Time taken: 0.630802s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/11250.
I0121 07:36:04.641487 139627771470912 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=11250] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 07:36:04.642761 139549175428672 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 07:36:04.644679 139627771470912 standard_logger.py:34] {'step': Array(11250, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768952164.0039575, 'wait_for_prev_duration_secs': 0.00031566619873046875, 'time_between_consecutive_saves_sec': 256.69231033325195, 'checkpointer_blocking_start_time': 1768952164.005529, 'checkpointer_blocking_duration_secs': 0.6357059478759766, 'get_old_steps_start_time': 1768952164.6412818, 'get_old_steps_duration_secs': 0.00012230873107910156, 'checkpoint_manager_blocking_start_time': 1768952164.0033562, 'checkpoint_manager_blocking_duration_secs': 0.6400308609008789}
I0121 07:36:04.747273 139550533875264 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/11250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 07:36:05.865209 139550525482560 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.335319s (commit=1.247453s, array_metadata_write=0.087866s)
I0121 07:36:05.867863 139550500304448 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 46.133 MiB/s (total gbytes: 85.5 MiB) (time elapsed: a second) (per-host)
I0121 07:36:05.868384 139550500304448 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.231127s.
I0121 07:36:05.878110 139550500304448 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 07:36:05.935349 139550500304448 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.064512s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/11250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 07:36:05.936671 139550500304448 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/11250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/11250.orbax-checkpoint-tmp/default
I0121 07:36:05.938861 139550500304448 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/11250.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/11250
I0121 07:36:05.971550 139550500304448 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/11250`.
I0121 07:36:05.972627 139550500304448 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 1.967077s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/11250
I0121 07:36:05.972894 139550500304448 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.335640s.
I0121 07:36:05.973342 139549175428672 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 07:36:05.973843 139549175428672 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 07:36:05.995475 139549175428672 deleter.py:273] Deleted step 10350.
I0121 07:36:05.995726 139549175428672 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=11250] CheckpointManager Save Finalize is syncing with other hosts...
I0121 07:36:05.995995 139549175428672 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=11250] CheckpointManager Save Finalize is done on all hosts.
step: 11700,  loss data: 1.672e-03, loss res: 2.096e-03, time: 1.292e+02
step: 12150,  loss data: 5.244e-03, loss res: 1.187e-02, time: 1.287e+02
I0121 07:40:22.575101 139627771470912 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 07:40:22.576273 139627771470912 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 12150
I0121 07:40:22.577169 139627771470912 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/12150.
I0121 07:40:22.606939 139550475126336 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/12150.orbax-checkpoint-tmp
I0121 07:40:22.680644 139545760753216 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/12150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 07:40:22.681820 139627771470912 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 07:40:22.683031 139627771470912 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 07:40:23.044221 139627771470912 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.365627s
I0121 07:40:23.055830 139627771470912 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 181.311 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 471 milliseconds) (per-host)
I0121 07:40:23.066954 139627771470912 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.482911s (batch_requests_ready=0.054306s, total_serialization_initiated=0.406668s, others=0.021937s)
I0121 07:40:23.072660 139627771470912 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.492886s (all_items=0.000019s, per_item={'default': '0.00001884'}, temp_paths=0.492867)
I0121 07:40:23.141730 139550517089856 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 07:40:23.141977 139627771470912 async_checkpointer.py:561] Finished blocking save. Time taken: 0.565416s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/12150.
I0121 07:40:23.143491 139627771470912 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=12150] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 07:40:23.144967 139550491911744 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 07:40:23.150442 139627771470912 standard_logger.py:34] {'step': Array(12150, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768952422.575044, 'wait_for_prev_duration_secs': 0.00031304359436035156, 'time_between_consecutive_saves_sec': 256.57885694503784, 'checkpointer_blocking_start_time': 1768952422.5765274, 'checkpointer_blocking_duration_secs': 0.5667383670806885, 'get_old_steps_start_time': 1768952423.143303, 'get_old_steps_duration_secs': 0.00010514259338378906, 'checkpoint_manager_blocking_start_time': 1768952422.5744364, 'checkpoint_manager_blocking_duration_secs': 0.5751988887786865}
I0121 07:40:23.162183 139550533875264 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/12150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 07:40:24.523387 139550525482560 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.439272s (commit=1.347654s, array_metadata_write=0.091619s)
I0121 07:40:24.526339 139550517089856 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 44.038 MiB/s (total gbytes: 85.5 MiB) (time elapsed: a second) (per-host)
I0121 07:40:24.526775 139550517089856 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.384466s.
I0121 07:40:24.538479 139550517089856 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 07:40:24.653667 139550517089856 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.123852s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/12150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 07:40:24.655031 139550517089856 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/12150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/12150.orbax-checkpoint-tmp/default
I0121 07:40:24.664846 139550517089856 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/12150.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/12150
I0121 07:40:24.693727 139550517089856 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/12150`.
I0121 07:40:24.695790 139550517089856 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.119241s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/12150
I0121 07:40:24.696094 139550517089856 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.553787s.
I0121 07:40:24.696836 139550491911744 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 07:40:24.697710 139550491911744 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 07:40:24.754438 139550491911744 deleter.py:273] Deleted step 11250.
I0121 07:40:24.754693 139550491911744 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=12150] CheckpointManager Save Finalize is syncing with other hosts...
I0121 07:40:24.755002 139550491911744 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=12150] CheckpointManager Save Finalize is done on all hosts.
step: 12600,  loss data: 3.763e-03, loss res: 2.392e-02, time: 1.291e+02
step: 13050,  loss data: 2.563e-03, loss res: 1.489e-02, time: 1.291e+02
I0121 07:44:41.300982 139627771470912 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 07:44:41.302640 139627771470912 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 13050
I0121 07:44:41.303385 139627771470912 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13050.
I0121 07:44:41.328597 139549141857856 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13050.orbax-checkpoint-tmp
I0121 07:44:41.392380 139546406663744 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 07:44:41.422520 139627771470912 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 07:44:41.422979 139627771470912 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 07:44:41.723712 139627771470912 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.303609s
I0121 07:44:41.750762 139627771470912 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 194.789 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 439 milliseconds) (per-host)
I0121 07:44:41.762446 139627771470912 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.450840s (batch_requests_ready=0.063126s, total_serialization_initiated=0.349632s, others=0.038082s)
I0121 07:44:42.374701 139627771470912 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 1.068527s (all_items=0.000019s, per_item={'default': '0.00001931'}, temp_paths=1.068508)
I0121 07:44:42.438473 139546800924224 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 07:44:42.438816 139627771470912 async_checkpointer.py:561] Finished blocking save. Time taken: 1.135900s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13050.
I0121 07:44:42.441298 139627771470912 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=13050] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 07:44:42.443590 139550500304448 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 07:44:42.446663 139627771470912 standard_logger.py:34] {'step': Array(13050, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768952681.3009214, 'wait_for_prev_duration_secs': 0.0004055500030517578, 'time_between_consecutive_saves_sec': 256.5457410812378, 'checkpointer_blocking_start_time': 1768952681.3028684, 'checkpointer_blocking_duration_secs': 1.1381888389587402, 'get_old_steps_start_time': 1768952682.4411094, 'get_old_steps_duration_secs': 0.00010704994201660156, 'checkpoint_manager_blocking_start_time': 1768952681.3000348, 'checkpoint_manager_blocking_duration_secs': 1.1454136371612549}
I0121 07:44:42.483664 139550533875264 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 07:44:43.897829 139550525482560 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 2.135862s (commit=2.041089s, array_metadata_write=0.094772s)
I0121 07:44:43.900968 139546800924224 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 33.033 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 07:44:43.901417 139546800924224 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.461492s.
I0121 07:44:43.912351 139546800924224 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 07:44:43.971140 139546800924224 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.066962s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 07:44:43.972300 139546800924224 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13050.orbax-checkpoint-tmp/default
I0121 07:44:43.981069 139546800924224 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13050.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13050
I0121 07:44:44.001321 139546800924224 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13050`.
I0121 07:44:44.002418 139546800924224 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.699515s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13050
I0121 07:44:44.002867 139546800924224 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.562943s.
I0121 07:44:44.003248 139550500304448 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 07:44:44.003575 139550500304448 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 07:44:44.058276 139550500304448 deleter.py:273] Deleted step 12150.
I0121 07:44:44.058749 139550500304448 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=13050] CheckpointManager Save Finalize is syncing with other hosts...
I0121 07:44:44.059246 139550500304448 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=13050] CheckpointManager Save Finalize is done on all hosts.
step: 13500,  loss data: 2.252e-03, loss res: 1.298e-02, time: 1.289e+02
Epoch 30, getting batches from DataLoader...
step: 13950,  loss data: 3.709e-03, loss res: 1.723e-02, time: 1.289e+02
I0121 07:49:00.255084 139627771470912 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 07:49:00.256634 139627771470912 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 13950
I0121 07:49:00.257494 139627771470912 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13950.
I0121 07:49:00.284405 139545769145920 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13950.orbax-checkpoint-tmp
I0121 07:49:00.366881 139627771470912 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 07:49:00.367503 139627771470912 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 07:49:00.392748 139545743967808 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 07:49:00.670335 139627771470912 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.305901s
I0121 07:49:00.686932 139627771470912 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 203.041 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 421 milliseconds) (per-host)
I0121 07:49:00.698103 139627771470912 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.432482s (batch_requests_ready=0.058172s, total_serialization_initiated=0.347331s, others=0.026980s)
I0121 07:49:00.709297 139627771470912 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.448842s (all_items=0.000017s, per_item={'default': '0.00001669'}, temp_paths=0.448825)
I0121 07:49:00.768987 139550508697152 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 07:49:00.769645 139627771470912 async_checkpointer.py:561] Finished blocking save. Time taken: 0.512747s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13950.
I0121 07:49:00.771344 139627771470912 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=13950] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 07:49:00.772499 139549175428672 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 07:49:00.774668 139627771470912 standard_logger.py:34] {'step': Array(13950, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768952940.255023, 'wait_for_prev_duration_secs': 0.00034737586975097656, 'time_between_consecutive_saves_sec': 256.1953811645508, 'checkpointer_blocking_start_time': 1768952940.256861, 'checkpointer_blocking_duration_secs': 0.5142533779144287, 'get_old_steps_start_time': 1768952940.77116, 'get_old_steps_duration_secs': 0.00010585784912109375, 'checkpoint_manager_blocking_start_time': 1768952940.2544205, 'checkpoint_manager_blocking_duration_secs': 0.5188663005828857}
I0121 07:49:00.793887 139550533875264 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 07:49:02.136371 139550525482560 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.426622s (commit=1.320710s, array_metadata_write=0.105912s)
I0121 07:49:02.139618 139550508697152 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 45.642 MiB/s (total gbytes: 85.5 MiB) (time elapsed: a second) (per-host)
I0121 07:49:02.140030 139550508697152 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.369497s.
I0121 07:49:02.154030 139550508697152 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 07:49:02.209087 139550508697152 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.065501s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 07:49:02.210691 139550508697152 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13950.orbax-checkpoint-tmp/default
I0121 07:49:02.215355 139550508697152 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13950.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13950
I0121 07:49:02.238135 139550508697152 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13950`.
I0121 07:49:02.239225 139550508697152 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 1.982344s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/13950
I0121 07:49:02.239478 139550508697152 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.468947s.
I0121 07:49:02.240186 139549175428672 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 07:49:02.240672 139549175428672 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 07:49:02.272237 139549175428672 deleter.py:273] Deleted step 13050.
I0121 07:49:02.272569 139549175428672 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=13950] CheckpointManager Save Finalize is syncing with other hosts...
I0121 07:49:02.273066 139549175428672 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=13950] CheckpointManager Save Finalize is done on all hosts.
step: 14400,  loss data: 4.902e-03, loss res: 1.592e-02, time: 1.295e+02
step: 14850,  loss data: 2.288e-03, loss res: 1.195e-02, time: 1.290e+02
I0121 07:53:19.260526 139627771470912 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 07:53:19.261826 139627771470912 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 14850
I0121 07:53:19.263004 139627771470912 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/14850.
I0121 07:53:19.284768 139549158643264 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/14850.orbax-checkpoint-tmp
I0121 07:53:19.367247 139546826102336 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/14850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 07:53:19.390038 139627771470912 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 07:53:19.390663 139627771470912 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 07:53:19.753354 139627771470912 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.366242s
I0121 07:53:19.764999 139627771470912 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 173.157 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 493 milliseconds) (per-host)
I0121 07:53:19.771813 139627771470912 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.500843s (batch_requests_ready=0.075519s, total_serialization_initiated=0.407831s, others=0.017493s)
I0121 07:53:19.777577 139627771470912 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.511651s (all_items=0.000019s, per_item={'default': '0.00001931'}, temp_paths=0.511631)
I0121 07:53:19.855127 139550508697152 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 07:53:19.855366 139627771470912 async_checkpointer.py:561] Finished blocking save. Time taken: 0.593269s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/14850.
I0121 07:53:19.857545 139627771470912 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=14850] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 07:53:19.859115 139549175428672 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 07:53:19.860925 139627771470912 standard_logger.py:34] {'step': Array(14850, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768953199.2604542, 'wait_for_prev_duration_secs': 0.0003638267517089844, 'time_between_consecutive_saves_sec': 256.98706221580505, 'checkpointer_blocking_start_time': 1768953199.262062, 'checkpointer_blocking_duration_secs': 0.595221996307373, 'get_old_steps_start_time': 1768953199.8573313, 'get_old_steps_duration_secs': 0.00012993812561035156, 'checkpoint_manager_blocking_start_time': 1768953199.259901, 'checkpoint_manager_blocking_duration_secs': 0.6003944873809814}
I0121 07:53:19.883352 139550533875264 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/14850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 07:53:21.272157 139550525482560 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.506695s (commit=1.399683s, array_metadata_write=0.107012s)
I0121 07:53:21.275329 139550508697152 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 42.673 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 07:53:21.275717 139550508697152 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.419984s.
I0121 07:53:21.293324 139550508697152 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 07:53:21.348302 139550508697152 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.065993s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/14850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 07:53:21.349631 139550508697152 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/14850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/14850.orbax-checkpoint-tmp/default
I0121 07:53:21.354100 139550508697152 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/14850.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/14850
I0121 07:53:21.368080 139550508697152 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/14850`.
I0121 07:53:21.369087 139550508697152 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.107005s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/14850
I0121 07:53:21.369336 139550508697152 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.513606s.
I0121 07:53:21.369818 139549175428672 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 07:53:21.370320 139549175428672 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 07:53:21.419062 139549175428672 deleter.py:273] Deleted step 13950.
I0121 07:53:21.419344 139549175428672 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=14850] CheckpointManager Save Finalize is syncing with other hosts...
I0121 07:53:21.419740 139549175428672 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=14850] CheckpointManager Save Finalize is done on all hosts.
step: 15300,  loss data: 4.186e-03, loss res: 1.194e-02, time: 1.293e+02
step: 15750,  loss data: 2.245e-03, loss res: 8.988e-03, time: 1.292e+02
I0121 07:57:38.367136 139627771470912 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 07:57:38.368589 139627771470912 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 15750
I0121 07:57:38.369378 139627771470912 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/15750.
I0121 07:57:38.389438 139547438474816 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/15750.orbax-checkpoint-tmp
I0121 07:57:38.440957 139546809316928 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/15750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 07:57:38.483884 139627771470912 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 07:57:38.484654 139627771470912 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 07:57:38.789057 139627771470912 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.307534s
I0121 07:57:38.795566 139627771470912 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 204.651 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 417 milliseconds) (per-host)
I0121 07:57:38.795819 139627771470912 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.418247s (batch_requests_ready=0.064336s, total_serialization_initiated=0.353062s, others=0.000848s)
I0121 07:57:38.801454 139627771470912 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.429031s (all_items=0.000019s, per_item={'default': '0.00001860'}, temp_paths=0.429013)
I0121 07:57:38.886444 139550517089856 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 07:57:38.886734 139627771470912 async_checkpointer.py:561] Finished blocking save. Time taken: 0.517896s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/15750.
I0121 07:57:38.889098 139627771470912 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=15750] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 07:57:38.891343 139550466733632 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 07:57:38.898855 139627771470912 standard_logger.py:34] {'step': Array(15750, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768953458.3670733, 'wait_for_prev_duration_secs': 0.00033545494079589844, 'time_between_consecutive_saves_sec': 256.9469909667969, 'checkpointer_blocking_start_time': 1768953458.3688095, 'checkpointer_blocking_duration_secs': 0.5200762748718262, 'get_old_steps_start_time': 1768953458.8889225, 'get_old_steps_duration_secs': 9.989738464355469e-05, 'checkpoint_manager_blocking_start_time': 1768953458.3664715, 'checkpoint_manager_blocking_duration_secs': 0.5317156314849854}
I0121 07:57:38.911130 139550533875264 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/15750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 07:57:40.152975 139550525482560 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.340107s (commit=1.245286s, array_metadata_write=0.094821s)
I0121 07:57:40.158133 139550517089856 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 48.037 MiB/s (total gbytes: 85.5 MiB) (time elapsed: a second) (per-host)
I0121 07:57:40.158559 139550517089856 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.270795s.
I0121 07:57:40.169481 139550517089856 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 07:57:40.223629 139550517089856 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.062195s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/15750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 07:57:40.226844 139550517089856 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/15750.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/15750.orbax-checkpoint-tmp/default
I0121 07:57:40.231418 139550517089856 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/15750.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/15750
I0121 07:57:40.244316 139550517089856 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/15750`.
I0121 07:57:40.245295 139550517089856 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 1.876466s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/15750
I0121 07:57:40.245555 139550517089856 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.357797s.
I0121 07:57:40.245943 139550466733632 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 07:57:40.246395 139550466733632 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 07:57:40.295181 139550466733632 deleter.py:273] Deleted step 14850.
I0121 07:57:40.295432 139550466733632 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=15750] CheckpointManager Save Finalize is syncing with other hosts...
I0121 07:57:40.295709 139550466733632 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=15750] CheckpointManager Save Finalize is done on all hosts.
step: 16200,  loss data: 3.103e-03, loss res: 9.846e-03, time: 1.289e+02
step: 16650,  loss data: 2.112e-03, loss res: 7.552e-03, time: 1.289e+02
I0121 08:01:56.743023 139627771470912 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 08:01:56.744247 139627771470912 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 16650
I0121 08:01:56.745127 139627771470912 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/16650.
I0121 08:01:56.780783 139549141857856 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/16650.orbax-checkpoint-tmp
I0121 08:01:57.434950 139627771470912 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 08:01:57.435456 139627771470912 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 08:01:57.457997 139549133465152 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/16650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 08:01:57.805636 139627771470912 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.373524s
I0121 08:01:57.817340 139627771470912 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 80.349 MiB/s (total gbytes: 85.5 MiB) (time elapsed: a second) (per-host)
I0121 08:01:57.825441 139627771470912 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 1.072649s (batch_requests_ready=0.051995s, total_serialization_initiated=1.006625s, others=0.014029s)
I0121 08:01:57.826077 139627771470912 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 1.077797s (all_items=0.000018s, per_item={'default': '0.00001764'}, temp_paths=1.077779)
I0121 08:01:57.848602 139550500304448 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 08:01:57.883034 139627771470912 async_checkpointer.py:561] Finished blocking save. Time taken: 1.138510s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/16650.
I0121 08:01:57.901307 139627771470912 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=16650] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 08:01:57.903755 139549167035968 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 08:01:57.905112 139627771470912 standard_logger.py:34] {'step': Array(16650, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768953716.7429595, 'wait_for_prev_duration_secs': 0.0003306865692138672, 'time_between_consecutive_saves_sec': 256.4470708370209, 'checkpointer_blocking_start_time': 1768953716.7444863, 'checkpointer_blocking_duration_secs': 1.1565933227539062, 'get_old_steps_start_time': 1768953717.9011192, 'get_old_steps_duration_secs': 0.00010085105895996094, 'checkpoint_manager_blocking_start_time': 1768953716.7423368, 'checkpoint_manager_blocking_duration_secs': 1.1621625423431396}
I0121 08:01:57.928678 139550533875264 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/16650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 08:01:59.284173 139550525482560 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.461206s (commit=1.367968s, array_metadata_write=0.093238s)
I0121 08:01:59.287227 139550500304448 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 33.748 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 08:01:59.287668 139550500304448 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.404734s.
I0121 08:01:59.299447 139550500304448 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 08:01:59.351642 139550500304448 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.060965s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/16650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 08:01:59.352897 139550500304448 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/16650.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/16650.orbax-checkpoint-tmp/default
I0121 08:01:59.357257 139550500304448 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/16650.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/16650
I0121 08:01:59.370982 139550500304448 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/16650`.
I0121 08:01:59.371942 139550500304448 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.627436s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/16650
I0121 08:01:59.372197 139550500304448 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.489267s.
I0121 08:01:59.372760 139549167035968 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 08:01:59.373286 139549167035968 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 08:01:59.418466 139549167035968 deleter.py:273] Deleted step 15750.
I0121 08:01:59.418835 139549167035968 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=16650] CheckpointManager Save Finalize is syncing with other hosts...
I0121 08:01:59.419096 139549167035968 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=16650] CheckpointManager Save Finalize is done on all hosts.
step: 17100,  loss data: 1.772e-03, loss res: 1.583e-02, time: 1.276e+02
step: 17550,  loss data: 1.284e-03, loss res: 9.881e-03, time: 1.286e+02
I0121 08:06:14.044004 139627771470912 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 08:06:14.045258 139627771470912 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 17550
I0121 08:06:14.046029 139627771470912 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/17550.
I0121 08:06:14.075818 139547430082112 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/17550.orbax-checkpoint-tmp
I0121 08:06:14.149749 139627771470912 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 08:06:14.150341 139627771470912 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 08:06:14.160467 139546423449152 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/17550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 08:06:14.516524 139627771470912 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.369200s
I0121 08:06:14.533798 139627771470912 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 177.861 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 480 milliseconds) (per-host)
I0121 08:06:14.556236 139627771470912 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.503392s (batch_requests_ready=0.053205s, total_serialization_initiated=0.421835s, others=0.028352s)
I0121 08:06:14.612571 139627771470912 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.563970s (all_items=0.000018s, per_item={'default': '0.00001836'}, temp_paths=0.563951)
I0121 08:06:14.617016 139549175428672 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 08:06:14.617306 139627771470912 async_checkpointer.py:561] Finished blocking save. Time taken: 0.571792s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/17550.
I0121 08:06:14.619576 139627771470912 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=17550] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 08:06:14.624843 139549167035968 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 08:06:14.626601 139627771470912 standard_logger.py:34] {'step': Array(17550, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768953974.0439482, 'wait_for_prev_duration_secs': 0.0003254413604736328, 'time_between_consecutive_saves_sec': 254.62450528144836, 'checkpointer_blocking_start_time': 1768953974.0454795, 'checkpointer_blocking_duration_secs': 0.5738258361816406, 'get_old_steps_start_time': 1768953974.619362, 'get_old_steps_duration_secs': 0.00011754035949707031, 'checkpoint_manager_blocking_start_time': 1768953974.0433521, 'checkpoint_manager_blocking_duration_secs': 0.5826427936553955}
I0121 08:06:14.645811 139550533875264 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/17550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 08:06:16.677536 139550525482560 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 2.127532s (commit=1.439511s, array_metadata_write=0.688021s)
I0121 08:06:16.681456 139549175428672 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 32.539 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 08:06:16.682054 139549175428672 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 2.063978s.
I0121 08:06:16.698379 139549175428672 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 08:06:16.742794 139549175428672 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.057316s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/17550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 08:06:16.744031 139549175428672 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/17550.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/17550.orbax-checkpoint-tmp/default
I0121 08:06:16.747803 139549175428672 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/17550.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/17550
I0121 08:06:16.761407 139549175428672 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/17550`.
I0121 08:06:16.762268 139549175428672 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.716770s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/17550
I0121 08:06:16.762486 139549175428672 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 2.144417s.
I0121 08:06:16.763078 139549167035968 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 08:06:16.763485 139549167035968 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 08:06:16.802237 139549167035968 deleter.py:273] Deleted step 16650.
I0121 08:06:16.802530 139549167035968 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=17550] CheckpointManager Save Finalize is syncing with other hosts...
I0121 08:06:16.802863 139549167035968 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=17550] CheckpointManager Save Finalize is done on all hosts.
step: 18000,  loss data: 7.248e-04, loss res: 5.451e-03, time: 1.290e+02
Epoch 40, getting batches from DataLoader...
step: 18450,  loss data: 8.066e-04, loss res: 2.824e-03, time: 1.288e+02
I0121 08:10:32.514015 139627771470912 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 08:10:32.515226 139627771470912 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 18450
I0121 08:10:32.516020 139627771470912 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/18450.
I0121 08:10:32.535961 139547430082112 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/18450.orbax-checkpoint-tmp
I0121 08:10:32.598436 139546415056448 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/18450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 08:10:32.622295 139627771470912 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 08:10:32.622840 139627771470912 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 08:10:32.958504 139627771470912 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.338619s
I0121 08:10:32.981626 139627771470912 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 187.117 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 457 milliseconds) (per-host)
I0121 08:10:32.982035 139627771470912 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.457571s (batch_requests_ready=0.053433s, total_serialization_initiated=0.391861s, others=0.012276s)
I0121 08:10:32.995064 139627771470912 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.476067s (all_items=0.000018s, per_item={'default': '0.00001836'}, temp_paths=0.476048)
I0121 08:10:33.063545 139550500304448 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 08:10:33.063930 139627771470912 async_checkpointer.py:561] Finished blocking save. Time taken: 0.548450s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/18450.
I0121 08:10:33.065847 139627771470912 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=18450] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 08:10:33.071758 139549175428672 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 08:10:33.073692 139627771470912 standard_logger.py:34] {'step': Array(18450, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768954232.513957, 'wait_for_prev_duration_secs': 0.0003228187561035156, 'time_between_consecutive_saves_sec': 255.71086597442627, 'checkpointer_blocking_start_time': 1768954232.5154445, 'checkpointer_blocking_duration_secs': 0.5501739978790283, 'get_old_steps_start_time': 1768954233.0656645, 'get_old_steps_duration_secs': 0.00010013580322265625, 'checkpoint_manager_blocking_start_time': 1768954232.5133905, 'checkpoint_manager_blocking_duration_secs': 0.5596015453338623}
I0121 08:10:33.095469 139550533875264 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/18450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 08:10:34.545269 139550525482560 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.539300s (commit=1.445158s, array_metadata_write=0.094142s)
I0121 08:10:34.548093 139550500304448 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 42.268 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 08:10:34.548694 139550500304448 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.484408s.
I0121 08:10:34.560350 139550500304448 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 08:10:34.619462 139550500304448 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.067368s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/18450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 08:10:34.621145 139550500304448 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/18450.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/18450.orbax-checkpoint-tmp/default
I0121 08:10:34.625521 139550500304448 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/18450.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/18450
I0121 08:10:34.642916 139550500304448 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/18450`.
I0121 08:10:34.643965 139550500304448 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.128500s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/18450
I0121 08:10:34.644221 139550500304448 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.579941s.
I0121 08:10:34.644775 139549175428672 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 08:10:34.645299 139549175428672 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 08:10:34.696441 139549175428672 deleter.py:273] Deleted step 17550.
I0121 08:10:34.696705 139549175428672 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=18450] CheckpointManager Save Finalize is syncing with other hosts...
I0121 08:10:34.696983 139549175428672 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=18450] CheckpointManager Save Finalize is done on all hosts.
step: 18900,  loss data: 1.443e-03, loss res: 5.759e-03, time: 1.286e+02
step: 19350,  loss data: 1.538e-03, loss res: 6.820e-03, time: 1.280e+02
I0121 08:14:49.718857 139627771470912 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 08:14:49.720083 139627771470912 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 19350
I0121 08:14:49.720853 139627771470912 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/19350.
I0121 08:14:49.745651 139549133465152 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/19350.orbax-checkpoint-tmp
I0121 08:14:49.812064 139545727182400 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/19350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 08:14:49.832605 139627771470912 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 08:14:49.833050 139627771470912 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 08:14:50.208304 139627771470912 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.378404s
I0121 08:14:50.215763 139627771470912 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 175.221 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 488 milliseconds) (per-host)
I0121 08:14:50.226510 139627771470912 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.498925s (batch_requests_ready=0.057306s, total_serialization_initiated=0.429675s, others=0.011945s)
I0121 08:14:50.238026 139627771470912 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.514378s (all_items=0.000016s, per_item={'default': '0.00001597'}, temp_paths=0.514362)
I0121 08:14:50.305511 139550508697152 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 08:14:50.306606 139627771470912 async_checkpointer.py:561] Finished blocking save. Time taken: 0.586302s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/19350.
I0121 08:14:50.307361 139627771470912 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=19350] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 08:14:50.309475 139549167035968 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 08:14:50.313961 139627771470912 standard_logger.py:34] {'step': Array(19350, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768954489.7188048, 'wait_for_prev_duration_secs': 0.00027632713317871094, 'time_between_consecutive_saves_sec': 255.0216464996338, 'checkpointer_blocking_start_time': 1768954489.7202697, 'checkpointer_blocking_duration_secs': 0.5868508815765381, 'get_old_steps_start_time': 1768954490.3071673, 'get_old_steps_duration_secs': 0.00011229515075683594, 'checkpoint_manager_blocking_start_time': 1768954489.7182374, 'checkpoint_manager_blocking_duration_secs': 0.5951473712921143}
I0121 08:14:50.327736 139550533875264 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/19350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 08:14:51.616120 139550525482560 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.378923s (commit=1.282447s, array_metadata_write=0.096476s)
I0121 08:14:51.619199 139550508697152 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 45.216 MiB/s (total gbytes: 85.5 MiB) (time elapsed: a second) (per-host)
I0121 08:14:51.619449 139550508697152 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.313160s.
I0121 08:14:51.630612 139550508697152 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 08:14:51.686682 139550508697152 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.064376s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/19350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 08:14:51.688162 139550508697152 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/19350.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/19350.orbax-checkpoint-tmp/default
I0121 08:14:51.702707 139550508697152 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/19350.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/19350
I0121 08:14:51.717319 139550508697152 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/19350`.
I0121 08:14:51.718260 139550508697152 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 1.997970s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/19350
I0121 08:14:51.718518 139550508697152 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.412230s.
I0121 08:14:51.719076 139549167035968 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 08:14:51.719594 139549167035968 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 08:14:51.775962 139549167035968 deleter.py:273] Deleted step 18450.
I0121 08:14:51.776279 139549167035968 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=19350] CheckpointManager Save Finalize is syncing with other hosts...
I0121 08:14:51.776760 139549167035968 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=19350] CheckpointManager Save Finalize is done on all hosts.
step: 19800,  loss data: 1.104e-03, loss res: 1.659e-03, time: 1.288e+02
step: 20250,  loss data: 6.843e-04, loss res: 1.336e-03, time: 1.291e+02
I0121 08:19:08.190185 139627771470912 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 08:19:08.191686 139627771470912 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 20250
I0121 08:19:08.192364 139627771470912 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/20250.
I0121 08:19:08.213448 139545358100032 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/20250.orbax-checkpoint-tmp
I0121 08:19:08.296041 139627771470912 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 08:19:08.296673 139627771470912 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 08:19:08.318361 139547430082112 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/20250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 08:19:08.662235 139627771470912 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.368509s
I0121 08:19:08.690421 139627771470912 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 174.359 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 490 milliseconds) (per-host)
I0121 08:19:08.690792 139627771470912 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.490981s (batch_requests_ready=0.054677s, total_serialization_initiated=0.408941s, others=0.027363s)
I0121 08:19:08.691351 139627771470912 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.496160s (all_items=0.000017s, per_item={'default': '0.00001740'}, temp_paths=0.496142)
I0121 08:19:08.766706 139550475126336 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 08:19:08.767078 139627771470912 async_checkpointer.py:561] Finished blocking save. Time taken: 0.575144s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/20250.
I0121 08:19:08.768878 139627771470912 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=20250] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 08:19:08.769438 139550466733632 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 08:19:08.776702 139627771470912 standard_logger.py:34] {'step': Array(20250, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768954748.1901295, 'wait_for_prev_duration_secs': 0.0002989768981933594, 'time_between_consecutive_saves_sec': 256.4131872653961, 'checkpointer_blocking_start_time': 1768954748.1918979, 'checkpointer_blocking_duration_secs': 0.5767390727996826, 'get_old_steps_start_time': 1768954748.7686841, 'get_old_steps_duration_secs': 0.00011181831359863281, 'checkpoint_manager_blocking_start_time': 1768954748.1896474, 'checkpoint_manager_blocking_duration_secs': 0.5827453136444092}
I0121 08:19:08.794380 139550533875264 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/20250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 08:19:10.105123 139550525482560 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.435850s (commit=1.327517s, array_metadata_write=0.108333s)
I0121 08:19:10.107919 139550475126336 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 44.827 MiB/s (total gbytes: 85.5 MiB) (time elapsed: a second) (per-host)
I0121 08:19:10.108486 139550475126336 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.341021s.
I0121 08:19:10.121152 139550475126336 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 08:19:10.179084 139550475126336 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.067172s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/20250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 08:19:10.180398 139550475126336 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/20250.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/20250.orbax-checkpoint-tmp/default
I0121 08:19:10.184708 139550475126336 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/20250.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/20250
I0121 08:19:10.200757 139550475126336 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/20250`.
I0121 08:19:10.201680 139550475126336 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.009762s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/20250
I0121 08:19:10.201929 139550475126336 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.434469s.
I0121 08:19:10.202387 139550466733632 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 08:19:10.202996 139550466733632 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 08:19:10.264351 139550466733632 deleter.py:273] Deleted step 19350.
I0121 08:19:10.264657 139550466733632 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=20250] CheckpointManager Save Finalize is syncing with other hosts...
I0121 08:19:10.265052 139550466733632 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=20250] CheckpointManager Save Finalize is done on all hosts.
step: 20700,  loss data: 9.501e-03, loss res: 1.653e-02, time: 1.289e+02
step: 21150,  loss data: 1.109e-03, loss res: 1.851e-03, time: 1.287e+02
I0121 08:23:26.389422 139627771470912 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 08:23:26.390712 139627771470912 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 21150
I0121 08:23:26.391418 139627771470912 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/21150.
I0121 08:23:26.421111 139547421689408 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/21150.orbax-checkpoint-tmp
I0121 08:23:26.496129 139627771470912 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 08:23:26.496650 139627771470912 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 08:23:26.520929 139547446867520 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/21150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 08:23:26.875017 139627771470912 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.381188s
I0121 08:23:26.882082 139627771470912 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 176.977 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 483 milliseconds) (per-host)
I0121 08:23:26.887551 139627771470912 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.488814s (batch_requests_ready=0.055383s, total_serialization_initiated=0.421573s, others=0.011858s)
I0121 08:23:26.888167 139627771470912 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.494667s (all_items=0.000019s, per_item={'default': '0.00001860'}, temp_paths=0.494649)
I0121 08:23:26.982925 139549167035968 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 08:23:26.983347 139627771470912 async_checkpointer.py:561] Finished blocking save. Time taken: 0.592362s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/21150.
I0121 08:23:26.986087 139627771470912 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=21150] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 08:23:26.991647 139549150250560 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 08:23:26.993756 139627771470912 standard_logger.py:34] {'step': Array(21150, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768955006.3893647, 'wait_for_prev_duration_secs': 0.00029778480529785156, 'time_between_consecutive_saves_sec': 256.1240656375885, 'checkpointer_blocking_start_time': 1768955006.3909314, 'checkpointer_blocking_duration_secs': 0.5948526859283447, 'get_old_steps_start_time': 1768955006.9858518, 'get_old_steps_duration_secs': 0.00012564659118652344, 'checkpoint_manager_blocking_start_time': 1768955006.3888159, 'checkpoint_manager_blocking_duration_secs': 0.6040852069854736}
I0121 08:23:27.049700 139550525482560 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/21150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 08:23:28.910070 139550517089856 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 2.028397s (commit=1.929765s, array_metadata_write=0.098632s)
I0121 08:23:28.913103 139549167035968 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 34.017 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 08:23:28.913499 139549167035968 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.929311s.
I0121 08:23:28.923950 139549167035968 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 08:23:28.966249 139549167035968 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.050056s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/21150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 08:23:28.967429 139549167035968 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/21150.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/21150.orbax-checkpoint-tmp/default
I0121 08:23:28.970705 139549167035968 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/21150.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/21150
I0121 08:23:29.030590 139549167035968 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/21150`.
I0121 08:23:29.032125 139549167035968 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.641172s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/21150
I0121 08:23:29.032455 139549167035968 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 2.048268s.
I0121 08:23:29.033034 139549150250560 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 08:23:29.033631 139549150250560 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 08:23:29.063778 139549150250560 deleter.py:273] Deleted step 20250.
I0121 08:23:29.064032 139549150250560 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=21150] CheckpointManager Save Finalize is syncing with other hosts...
I0121 08:23:29.064299 139549150250560 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=21150] CheckpointManager Save Finalize is done on all hosts.
step: 21600,  loss data: 1.561e-03, loss res: 2.754e-03, time: 1.295e+02
step: 22050,  loss data: 3.139e-03, loss res: 8.421e-03, time: 1.288e+02
I0121 08:27:45.311319 139627771470912 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 08:27:45.312629 139627771470912 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 22050
I0121 08:27:45.313346 139627771470912 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22050.
I0121 08:27:45.333397 139546415056448 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22050.orbax-checkpoint-tmp
I0121 08:27:45.419340 139627771470912 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 08:27:45.420085 139627771470912 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 08:27:45.430638 139545769145920 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 08:27:45.722728 139627771470912 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.306635s
I0121 08:27:45.741802 139627771470912 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 203.810 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 419 milliseconds) (per-host)
I0121 08:27:45.747464 139627771470912 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.425549s (batch_requests_ready=0.053216s, total_serialization_initiated=0.348188s, others=0.024144s)
I0121 08:27:45.753548 139627771470912 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.437289s (all_items=0.000020s, per_item={'default': '0.00001979'}, temp_paths=0.437269)
I0121 08:27:45.823684 139549175428672 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 08:27:45.824094 139627771470912 async_checkpointer.py:561] Finished blocking save. Time taken: 0.511236s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22050.
I0121 08:27:45.825100 139627771470912 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=22050] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 08:27:45.826081 139549167035968 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 08:27:45.828411 139627771470912 standard_logger.py:34] {'step': Array(22050, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768955265.3112638, 'wait_for_prev_duration_secs': 0.0002875328063964844, 'time_between_consecutive_saves_sec': 256.24663162231445, 'checkpointer_blocking_start_time': 1768955265.3128202, 'checkpointer_blocking_duration_secs': 0.5120728015899658, 'get_old_steps_start_time': 1768955265.8249285, 'get_old_steps_duration_secs': 9.679794311523438e-05, 'checkpoint_manager_blocking_start_time': 1768955265.3107255, 'checkpoint_manager_blocking_duration_secs': 0.5166151523590088}
I0121 08:27:45.848636 139550525482560 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 08:27:47.331685 139550517089856 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.602138s (commit=1.478730s, array_metadata_write=0.123408s)
I0121 08:27:47.336013 139549175428672 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 42.468 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 08:27:47.336454 139549175428672 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.512253s.
I0121 08:27:47.350746 139549175428672 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 08:27:47.408661 139549175428672 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.066057s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 08:27:47.411746 139549175428672 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22050.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22050.orbax-checkpoint-tmp/default
I0121 08:27:47.416275 139549175428672 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22050.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22050
I0121 08:27:47.430180 139549175428672 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22050`.
I0121 08:27:47.431201 139549175428672 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.118354s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22050
I0121 08:27:47.431433 139549175428672 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.607234s.
I0121 08:27:47.431923 139549167035968 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 08:27:47.432558 139549167035968 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 08:27:47.490464 139549167035968 deleter.py:273] Deleted step 21150.
I0121 08:27:47.490813 139549167035968 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=22050] CheckpointManager Save Finalize is syncing with other hosts...
I0121 08:27:47.491217 139549167035968 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=22050] CheckpointManager Save Finalize is done on all hosts.
step: 22500,  loss data: 2.281e-03, loss res: 2.688e-03, time: 1.293e+02
Epoch 50, getting batches from DataLoader...
step: 22950,  loss data: 2.180e-03, loss res: 6.220e-03, time: 1.288e+02
I0121 08:32:03.986077 139627771470912 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 08:32:03.987746 139627771470912 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 22950
I0121 08:32:03.988631 139627771470912 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22950.
I0121 08:32:04.024058 139546826102336 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22950.orbax-checkpoint-tmp
I0121 08:32:04.073846 139549158643264 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 08:32:04.103280 139627771470912 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 08:32:04.103790 139627771470912 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 08:32:04.470966 139627771470912 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.370232s
I0121 08:32:04.509814 139627771470912 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 166.624 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 513 milliseconds) (per-host)
I0121 08:32:04.567225 139627771470912 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.570768s (batch_requests_ready=0.060499s, total_serialization_initiated=0.425771s, others=0.084499s)
I0121 08:32:04.569129 139627771470912 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.577427s (all_items=0.000018s, per_item={'default': '0.00001836'}, temp_paths=0.577409)
I0121 08:32:04.573705 139550475126336 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 08:32:04.573993 139627771470912 async_checkpointer.py:561] Finished blocking save. Time taken: 0.585940s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22950.
I0121 08:32:04.575591 139627771470912 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=22950] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 08:32:04.576536 139550491911744 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 08:32:04.582098 139627771470912 standard_logger.py:34] {'step': Array(22950, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768955523.9860146, 'wait_for_prev_duration_secs': 0.0003688335418701172, 'time_between_consecutive_saves_sec': 256.49454379081726, 'checkpointer_blocking_start_time': 1768955523.9880195, 'checkpointer_blocking_duration_secs': 0.5873174667358398, 'get_old_steps_start_time': 1768955524.5753794, 'get_old_steps_duration_secs': 0.0001270771026611328, 'checkpoint_manager_blocking_start_time': 1768955523.9854324, 'checkpoint_manager_blocking_duration_secs': 0.5956335067749023}
I0121 08:32:04.596690 139550533875264 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 08:32:05.964332 139550525482560 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 1.448708s (commit=1.349299s, array_metadata_write=0.099409s)
I0121 08:32:05.967582 139550475126336 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 43.393 MiB/s (total gbytes: 85.5 MiB) (time elapsed: a second) (per-host)
I0121 08:32:05.968001 139550475126336 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 1.393542s.
I0121 08:32:05.979404 139550475126336 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 08:32:06.037536 139550475126336 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.066586s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 08:32:06.038835 139550475126336 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22950.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22950.orbax-checkpoint-tmp/default
I0121 08:32:06.043346 139550475126336 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22950.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22950
I0121 08:32:06.057242 139550475126336 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22950`.
I0121 08:32:06.058218 139550475126336 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.070177s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/22950
I0121 08:32:06.058481 139550475126336 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 1.484024s.
I0121 08:32:06.058985 139550491911744 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 08:32:06.059497 139550491911744 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 08:32:06.112056 139550491911744 deleter.py:273] Deleted step 22050.
I0121 08:32:06.112310 139550491911744 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=22950] CheckpointManager Save Finalize is syncing with other hosts...
I0121 08:32:06.112902 139550491911744 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=22950] CheckpointManager Save Finalize is done on all hosts.
step: 23400,  loss data: 3.280e-03, loss res: 1.706e-02, time: 1.290e+02
step: 23850,  loss data: 1.399e-03, loss res: 3.426e-03, time: 1.291e+02
I0121 08:36:22.763206 139627771470912 checkpoint_manager.py:2013] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
I0121 08:36:22.764462 139627771470912 checkpoint_manager.py:1518] [process=0] Saving checkpoint at step 23850
I0121 08:36:22.765280 139627771470912 async_checkpointer.py:452] [process=0] Started async saving checkpoint to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/23850.
I0121 08:36:22.785289 139546817709632 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/23850.orbax-checkpoint-tmp
I0121 08:36:22.873049 139627771470912 jax_array_handlers.py:357] Scheduling D2H of 774 prioritized jax.Array.
I0121 08:36:22.873587 139627771470912 replica_slices.py:424] Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
I0121 08:36:22.896255 139546800924224 atomicity.py:137] Creating tmp directory /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/23850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 08:36:23.155952 139627771470912 base_pytree_checkpoint_handler.py:151] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.285390s
I0121 08:36:23.178653 139627771470912 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 210.963 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 405 milliseconds) (per-host)
I0121 08:36:23.184780 139627771470912 base_pytree_checkpoint_handler.py:730] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.411615s (batch_requests_ready=0.054698s, total_serialization_initiated=0.328666s, others=0.028251s)
I0121 08:36:23.190419 139627771470912 composite_checkpoint_handler.py:715] [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 0.422169s (all_items=0.000019s, per_item={'default': '0.00001907'}, temp_paths=0.422150)
I0121 08:36:23.256757 139550500304448 async_checkpointer.py:79] [process=0][thread=async_save] Background save thread started.
I0121 08:36:23.256883 139627771470912 async_checkpointer.py:561] Finished blocking save. Time taken: 0.492165s. Continuing background save to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/23850.
I0121 08:36:23.259151 139627771470912 checkpoint_manager.py:1566] [process=0][thread=MainThread][step=23850] Starting CheckpointManager Save Finalize thread=save_finalize
I0121 08:36:23.259957 139549167035968 async_checkpointer.py:265] [process=0][thread=save_finalize] Waiting for background save thread=async_save.
I0121 08:36:23.265468 139627771470912 standard_logger.py:34] {'step': Array(23850, dtype=int32), 'event_type': 'save', 'directory': '/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1768955782.7631316, 'wait_for_prev_duration_secs': 0.0003333091735839844, 'time_between_consecutive_saves_sec': 256.64998412132263, 'checkpointer_blocking_start_time': 1768955782.76469, 'checkpointer_blocking_duration_secs': 0.49422740936279297, 'get_old_steps_start_time': 1768955783.2589586, 'get_old_steps_duration_secs': 0.00010371208190917969, 'checkpoint_manager_blocking_start_time': 1768955782.7625556, 'checkpoint_manager_blocking_duration_secs': 0.498615026473999}
I0121 08:36:23.301540 139550533875264 array_metadata_store.py:203] [process=0][thread=array_type_handler] Wrote 774 array_metadata.ArrayMetadata to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/23850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp/array_metadatas/process_0
I0121 08:36:25.365750 139550525482560 base_pytree_checkpoint_handler.py:1224] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 2.169890s (commit=2.074922s, array_metadata_write=0.094968s)
I0121 08:36:25.368658 139550500304448 base_pytree_checkpoint_handler.py:128] [process=0] /jax/checkpoint/write/gbytes_per_sec: 32.954 MiB/s (total gbytes: 85.5 MiB) (time elapsed: 2 seconds) (per-host)
I0121 08:36:25.369102 139550500304448 async_checkpointer.py:90] [process=0][thread=async_save] 3 Handler Commit operations completed. Time taken: 2.111536s.
I0121 08:36:25.381576 139550500304448 array_metadata_store.py:367] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
I0121 08:36:25.440886 139550500304448 base_pytree_checkpoint_handler.py:1348] [process=0][thread=async_save] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.068248s. use_zarr3=False, enable_post_merge_validation=True, directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/23850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp
I0121 08:36:25.442203 139550500304448 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/23850.orbax-checkpoint-tmp/default.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/23850.orbax-checkpoint-tmp/default
I0121 08:36:25.446673 139550500304448 atomicity.py:480] Renaming /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/23850.orbax-checkpoint-tmp to /autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/23850
I0121 08:36:25.462336 139550500304448 atomicity.py:790] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/23850`.
I0121 08:36:25.463738 139550500304448 async_checkpointer.py:420] Finished async_save (blocking + background). Time taken: 2.699027s. directory=/autodl-fs/data/fundiff/burgers/diffusion/FAE_use_pde_True/ckpt/23850
I0121 08:36:25.464010 139550500304448 async_checkpointer.py:144] [process=0][thread=async_save] Background save thread done. Time taken: 2.206448s.
I0121 08:36:25.464484 139549167035968 async_checkpointer.py:273] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save.
I0121 08:36:25.465214 139549167035968 async_checkpointer.py:283] [process=0][thread=save_finalize] No errors found in background save thread=async_save.
I0121 08:36:25.519458 139549167035968 deleter.py:273] Deleted step 22950.
I0121 08:36:25.519709 139549167035968 checkpoint_manager.py:2133] [process=0][thread=save_finalize][step=23850] CheckpointManager Save Finalize is syncing with other hosts...
I0121 08:36:25.520024 139549167035968 checkpoint_manager.py:2142] [process=0][thread=save_finalize][step=23850] CheckpointManager Save Finalize is done on all hosts.
Traceback (most recent call last):
  File "/root/miniconda3/envs/fundiff_env/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1275, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/root/miniconda3/envs/fundiff_env/lib/python3.10/queue.py", line 179, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/autodl-fs/data/fundiff/burgers/diffusion/main.py", line 41, in <module>
    app.run(main)
  File "/root/miniconda3/envs/fundiff_env/lib/python3.10/site-packages/absl/app.py", line 316, in run
    _run_main(main, args)
  File "/root/miniconda3/envs/fundiff_env/lib/python3.10/site-packages/absl/app.py", line 261, in _run_main
    sys.exit(main(argv))
  File "/autodl-fs/data/fundiff/burgers/diffusion/main.py", line 30, in main
    train_autoencoder.train_and_evaluate(FLAGS.config)
  File "/autodl-fs/data/fundiff/burgers/diffusion/train_autoencoder.py", line 116, in train_and_evaluate
    for batch_idx, batch in enumerate(train_loader):
  File "/root/miniconda3/envs/fundiff_env/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
  File "/root/miniconda3/envs/fundiff_env/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1482, in _next_data
    idx, data = self._get_data()
  File "/root/miniconda3/envs/fundiff_env/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1434, in _get_data
    success, data = self._try_get_data()
  File "/root/miniconda3/envs/fundiff_env/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1288, in _try_get_data
    raise RuntimeError(
RuntimeError: DataLoader worker (pid(s) 42310, 42390, 42451, 42529) exited unexpectedly
